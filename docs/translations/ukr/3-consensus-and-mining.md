[‚Üê –ù–∞–∑–∞–¥: –§–æ—Ä–º–∞—Ç –ø–ª–æ—Ç—ñ–≤](2-plot-format.md) | [üìò –ó–º—ñ—Å—Ç](index.md) | [–î–∞–ª—ñ: –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—É–≤–∞–Ω–Ω—è ‚Üí](4-forging-assignments.md)

---

# –†–æ–∑–¥—ñ–ª 3: –ö–æ–Ω—Å–µ–Ω—Å—É—Å —ñ –ø—Ä–æ—Ü–µ—Å –º–∞–π–Ω—ñ–Ω–≥—É Bitcoin-PoCX

–ü–æ–≤–Ω–∞ —Ç–µ—Ö–Ω—ñ—á–Ω–∞ —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è –º–µ—Ö–∞–Ω—ñ–∑–º—É –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É PoCX (Proof of Capacity –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø–æ–∫–æ–ª—ñ–Ω–Ω—è) —Ç–∞ –ø—Ä–æ—Ü–µ—Å—É –º–∞–π–Ω—ñ–Ω–≥—É, —ñ–Ω—Ç–µ–≥—Ä–æ–≤–∞–Ω–æ–≥–æ –≤ Bitcoin Core.

---

## –ó–º—ñ—Å—Ç

1. [–û–≥–ª—è–¥](#–æ–≥–ª—è–¥)
2. [–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É](#–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞-–∫–æ–Ω—Å–µ–Ω—Å—É—Å—É)
3. [–ü—Ä–æ—Ü–µ—Å –º–∞–π–Ω—ñ–Ω–≥—É](#–ø—Ä–æ—Ü–µ—Å-–º–∞–π–Ω—ñ–Ω–≥—É)
4. [–í–∞–ª—ñ–¥–∞—Ü—ñ—è –±–ª–æ–∫—ñ–≤](#–≤–∞–ª—ñ–¥–∞—Ü—ñ—è-–±–ª–æ–∫—ñ–≤)
5. [–°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å](#—Å–∏—Å—Ç–µ–º–∞-–ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å)
6. [–ú–µ—Ä–µ–∂–µ–≤–µ —Ä–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω–Ω—è](#–º–µ—Ä–µ–∂–µ–≤–µ-—Ä–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω–Ω—è)
7. [–¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ](#—Ç–µ—Ö–Ω—ñ—á–Ω—ñ-–¥–µ—Ç–∞–ª—ñ)

---

## –û–≥–ª—è–¥

Bitcoin-PoCX —Ä–µ–∞–ª—ñ–∑—É—î —á–∏—Å—Ç–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É Proof of Capacity —è–∫ –ø–æ–≤–Ω—É –∑–∞–º—ñ–Ω—É Proof of Work Bitcoin. –¶–µ –Ω–æ–≤–∏–π –ª–∞–Ω—Ü—é–≥ –±–µ–∑ –≤–∏–º–æ–≥ –∑–≤–æ—Ä–æ—Ç–Ω–æ—ó —Å—É–º—ñ—Å–Ω–æ—Å—Ç—ñ.

**–ö–ª—é—á–æ–≤—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ:**
- **–ï–Ω–µ—Ä–≥–æ–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å:** –ú–∞–π–Ω—ñ–Ω–≥ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω—ñ —Ñ–∞–π–ª–∏ –ø–ª–æ—Ç—ñ–≤ –∑–∞–º—ñ—Å—Ç—å –æ–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω–æ–≥–æ —Ö–µ—à—É–≤–∞–Ω–Ω—è
- **Time Bended –¥–µ–¥–ª–∞–π–Ω–∏:** –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è —Ä–æ–∑–ø–æ–¥—ñ–ª—É (–µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–π–Ω–∏–π‚Üí—Ö—ñ-–∫–≤–∞–¥—Ä–∞—Ç) –∑–º–µ–Ω—à—É—î –¥–æ–≤–≥—ñ –±–ª–æ–∫–∏, –ø–æ–∫—Ä–∞—â—É—î —Å–µ—Ä–µ–¥–Ω—ñ–π —á–∞—Å –±–ª–æ–∫—ñ–≤
- **–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å:** –í–ª–∞—Å–Ω–∏–∫–∏ –ø–ª–æ—Ç—ñ–≤ –º–æ–∂—É—Ç—å –¥–µ–ª–µ–≥—É–≤–∞—Ç–∏ –ø—Ä–∞–≤–∞ –∫—É–≤–∞–Ω–Ω—è —ñ–Ω—à–∏–º –∞–¥—Ä–µ—Å–∞–º
- **–ù–∞—Ç–∏–≤–Ω–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è C++:** –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –Ω–∞ C++ –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É

**–ü–æ—Ç—ñ–∫ –º–∞–π–Ω—ñ–Ω–≥—É:**
```
–ó–æ–≤–Ω—ñ—à–Ω—ñ–π –º–∞–π–Ω–µ—Ä ‚Üí get_mining_info ‚Üí –û–±—á–∏—Å–ª–µ–Ω–Ω—è Nonce ‚Üí submit_nonce ‚Üí
–ß–µ—Ä–≥–∞ –∫—É–≤–∞–Ω–Ω—è ‚Üí –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –¥–µ–¥–ª–∞–π–Ω—É ‚Üí –ö—É–≤–∞–Ω–Ω—è –±–ª–æ–∫—É ‚Üí –ú–µ—Ä–µ–∂–µ–≤–µ —Ä–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω–Ω—è ‚Üí
–í–∞–ª—ñ–¥–∞—Ü—ñ—è –±–ª–æ–∫—É ‚Üí –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ª–∞–Ω—Ü—é–≥–∞
```

---

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–ª–æ–∫—É

–ë–ª–æ–∫–∏ PoCX —Ä–æ–∑—à–∏—Ä—é—é—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–ª–æ–∫—É Bitcoin –¥–æ–¥–∞—Ç–∫–æ–≤–∏–º–∏ –ø–æ–ª—è–º–∏ –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É:

```cpp
struct PoCXProof {
    std::array<uint8_t, 32> seed;             // Seed –ø–ª–æ—Ç—É (32 –±–∞–π—Ç–∏)
    std::array<uint8_t, 20> account_id;       // –ê–¥—Ä–µ—Å–∞ –ø–ª–æ—Ç—É (20-–±–∞–π—Ç–æ–≤–∏–π hash160)
    uint32_t compression;                     // –†—ñ–≤–µ–Ω—å –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è (1-255)
    uint64_t nonce;                           // Nonce –º–∞–π–Ω—ñ–Ω–≥—É (64-–±—ñ—Ç)
    uint64_t quality;                         // –ó–∞—è–≤–ª–µ–Ω–∞ —è–∫—ñ—Å—Ç—å (–≤–∏–≤—ñ–¥ —Ö–µ—à—É PoC)
};

class CBlockHeader {
    // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø–æ–ª—è Bitcoin
    int32_t nVersion;
    uint256 hashPrevBlock;
    uint256 hashMerkleRoot;
    uint32_t nTime;

    // –ü–æ–ª—è –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É PoCX (–∑–∞–º—ñ–Ω—é—é—Ç—å nBits —Ç–∞ nNonce)
    int nHeight;                              // –í–∏—Å–æ—Ç–∞ –±–ª–æ–∫—É (–∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–Ω–µ–∑–∞–ª–µ–∂–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è)
    uint256 generationSignature;              // –°–∏–≥–Ω–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó (–µ–Ω—Ç—Ä–æ–ø—ñ—è –º–∞–π–Ω—ñ–Ω–≥—É)
    uint64_t nBaseTarget;                     // –ü–∞—Ä–∞–º–µ—Ç—Ä —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ (–æ–±–µ—Ä–Ω–µ–Ω–∞ —Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å)
    PoCXProof pocxProof;                      // –î–æ–∫–∞–∑ –º–∞–π–Ω—ñ–Ω–≥—É

    // –ü–æ–ª—è –ø—ñ–¥–ø–∏—Å—É –±–ª–æ–∫—É
    std::array<uint8_t, 33> vchPubKey;        // –°—Ç–∏—Å–Ω—É—Ç–∏–π –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á (33 –±–∞–π—Ç–∏)
    std::array<uint8_t, 65> vchSignature;     // –ö–æ–º–ø–∞–∫—Ç–Ω–∏–π –ø—ñ–¥–ø–∏—Å (65 –±–∞–π—Ç—ñ–≤)
};

class CBlock : public CBlockHeader {
    std::vector<CTransactionRef> vtx;         // –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
};
```

**–ü—Ä–∏–º—ñ—Ç–∫–∞:** –ü—ñ–¥–ø–∏—Å (`vchSignature`) –≤–∏–∫–ª—é—á–µ–Ω–æ –∑ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —Ö–µ—à—É –±–ª–æ–∫—É –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –∫–æ–≤–∫–æ—Å—Ç—ñ.

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/primitives/block.h`

### –°–∏–≥–Ω–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó

–°–∏–≥–Ω–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Å—Ç–≤–æ—Ä—é—î –µ–Ω—Ç—Ä–æ–ø—ñ—é –º–∞–π–Ω—ñ–Ω–≥—É —Ç–∞ –∑–∞–ø–æ–±—ñ–≥–∞—î –∞—Ç–∞–∫–∞–º –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è.

**–û–±—á–∏—Å–ª–µ–Ω–Ω—è:**
```
generationSignature = SHA256(prev_generationSignature || prev_miner_pubkey)
```

**–ë–ª–æ–∫ –≥–µ–Ω–µ–∑–∏—Å—É:** –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∂–æ—Ä—Å—Ç–∫–æ –∑–∞–∫–æ–¥–æ–≤–∞–Ω—É –ø–æ—á–∞—Ç–∫–æ–≤—É —Å–∏–≥–Ω–∞—Ç—É—Ä—É –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/pocx/node/node.cpp:GetNewBlockContext()`

### –ë–∞–∑–æ–≤–∞ —Ü—ñ–ª—å (—Å–∫–ª–∞–¥–Ω—ñ—Å—Ç—å)

–ë–∞–∑–æ–≤–∞ —Ü—ñ–ª—å —î –æ–±–µ—Ä–Ω–µ–Ω–æ—é –¥–æ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ ‚Äî –≤–∏—â—ñ –∑–Ω–∞—á–µ–Ω–Ω—è –æ–∑–Ω–∞—á–∞—é—Ç—å –ª–µ–≥—à–∏–π –º–∞–π–Ω—ñ–Ω–≥.

**–ê–ª–≥–æ—Ä–∏—Ç–º –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
- –¶—ñ–ª—å–æ–≤–∏–π —á–∞—Å –±–ª–æ–∫—É: 120 —Å–µ–∫—É–Ω–¥ (mainnet), 1 —Å–µ–∫—É–Ω–¥–∞ (regtest)
- –Ü–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è: –ö–æ–∂–µ–Ω –±–ª–æ–∫
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–æ–≤–∑–Ω–µ —Å–µ—Ä–µ–¥–Ω—î –Ω–µ–¥–∞–≤–Ω—ñ—Ö –±–∞–∑–æ–≤–∏—Ö —Ü—ñ–ª–µ–π
- –û–±–º–µ–∂–µ–Ω–æ –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∏–º –∫–æ–ª–∏–≤–∞–Ω–Ω—è–º —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/consensus/params.h`, –ª–æ–≥—ñ–∫–∞ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ –≤ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ –±–ª–æ–∫—É

### –†—ñ–≤–Ω—ñ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è

PoCX –ø—ñ–¥—Ç—Ä–∏–º—É—î –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–∏–π proof-of-work —É —Ñ–∞–π–ª–∞—Ö –ø–ª–æ—Ç—ñ–≤ —á–µ—Ä–µ–∑ —Ä—ñ–≤–Ω—ñ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è (Xn).

**–î–∏–Ω–∞–º—ñ—á–Ω—ñ –º–µ–∂—ñ:**
```cpp
struct CompressionBounds {
    uint8_t nPoCXMinCompression;     // –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –ø—Ä–∏–π–Ω—è—Ç–Ω–∏–π —Ä—ñ–≤–µ–Ω—å
    uint8_t nPoCXTargetCompression;  // –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–∏–π —Ä—ñ–≤–µ–Ω—å
};
```

**–ì—Ä–∞—Ñ—ñ–∫ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è:**
- –ï–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–π–Ω—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏: –†–æ–∫–∏ 4, 12, 28, 60, 124 (—Ö–∞–ª–≤—ñ–Ω–≥–∏ 1, 3, 7, 15, 31)
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è –Ω–∞ 1
- –¶—ñ–ª—å–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –∑–±—ñ–ª—å—à—É—î—Ç—å—Å—è –Ω–∞ 1
- –ü—ñ–¥—Ç—Ä–∏–º—É—î –∑–∞–ø–∞—Å –º—ñ—Ü–Ω–æ—Å—Ç—ñ –º—ñ–∂ –≤–∏—Ç—Ä–∞—Ç–∞–º–∏ –Ω–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–ª–æ—Ç—ñ–≤ —ñ –ø–æ—à—É–∫–æ–º
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è: 255

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/pocx/algorithms/algorithms.h:GetPoCXCompressionBounds()`

---

## –ü—Ä–æ—Ü–µ—Å –º–∞–π–Ω—ñ–Ω–≥—É

### 1. –û—Ç—Ä–∏–º–∞–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ –º–∞–π–Ω—ñ–Ω–≥

**–ö–æ–º–∞–Ω–¥–∞ RPC:** `get_mining_info`

**–ü—Ä–æ—Ü–µ—Å:**
1. –í–∏–∫–ª–∏–∫ `GetNewBlockContext(chainman)` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ —Å—Ç–∞–Ω—É –±–ª–æ–∫—á–µ–π–Ω—É
2. –û–±—á–∏—Å–ª–µ–Ω–Ω—è –¥–∏–Ω–∞–º—ñ—á–Ω–∏—Ö –º–µ–∂ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è –¥–ª—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–∏—Å–æ—Ç–∏
3. –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ –º–∞–π–Ω—ñ–Ω–≥—É

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "generation_signature": "abc123...",
  "base_target": 18325193796,
  "height": 12345,
  "block_hash": "def456...",
  "target_quality": 18446744073709551615,
  "minimum_compression_level": 0,
  "target_compression_level": 0
}
```

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/pocx/rpc/mining.cpp:get_mining_info()`

**–ü—Ä–∏–º—ñ—Ç–∫–∏:**
- –ü—ñ–¥ —á–∞—Å –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –Ω–µ —É—Ç—Ä–∏–º—É—é—Ç—å—Å—è
- –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –æ–±—Ä–æ–±–ª—è—î `cs_main` –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ
- `block_hash` –≤–∫–ª—é—á–µ–Ω–æ –¥–ª—è –¥–æ–≤—ñ–¥–∫–∏, –∞–ª–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó

### 2. –ó–æ–≤–Ω—ñ—à–Ω—ñ–π –º–∞–π–Ω—ñ–Ω–≥

**–û–±–æ–≤'—è–∑–∫–∏ –∑–æ–≤–Ω—ñ—à–Ω—å–æ–≥–æ –º–∞–π–Ω–µ—Ä–∞:**
1. –ß–∏—Ç–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –ø–ª–æ—Ç—ñ–≤ –∑ –¥–∏—Å–∫–∞
2. –û–±—á–∏—Å–ª–µ–Ω–Ω—è scoop –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–∞ –≤–∏—Å–æ—Ç–∏
3. –ü–æ—à—É–∫ nonce –∑ –Ω–∞–π–∫—Ä–∞—â–∏–º –¥–µ–¥–ª–∞–π–Ω–æ–º
4. –ü–æ–¥–∞–Ω–Ω—è –¥–æ –≤—É–∑–ª–∞ —á–µ—Ä–µ–∑ `submit_nonce`

**–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª—É –ø–ª–æ—Ç—É:**
- –ù–∞ –æ—Å–Ω–æ–≤—ñ —Ñ–æ—Ä–º–∞—Ç—É POC2 (Burstcoin)
- –ü–æ–∫—Ä–∞—â–µ–Ω–∏–π –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è–º–∏ –±–µ–∑–ø–µ–∫–∏ —Ç–∞ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è–º–∏ –º–∞—Å—à—Ç–∞–±–æ–≤–∞–Ω–æ—Å—Ç—ñ
- –î–∏–≤. –∞—Ç—Ä–∏–±—É—Ü—ñ—é –≤ `CLAUDE.md`

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–∞–π–Ω–µ—Ä–∞:** –ó–æ–≤–Ω—ñ—à–Ω—è (–Ω–∞–ø—Ä., –Ω–∞ –æ—Å–Ω–æ–≤—ñ Scavenger)

### 3. –ü–æ–¥–∞–Ω–Ω—è —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è Nonce

**–ö–æ–º–∞–Ω–¥–∞ RPC:** `submit_nonce`

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
```
height, generation_signature, account_id, seed, nonce, quality (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
```

**–ü–æ—Ç—ñ–∫ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó (–æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏–π –ø–æ—Ä—è–¥–æ–∫):**

#### –ö—Ä–æ–∫ 1: –®–≤–∏–¥–∫–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è —Ñ–æ—Ä–º–∞—Ç—É
```cpp
// Account ID: 40 hex —Å–∏–º–≤–æ–ª—ñ–≤ = 20 –±–∞–π—Ç—ñ–≤
if (account_id.length() != 40 || !IsHex(account_id)) reject;

// Seed: 64 hex —Å–∏–º–≤–æ–ª–∏ = 32 –±–∞–π—Ç–∏
if (seed.length() != 64 || !IsHex(seed)) reject;
```

#### –ö—Ä–æ–∫ 2: –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
```cpp
auto context = pocx::consensus::GetNewBlockContext(chainman);
// –ü–æ–≤–µ—Ä—Ç–∞—î: height, generation_signature, base_target, block_hash
```

**–ë–ª–æ–∫—É–≤–∞–Ω–Ω—è:** `cs_main` –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ, –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –Ω–µ —É—Ç—Ä–∏–º—É—é—Ç—å—Å—è –≤ –ø–æ—Ç–æ—Ü—ñ RPC

#### –ö—Ä–æ–∫ 3: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
```cpp
// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤–∏—Å–æ—Ç–∏
if (height != context.height) reject;

// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó
if (submitted_gen_sig != context.generation_signature) reject;
```

#### –ö—Ä–æ–∫ 4: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥–∞–º–∞–Ω—Ü—è
```cpp
// –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞ (–∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å)
effective_signer = GetEffectiveSigner(plot_address, height, view);

// –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –≤—É–∑–æ–ª –º–∞—î –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞
if (!HaveAccountKey(effective_signer, wallet)) reject;
```

**–ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å:** –í–ª–∞—Å–Ω–∏–∫ –ø–ª–æ—Ç—É –º–æ–∂–µ –ø—Ä–∏–∑–Ω–∞—á–∏—Ç–∏ –ø—Ä–∞–≤–∞ –∫—É–≤–∞–Ω–Ω—è —ñ–Ω—à—ñ–π –∞–¥—Ä–µ—Å—ñ. –ì–∞–º–∞–Ω–µ—Ü—å –ø–æ–≤–∏–Ω–µ–Ω –º–∞—Ç–∏ –∫–ª—é—á –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞, –Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –¥–ª—è –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç—É.

#### –ö—Ä–æ–∫ 5: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–æ–∫–∞–∑—É
```cpp
bool success = pocx_validate_block(
    generation_signature_hex,
    base_target,
    account_payload,     // 20 –±–∞–π—Ç—ñ–≤
    block_height,
    nonce,
    seed,                // 32 –±–∞–π—Ç–∏
    min_compression,
    max_compression,
    &result             // –í–∏–≤—ñ–¥: quality, deadline
);
```

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –î–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∑ hex
2. –û–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–∞–π–∫—Ä–∞—â–æ—ó —è–∫–æ—Å—Ç—ñ –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º SIMD-–æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∏—Ö –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤
3. –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ —è–∫–æ—Å—Ç—ñ –≤–∏–º–æ–≥–∞–º —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
4. –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è —Å–∏—Ä–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/pocx/consensus/validation.cpp:pocx_validate_block()`

#### –ö—Ä–æ–∫ 6: –û–±—á–∏—Å–ª–µ–Ω–Ω—è Time Bending
```cpp
// –°–∏—Ä–∏–π –¥–µ–¥–ª–∞–π–Ω –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ (—Å–µ–∫—É–Ω–¥–∏)
uint64_t deadline_seconds = quality / base_target;

// Time Bended —á–∞—Å –∫—É–≤–∞–Ω–Ω—è (—Å–µ–∫—É–Ω–¥–∏)
uint64_t forge_time = CalculateTimeBendedDeadline(
    quality, base_target, block_time
);
```

**–§–æ—Ä–º—É–ª–∞ Time Bending:**
```
Y = scale * (X^(1/3))
–¥–µ:
  X = quality / base_target
  scale = block_time / (cbrt(block_time) * Gamma(4/3))
  Gamma(4/3) ‚âà 0.892979511
```

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º—É—î –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–π–Ω–∏–π —Ä–æ–∑–ø–æ–¥—ñ–ª —É —Ö—ñ-–∫–≤–∞–¥—Ä–∞—Ç. –î—É–∂–µ —Ö–æ—Ä–æ—à—ñ —Ä—ñ—à–µ–Ω–Ω—è –∫—É—é—Ç—å—Å—è –ø—ñ–∑–Ω—ñ—à–µ (–º–µ—Ä–µ–∂–∞ –º–∞—î —á–∞—Å –ø—Ä–æ—Å–∫–∞–Ω—É–≤–∞—Ç–∏ –¥–∏—Å–∫–∏), –ø–æ–≥–∞–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è –ø–æ–∫—Ä–∞—â—É—é—Ç—å—Å—è. –ó–º–µ–Ω—à—É—î –¥–æ–≤–≥—ñ –±–ª–æ–∫–∏, –ø—ñ–¥—Ç—Ä–∏–º—É—î —Å–µ—Ä–µ–¥–Ω—ñ 120—Å.

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/pocx/algorithms/time_bending.cpp:CalculateTimeBendedDeadline()`

#### –ö—Ä–æ–∫ 7: –ü–æ–¥–∞–Ω–Ω—è –¥–æ –∫—É–≤–∞—á–∞
```cpp
g_pocx_scheduler->SubmitNonce(
    account_id,
    seed,
    nonce,
    raw_quality,      // –ù–ï –¥–µ–¥–ª–∞–π–Ω - –ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è –≤ –∫—É–≤–∞—á—ñ
    height,
    generation_signature
);
```

**–î–∏–∑–∞–π–Ω –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–µ—Ä–≥–∏:**
- –ü–æ–¥–∞–Ω–Ω—è –∑–∞–≤–∂–¥–∏ —É—Å–ø—ñ—à–Ω–µ (–¥–æ–¥–∞—î—Ç—å—Å—è –¥–æ —á–µ—Ä–≥–∏)
- RPC –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –Ω–µ–≥–∞–π–Ω–æ
- –†–æ–±–æ—á–∏–π –ø–æ—Ç—ñ–∫ –æ–±—Ä–æ–±–ª—è—î –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/pocx/rpc/mining.cpp:submit_nonce()`

### 4. –û–±—Ä–æ–±–∫–∞ —á–µ—Ä–≥–∏ –∫—É–≤–∞—á–∞

**–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞:**
- –û–¥–∏–Ω –ø–æ—Å—Ç—ñ–π–Ω–∏–π —Ä–æ–±–æ—á–∏–π –ø–æ—Ç—ñ–∫
- FIFO —á–µ—Ä–≥–∞ –ø–æ–¥–∞–Ω—å
- –ë–µ–∑–±–ª–æ–∫—É–≤–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω –∫—É–≤–∞–Ω–Ω—è (—Ç—ñ–ª—å–∫–∏ —Ä–æ–±–æ—á–∏–π –ø–æ—Ç—ñ–∫)
- –ë–µ–∑ –≤–∫–ª–∞–¥–µ–Ω–∏—Ö –±–ª–æ–∫—É–≤–∞–Ω—å (–∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –≤–∑–∞—î–º–Ω–∏–º –±–ª–æ–∫—É–≤–∞–Ω–Ω—è–º)

**–ì–æ–ª–æ–≤–Ω–∏–π —Ü–∏–∫–ª —Ä–æ–±–æ—á–æ–≥–æ –ø–æ—Ç–æ–∫—É:**
```cpp
while (!shutdown) {
    // 1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –ø–æ–¥–∞–Ω–Ω—è –≤ —á–µ—Ä–∑—ñ
    if (has_submission) {
        ProcessSubmission(submission);
        continue;
    }

    // 2. –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –¥–µ–¥–ª–∞–π–Ω—É –∞–±–æ –Ω–æ–≤–æ–≥–æ –ø–æ–¥–∞–Ω–Ω—è
    if (has_forging_state) {
        WaitForDeadlineOrNewSubmission();
    } else {
        WaitForNewSubmission();
    }
}
```

**–õ–æ–≥—ñ–∫–∞ ProcessSubmission:**
```cpp
1. –û—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–≤—ñ–∂–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É: GetNewBlockContext(*chainman)

2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –Ω–∞ –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ—Å—Ç—å (–º–æ–≤—á–∞–∑–Ω–µ –≤—ñ–¥–∫–∏–¥–∞–Ω–Ω—è):
   - –ù–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –≤–∏—Å–æ—Ç–∏ ‚Üí –≤—ñ–¥–∫–∏–Ω—É—Ç–∏
   - –ù–µ–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó ‚Üí –≤—ñ–¥–∫–∏–Ω—É—Ç–∏
   - –ó–º—ñ–Ω–∞ —Ö–µ—à—É –±–ª–æ–∫—É –≤–µ—Ä—Ö—ñ–≤–∫–∏ (—Ä–µ–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—è) ‚Üí —Å–∫–∏–¥–∞–Ω–Ω—è —Å—Ç–∞–Ω—É –∫—É–≤–∞–Ω–Ω—è

3. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —è–∫–æ—Å—Ç—ñ:
   - –Ø–∫—â–æ quality >= current_best ‚Üí –≤—ñ–¥–∫–∏–Ω—É—Ç–∏

4. –û–±—á–∏—Å–ª–µ–Ω–Ω—è Time Bended –¥–µ–¥–ª–∞–π–Ω—É:
   deadline = CalculateTimeBendedDeadline(quality, base_target, block_time)

5. –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –∫—É–≤–∞–Ω–Ω—è:
   - –°–∫–∞—Å—É–≤–∞–Ω–Ω—è —ñ—Å–Ω—É—é—á–æ–≥–æ –∫—É–≤–∞–Ω–Ω—è (—è–∫—â–æ –∑–Ω–∞–π–¥–µ–Ω–æ –∫—Ä–∞—â–µ)
   - –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è: account_id, seed, nonce, quality, deadline
   - –û–±—á–∏—Å–ª–µ–Ω–Ω—è: forge_time = block_time + deadline_seconds
   - –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ö–µ—à—É –≤–µ—Ä—Ö—ñ–≤–∫–∏ –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è —Ä–µ–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π
```

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/pocx/mining/scheduler.cpp:ProcessSubmission()`

### 5. –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –¥–µ–¥–ª–∞–π–Ω—É —Ç–∞ –∫—É–≤–∞–Ω–Ω—è –±–ª–æ–∫—É

**WaitForDeadlineOrNewSubmission:**

**–£–º–æ–≤–∏ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è:**
```cpp
condition_variable.wait_until(forge_time, [&] {
    return shutdown ||
           !submission_queue.empty() ||
           forging_cancelled;
});
```

**–ü—Ä–∏ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—ñ –¥–µ–¥–ª–∞–π–Ω—É ‚Äî –≤–∞–ª—ñ–¥–∞—Ü—ñ—è —Å–≤—ñ–∂–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É:**
```cpp
1. –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É: GetNewBlockContext(*chainman)

2. –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–∏—Å–æ—Ç–∏:
   if (forging_height != current_height) {
       reset_forging_state();
       return;
   }

3. –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó:
   if (forging_gen_sig != current_gen_sig) {
       reset_forging_state();
       return;
   }

4. –ö—Ä–∞–π–Ω—ñ–π –≤–∏–ø–∞–¥–æ–∫ –±–∞–∑–æ–≤–æ—ó —Ü—ñ–ª—ñ:
   if (forging_base_target != current_base_target) {
       // –ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –¥–µ–¥–ª–∞–π–Ω—É –∑ –Ω–æ–≤–æ—é –±–∞–∑–æ–≤–æ—é —Ü—ñ–ª–ª—é
       new_deadline = CalculateTimeBendedDeadline(quality, new_base_target, block_time);
       update_forge_time(new_deadline);
       return; // –û—á—ñ–∫—É–≤–∞–Ω–Ω—è –∑–Ω–æ–≤—É
   }

5. –í—Å–µ –≤–∞–ª—ñ–¥–Ω–æ ‚Üí ForgeBlock()
```

**–ü—Ä–æ—Ü–µ—Å ForgeBlock:**

```cpp
1. –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞ (–ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å):
   effective_signer = GetEffectiveSigner(plot_address, height, view);

2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å–∫—Ä–∏–ø—Ç—É coinbase:
   coinbase_script = P2WPKH(effective_signer);  // –ü–ª–∞—Ç–∏—Ç—å –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç—É

3. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—É –±–ª–æ–∫—É:
   options.coinbase_output_script = coinbase_script;
   options.use_mempool = true;
   template = mining->createNewBlock(options);

4. –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ–∫–∞–∑—É PoCX:
   block.pocxProof.account_id = plot_address;    // –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∞ –∞–¥—Ä–µ—Å–∞ –ø–ª–æ—Ç—É
   block.pocxProof.seed = seed;
   block.pocxProof.nonce = nonce;

5. –ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –∫–æ—Ä–µ–Ω—è Merkle:
   block.hashMerkleRoot = BlockMerkleRoot(block);

6. –ü—ñ–¥–ø–∏—Å –±–ª–æ–∫—É:
   // –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∫–ª—é—á–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞ (–º–æ–∂–µ –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏—Å—è –≤—ñ–¥ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç—É)
   hash = PoCXBlockSignatureHash(block.GetHash());
   key.SignCompact(hash, signature);
   block.vchSignature = signature;
   block.vchPubKey = effective_signer_pubkey;

7. –ü–æ–¥–∞–Ω–Ω—è –¥–æ –ª–∞–Ω—Ü—é–≥–∞:
   chainman->ProcessNewBlock(block, force=true, min_pow_checked=true);

8. –û–±—Ä–æ–±–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É:
   if (accepted) {
       log_success();
       reset_forging_state();  // –ì–æ—Ç–æ–≤–∏–π –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –±–ª–æ–∫—É
   } else {
       log_failure();
       reset_forging_state();
   }
```

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/pocx/mining/scheduler.cpp:ForgeBlock()`

**–ö–ª—é—á–æ–≤—ñ –ø—Ä–æ–µ–∫—Ç–Ω—ñ —Ä—ñ—à–µ–Ω–Ω—è:**
- Coinbase –ø–ª–∞—Ç–∏—Ç—å –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç—É (–¥–æ—Ç—Ä–∏–º—É—î—Ç—å—Å—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å)
- –î–æ–∫–∞–∑ –º—ñ—Å—Ç–∏—Ç—å –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—É –∞–¥—Ä–µ—Å—É –ø–ª–æ—Ç—É (–¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó)
- –ü—ñ–¥–ø–∏—Å –≤—ñ–¥ –∫–ª—é—á–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞ (–¥–æ–∫–∞–∑ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è)
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∫–ª—é—á–∞—î —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó mempool

---

## –í–∞–ª—ñ–¥–∞—Ü—ñ—è –±–ª–æ–∫—ñ–≤

### –ü–æ—Ç—ñ–∫ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –≤—Ö—ñ–¥–Ω–æ–≥–æ –±–ª–æ–∫—É

–ö–æ–ª–∏ –±–ª–æ–∫ –æ—Ç—Ä–∏–º–∞–Ω–æ –∑ –º–µ—Ä–µ–∂—ñ –∞–±–æ –ø–æ–¥–∞–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ, –≤—ñ–Ω –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≤–∞–ª—ñ–¥–∞—Ü—ñ—é –≤ –∫—ñ–ª—å–∫–æ—Ö –µ—Ç–∞–ø–∞—Ö:

### –ï—Ç–∞–ø 1: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ (CheckBlockHeader)

**–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ-–Ω–µ–∑–∞–ª–µ–∂–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è:**

```cpp
static bool CheckBlockHeader(
    const CBlockHeader& block,
    BlockValidationState& state,
    const Consensus::Params& consensusParams,
    bool fCheckPOW = true
)
```

**–í–∞–ª—ñ–¥–∞—Ü—ñ—è PoCX (–∫–æ–ª–∏ –≤–∏–∑–Ω–∞—á–µ–Ω–æ ENABLE_POCX):**
```cpp
if (block.nHeight > 0 && fCheckPOW) {
    // –ë–∞–∑–æ–≤–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –ø—ñ–¥–ø–∏—Å—É (—â–µ –±–µ–∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å)
    if (!VerifyPoCXBlockCompactSignature(block)) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-pocx-sig");
    }
}
```

**–ë–∞–∑–æ–≤–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –ø—ñ–¥–ø–∏—Å—É:**
1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –ø–æ–ª—ñ–≤ pubkey —Ç–∞ signature
2. –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ä–æ–∑–º—ñ—Ä—É pubkey (33 –±–∞–π—Ç–∏ —Å—Ç–∏—Å–Ω—É—Ç–∏–π)
3. –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ä–æ–∑–º—ñ—Ä—É –ø—ñ–¥–ø–∏—Å—É (65 –±–∞–π—Ç—ñ–≤ –∫–æ–º–ø–∞–∫—Ç–Ω–∏–π)
4. –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è pubkey –∑ –ø—ñ–¥–ø–∏—Å—É: `pubkey.RecoverCompact(hash, signature)`
5. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–æ–≥–æ pubkey –∑–±–µ—Ä–µ–∂–µ–Ω–æ–º—É

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/validation.cpp:CheckBlockHeader()`
**–õ–æ–≥—ñ–∫–∞ –ø—ñ–¥–ø–∏—Å—É:** `src/pocx/consensus/pocx.cpp:VerifyPoCXBlockCompactSignature()`

### –ï—Ç–∞–ø 2: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –±–ª–æ–∫—É (CheckBlock)

**–í–∞–ª—ñ–¥—É—î:**
- –ö–æ—Ä–µ–∫—Ç–Ω—ñ—Å—Ç—å –∫–æ—Ä–µ–Ω—è Merkle
- –í–∞–ª—ñ–¥–Ω—ñ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
- –í–∏–º–æ–≥–∏ –¥–æ coinbase
- –û–±–º–µ–∂–µ–Ω–Ω—è —Ä–æ–∑–º—ñ—Ä—É –±–ª–æ–∫—É
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É Bitcoin

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/consensus/validation.cpp:CheckBlock()`

### –ï—Ç–∞–ø 3: –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –∑–∞–≥–æ–ª–æ–≤–∫–∞ (ContextualCheckBlockHeader)

**–í–∞–ª—ñ–¥–∞—Ü—ñ—è —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∞ –¥–ª—è PoCX:**

```cpp
#ifdef ENABLE_POCX
    // –ö—Ä–æ–∫ 1: –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó
    uint256 expected_gen_sig = CalculateGenerationSignature(pindexPrev);
    if (block.generationSignature != expected_gen_sig) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-gen-sig");
    }

    // –ö—Ä–æ–∫ 2: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –±–∞–∑–æ–≤–æ—ó —Ü—ñ–ª—ñ
    uint64_t expected_base_target = CalculateNextBaseTarget(pindexPrev, block.nTime);
    if (block.nBaseTarget != expected_base_target) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-diff");
    }

    // –ö—Ä–æ–∫ 3: –í–∞–ª—ñ–¥–∞—Ü—ñ—è proof of capacity
    auto compression_bounds = GetPoCXCompressionBounds(block.nHeight, halving_interval);
    auto result = ValidateProofOfCapacity(
        block.generationSignature,
        block.pocxProof,
        block.nBaseTarget,
        block.nHeight,
        compression_bounds.nPoCXMinCompression,
        compression_bounds.nPoCXTargetCompression,
        block_time
    );

    if (!result.is_valid) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-pocx-proof");
    }

    // –ö—Ä–æ–∫ 4: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞–π–º—ñ–Ω–≥—É –¥–µ–¥–ª–∞–π–Ω—É
    uint32_t elapsed_time = block.nTime - pindexPrev->nTime;
    if (result.deadline > elapsed_time) {
        return state.Invalid(BLOCK_INVALID_HEADER, "pocx-deadline-not-met");
    }
#endif
```

**–ö—Ä–æ–∫–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó:**
1. **–°–∏–≥–Ω–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó:** –ü–æ–≤–∏–Ω–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–Ω—é –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ –±–ª–æ–∫—É
2. **–ë–∞–∑–æ–≤–∞ —Ü—ñ–ª—å:** –ü–æ–≤–∏–Ω–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω–Ω—é –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ
3. **–†—ñ–≤–µ–Ω—å –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è:** –ü–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –º–µ—Ä–µ–∂–µ–≤–æ–º—É –º—ñ–Ω—ñ–º—É–º—É (`compression >= min_compression`)
4. **–ó–∞—è–≤–ª–µ–Ω–∞ —è–∫—ñ—Å—Ç—å:** –ü–æ–¥–∞–Ω–∞ —è–∫—ñ—Å—Ç—å –ø–æ–≤–∏–Ω–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω—ñ–π —è–∫–æ—Å—Ç—ñ –∑ –¥–æ–∫–∞–∑—É
5. **Proof of Capacity:** –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–æ–∫–∞–∑—É (–æ–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–∞ SIMD)
6. **–¢–∞–π–º—ñ–Ω–≥ –¥–µ–¥–ª–∞–π–Ω—É:** Time-bended –¥–µ–¥–ª–∞–π–Ω (`poc_time`) –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ ‚â§ –º–∏–Ω—É–ª–æ–≥–æ —á–∞—Å—É

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/validation.cpp:ContextualCheckBlockHeader()`

### –ï—Ç–∞–ø 4: –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –±–ª–æ–∫—É (ConnectBlock)

**–ü–æ–≤–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è:**

```cpp
#ifdef ENABLE_POCX
    // –†–æ–∑—à–∏—Ä–µ–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –ø—ñ–¥–ø–∏—Å—É –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å
    if (pindex->nHeight > 0 && !fJustCheck) {
        if (!VerifyPoCXBlockCompactSignature(block, view, pindex->nHeight)) {
            return state.Invalid(BLOCK_CONSENSUS, "bad-pocx-assignment-sig");
        }
    }
#endif
```

**–†–æ–∑—à–∏—Ä–µ–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –ø—ñ–¥–ø–∏—Å—É:**
1. –í–∏–∫–æ–Ω–∞–Ω–Ω—è –±–∞–∑–æ–≤–æ—ó –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –ø—ñ–¥–ø–∏—Å—É
2. –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è account ID –∑ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–æ–≥–æ pubkey
3. –û—Ç—Ä–∏–º–∞–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞ –¥–ª—è –∞–¥—Ä–µ—Å–∏ –ø–ª–æ—Ç—É: `GetEffectiveSigner(plot_address, height, view)`
4. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É pubkey –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç—É

**–õ–æ–≥—ñ–∫–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å:**
```cpp
std::array<uint8_t, 20> GetEffectiveSigner(
    const std::array<uint8_t, 20>& plotAddress,
    int nHeight,
    const CCoinsViewCache& view
) {
    auto assignment = view.GetForgingAssignment(plotAddress, nHeight);

    if (assignment.has_value() && assignment->IsActiveAtHeight(nHeight)) {
        return assignment->forgingAddress;  // –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞
    }

    return plotAddress;  // –ë–µ–∑ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è - –ø—ñ–¥–ø–∏—Å—É—î –≤–ª–∞—Å–Ω–∏–∫ –ø–ª–æ—Ç—É
}
```

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: `src/validation.cpp:ConnectBlock()`
- –†–æ–∑—à–∏—Ä–µ–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è: `src/pocx/consensus/pocx.cpp:VerifyPoCXBlockCompactSignature()`
- –õ–æ–≥—ñ–∫–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å: `src/pocx/consensus/validation.cpp:GetEffectiveSigner()`

### –ï—Ç–∞–ø 5: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è –ª–∞–Ω—Ü—é–≥–∞

**–ü–æ—Ç—ñ–∫ ProcessNewBlock:**
```cpp
bool ProcessNewBlock(const std::shared_ptr<const CBlock>& block,
                    bool force_processing,
                    bool min_pow_checked,
                    bool* new_block)
{
    1. AcceptBlock ‚Üí –í–∞–ª—ñ–¥–∞—Ü—ñ—è —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞ –¥–∏—Å–∫
    2. ActivateBestChain ‚Üí –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Ö—ñ–≤–∫–∏ –ª–∞–Ω—Ü—é–≥–∞ —è–∫—â–æ —Ü–µ –Ω–∞–π–∫—Ä–∞—â–∏–π –ª–∞–Ω—Ü—é–≥
    3. –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –ø—Ä–æ –Ω–æ–≤–∏–π –±–ª–æ–∫
}
```

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/validation.cpp:ProcessNewBlock()`

### –ü—ñ–¥—Å—É–º–æ–∫ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó

**–ü–æ–≤–Ω–∏–π —à–ª—è—Ö –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó:**
```
–û—Ç—Ä–∏–º–∞–Ω–Ω—è –±–ª–æ–∫—É
    ‚Üì
CheckBlockHeader (–±–∞–∑–æ–≤–∏–π –ø—ñ–¥–ø–∏—Å)
    ‚Üì
CheckBlock (—Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó, merkle)
    ‚Üì
ContextualCheckBlockHeader (gen sig, base target, PoC –¥–æ–∫–∞–∑, –¥–µ–¥–ª–∞–π–Ω)
    ‚Üì
ConnectBlock (—Ä–æ–∑—à–∏—Ä–µ–Ω–∏–π –ø—ñ–¥–ø–∏—Å –∑ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º–∏, –ø–µ—Ä–µ—Ö–æ–¥–∏ —Å—Ç–∞–Ω—É)
    ‚Üì
ActivateBestChain (–æ–±—Ä–æ–±–∫–∞ —Ä–µ–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π, —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –ª–∞–Ω—Ü—é–≥–∞)
    ‚Üì
–ú–µ—Ä–µ–∂–µ–≤–µ —Ä–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω–Ω—è
```

---

## –°–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å

### –û–≥–ª—è–¥

–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –¥–æ–∑–≤–æ–ª—è—é—Ç—å –≤–ª–∞—Å–Ω–∏–∫–∞–º –ø–ª–æ—Ç—ñ–≤ –¥–µ–ª–µ–≥—É–≤–∞—Ç–∏ –ø—Ä–∞–≤–∞ –∫—É–≤–∞–Ω–Ω—è —ñ–Ω—à–∏–º –∞–¥—Ä–µ—Å–∞–º, –∑–±–µ—Ä—ñ–≥–∞—é—á–∏ –ø—Ä–∏ —Ü—å–æ–º—É –≤–æ–ª–æ–¥—ñ–Ω–Ω—è –ø–ª–æ—Ç–æ–º.

**–í–∏–ø–∞–¥–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:**
- –ü—É–ª-–º–∞–π–Ω—ñ–Ω–≥ (–ø–ª–æ—Ç–∏ –ø—Ä–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –Ω–∞ –∞–¥—Ä–µ—Å—É –ø—É–ª—É)
- –•–æ–ª–æ–¥–Ω–µ –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è (–∫–ª—é—á –º–∞–π–Ω—ñ–Ω–≥—É –æ–∫—Ä–µ–º–æ –≤—ñ–¥ –≤–æ–ª–æ–¥—ñ–Ω–Ω—è –ø–ª–æ—Ç–æ–º)
- –ë–∞–≥–∞—Ç–æ—Å—Ç–æ—Ä–æ–Ω–Ω—ñ–π –º–∞–π–Ω—ñ–Ω–≥ (—Å–ø—ñ–ª—å–Ω–∞ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å

**–î–∏–∑–∞–π–Ω —Ç—ñ–ª—å–∫–∏ –Ω–∞ OP_RETURN:**
- –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É –≤–∏–≤–æ–¥–∞—Ö OP_RETURN (–±–µ–∑ UTXO)
- –ë–µ–∑ –≤–∏–º–æ–≥ –≤–∏—Ç—Ä–∞—á–∞–Ω–Ω—è (–±–µ–∑ dust, –±–µ–∑ –∫–æ–º—ñ—Å—ñ–π –∑–∞ —É—Ç—Ä–∏–º–∞–Ω–Ω—è)
- –í—ñ–¥—Å—Ç–µ–∂—É—é—Ç—å—Å—è –≤ —Ä–æ–∑—à–∏—Ä–µ–Ω–æ–º—É —Å—Ç–∞–Ω—ñ CCoinsViewCache
- –ê–∫—Ç–∏–≤—É—é—Ç—å—Å—è –ø—ñ—Å–ª—è –ø–µ—Ä—ñ–æ–¥—É –∑–∞—Ç—Ä–∏–º–∫–∏ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: 4 –±–ª–æ–∫–∏)

**–°—Ç–∞–Ω–∏ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å:**
```cpp
enum class ForgingState : uint8_t {
    UNASSIGNED = 0,  // –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–µ —ñ—Å–Ω—É—î
    ASSIGNING = 1,   // –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –æ—á—ñ–∫—É—î –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó (–ø–µ—Ä—ñ–æ–¥ –∑–∞—Ç—Ä–∏–º–∫–∏)
    ASSIGNED = 2,    // –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∞–∫—Ç–∏–≤–Ω–µ, –∫—É–≤–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª–µ–Ω–æ
    REVOKING = 3,    // –°–∫–∞—Å—É–≤–∞–Ω–Ω—è –æ—á—ñ–∫—É—î (–ø–µ—Ä—ñ–æ–¥ –∑–∞—Ç—Ä–∏–º–∫–∏, —â–µ –∞–∫—Ç–∏–≤–Ω–µ)
    REVOKED = 4      // –°–∫–∞—Å—É–≤–∞–Ω–Ω—è –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –±—ñ–ª—å—à–µ –Ω–µ –∞–∫—Ç–∏–≤–Ω–µ
};
```

### –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å

**–§–æ—Ä–º–∞—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó:**
```cpp
Transaction {
    inputs: [any]  // –î–æ–≤–æ–¥–∏—Ç—å –≤–æ–ª–æ–¥—ñ–Ω–Ω—è –∞–¥—Ä–µ—Å–æ—é –ø–ª–æ—Ç—É
    outputs: [
        OP_RETURN <ASSIGN_MAGIC> <plot_address> <forging_address>
    ]
}
```

**–ü—Ä–∞–≤–∏–ª–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó:**
1. –í—Ö—ñ–¥ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –ø—ñ–¥–ø–∏—Å–∞–Ω–∏–π –≤–ª–∞—Å–Ω–∏–∫–æ–º –ø–ª–æ—Ç—É (–¥–æ–≤–æ–¥–∏—Ç—å –≤–æ–ª–æ–¥—ñ–Ω–Ω—è)
2. OP_RETURN –º—ñ—Å—Ç–∏—Ç—å –≤–∞–ª—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è
3. –ü–ª–æ—Ç –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ UNASSIGNED –∞–±–æ REVOKED
4. –ë–µ–∑ –¥—É–±–ª—ñ–∫–∞—Ç—ñ–≤ –æ—á—ñ–∫—É–≤–∞–Ω–∏—Ö –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å —É mempool
5. –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ –∫–æ–º—ñ—Å—ñ—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó —Å–ø–ª–∞—á–µ–Ω–∞

**–ê–∫—Ç–∏–≤–∞—Ü—ñ—è:**
- –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è —Å—Ç–∞—î ASSIGNING –Ω–∞ –≤–∏—Å–æ—Ç—ñ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è
- –°—Ç–∞—î ASSIGNED –ø—ñ—Å–ª—è –ø–µ—Ä—ñ–æ–¥—É –∑–∞—Ç—Ä–∏–º–∫–∏ (4 –±–ª–æ–∫–∏ regtest, 30 –±–ª–æ–∫—ñ–≤ mainnet)
- –ó–∞—Ç—Ä–∏–º–∫–∞ –∑–∞–ø–æ–±—ñ–≥–∞—î —à–≤–∏–¥–∫–∏–º –ø–µ—Ä–µ–ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º –ø—ñ–¥ —á–∞—Å –≥–æ–Ω–æ–∫ –±–ª–æ–∫—ñ–≤

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** `src/script/forging_assignment.h`, –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –≤ ConnectBlock

### –°–∫–∞—Å—É–≤–∞–Ω–Ω—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å

**–§–æ—Ä–º–∞—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó:**
```cpp
Transaction {
    inputs: [any]  // –î–æ–≤–æ–¥–∏—Ç—å –≤–æ–ª–æ–¥—ñ–Ω–Ω—è –∞–¥—Ä–µ—Å–æ—é –ø–ª–æ—Ç—É
    outputs: [
        OP_RETURN <REVOKE_MAGIC> <plot_address>
    ]
}
```

**–ï—Ñ–µ–∫—Ç:**
- –ù–µ–≥–∞–π–Ω–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ —Å—Ç–∞–Ω—É –¥–æ REVOKED
- –í–ª–∞—Å–Ω–∏–∫ –ø–ª–æ—Ç—É –º–æ–∂–µ –∫—É–≤–∞—Ç–∏ –Ω–µ–≥–∞–π–Ω–æ
- –ú–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø—ñ—Å–ª—è —Ü—å–æ–≥–æ

### –í–∞–ª—ñ–¥–∞—Ü—ñ—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å –ø—ñ–¥ —á–∞—Å –º–∞–π–Ω—ñ–Ω–≥—É

**–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞:**
```cpp
// –£ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó submit_nonce
effective_signer = GetEffectiveSigner(plot_address, height, view);
if (!HaveAccountKey(effective_signer, wallet)) reject;

// –£ –∫—É–≤–∞–Ω–Ω—ñ –±–ª–æ–∫—É
coinbase_script = P2WPKH(effective_signer);  // –í–∏–Ω–∞–≥–æ—Ä–æ–¥–∞ –π–¥–µ —Å—é–¥–∏

// –£ –ø—ñ–¥–ø–∏—Å—ñ –±–ª–æ–∫—É
signature = effective_signer_key.SignCompact(hash);  // –ü–æ–≤–∏–Ω–µ–Ω –ø—ñ–¥–ø–∏—Å–∞—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–æ–º
```

**–í–∞–ª—ñ–¥–∞—Ü—ñ—è –±–ª–æ–∫—É:**
```cpp
// –£ VerifyPoCXBlockCompactSignature (—Ä–æ–∑—à–∏—Ä–µ–Ω–∞)
effective_signer = GetEffectiveSigner(proof.account_id, height, view);
pubkey_account = ExtractAccountIDFromPubKey(block.vchPubKey);
if (pubkey_account != effective_signer) reject;
```

**–ö–ª—é—á–æ–≤—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ:**
- –î–æ–∫–∞–∑ –∑–∞–≤–∂–¥–∏ –º—ñ—Å—Ç–∏—Ç—å –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω—É –∞–¥—Ä–µ—Å—É –ø–ª–æ—Ç—É
- –ü—ñ–¥–ø–∏—Å –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –≤—ñ–¥ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç–∞
- Coinbase –ø–ª–∞—Ç–∏—Ç—å –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –ø—ñ–¥–ø–∏—Å–∞–Ω—Ç—É
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Å—Ç–∞–Ω –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ –≤–∏—Å–æ—Ç—ñ –±–ª–æ–∫—É

---

## –ú–µ—Ä–µ–∂–µ–≤–µ —Ä–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω–Ω—è

### –û–≥–æ–ª–æ—à–µ–Ω–Ω—è –±–ª–æ–∫—É

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π P2P –ø—Ä–æ—Ç–æ–∫–æ–ª Bitcoin:**
1. –°–∫–æ–≤–∞–Ω–∏–π –±–ª–æ–∫ –ø–æ–¥–∞—î—Ç—å—Å—è —á–µ—Ä–µ–∑ `ProcessNewBlock()`
2. –ë–ª–æ–∫ –≤–∞–ª—ñ–¥—É—î—Ç—å—Å—è —Ç–∞ –¥–æ–¥–∞—î—Ç—å—Å—è –¥–æ –ª–∞–Ω—Ü—é–≥–∞
3. –ú–µ—Ä–µ–∂–µ–≤–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è: `GetMainSignals().BlockConnected()`
4. P2P —Ä—ñ–≤–µ–Ω—å —Ä–æ–∑—Å–∏–ª–∞—î –±–ª–æ–∫ –ø—ñ—Ä–∞–º

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –º–µ—Ä–µ–∂—ñ Bitcoin Core

### –†–µ—Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ—è –±–ª–æ–∫—ñ–≤

**–ö–æ–º–ø–∞–∫—Ç–Ω—ñ –±–ª–æ–∫–∏ (BIP 152):**
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω–Ω—è –±–ª–æ–∫—ñ–≤
- –°–ø–æ—á–∞—Ç–∫—É –Ω–∞–¥—Å–∏–ª–∞—é—Ç—å—Å—è –ª–∏—à–µ ID —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
- –ü—ñ—Ä–∏ –∑–∞–ø–∏—Ç—É—é—Ç—å –≤—ñ–¥—Å—É—Ç–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó

**–†–µ—Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ—è –ø–æ–≤–Ω–∏—Ö –±–ª–æ–∫—ñ–≤:**
- –†–µ–∑–µ—Ä–≤–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç –∫–æ–ª–∏ –∫–æ–º–ø–∞–∫—Ç–Ω—ñ –±–ª–æ–∫–∏ –Ω–µ –ø—Ä–∞—Ü—é—é—Ç—å
- –ü–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –ø–æ–≤–Ω—ñ –¥–∞–Ω—ñ –±–ª–æ–∫—É

### –†–µ–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó –ª–∞–Ω—Ü—é–≥–∞

**–û–±—Ä–æ–±–∫–∞ —Ä–µ–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π:**
```cpp
// –£ —Ä–æ–±–æ—á–æ–º—É –ø–æ—Ç–æ—Ü—ñ –∫—É–≤–∞—á–∞
if (current_tip_hash != stored_tip_hash) {
    // –í–∏—è–≤–ª–µ–Ω–æ —Ä–µ–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—é –ª–∞–Ω—Ü—é–≥–∞
    reset_forging_state();
    log("–í–µ—Ä—Ö—ñ–≤–∫–∞ –ª–∞–Ω—Ü—é–≥–∞ –∑–º—ñ–Ω–∏–ª–∞—Å—è, —Å–∫–∏–¥–∞–Ω–Ω—è –∫—É–≤–∞–Ω–Ω—è");
}
```

**–†—ñ–≤–µ–Ω—å –±–ª–æ–∫—á–µ–π–Ω—É:**
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞ —Ä–µ–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π Bitcoin Core
- –ù–∞–π–∫—Ä–∞—â–∏–π –ª–∞–Ω—Ü—é–≥ –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –∑–∞ chainwork
- –í—ñ–¥'—î–¥–Ω–∞–Ω—ñ –±–ª–æ–∫–∏ –ø–æ–≤–µ—Ä—Ç–∞—é—Ç—å—Å—è –¥–æ mempool

---

## –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

### –ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –≤–∑–∞—î–º–Ω–∏–º –±–ª–æ–∫—É–≤–∞–Ω–Ω—è–º

**–ü–∞—Ç–µ—Ä–Ω –≤–∑–∞—î–º–Ω–æ–≥–æ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è ABBA (–∑–∞–ø–æ–±—ñ–≥–∞—î—Ç—å—Å—è):**
```
–ü–æ—Ç—ñ–∫ A: cs_main ‚Üí cs_wallet
–ü–æ—Ç—ñ–∫ B: cs_wallet ‚Üí cs_main
```

**–†—ñ—à–µ–Ω–Ω—è:**
1. **submit_nonce:** –ù—É–ª—å–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è cs_main
   - `GetNewBlockContext()` –æ–±—Ä–æ–±–ª—è—î –±–ª–æ–∫—É–≤–∞–Ω–Ω—è –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ
   - –£—Å—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–æ –ø–æ–¥–∞–Ω–Ω—è –∫—É–≤–∞—á—É

2. **–ö—É–≤–∞—á:** –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–µ—Ä–≥–∏
   - –û–¥–∏–Ω —Ä–æ–±–æ—á–∏–π –ø–æ—Ç—ñ–∫ (–±–µ–∑ –ø—Ä–∏—î–¥–Ω–∞–Ω–Ω—è –ø–æ—Ç–æ–∫—ñ–≤)
   - –°–≤—ñ–∂–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –¥–æ—Å—Ç—É–ø—ñ
   - –ë–µ–∑ –≤–∫–ª–∞–¥–µ–Ω–∏—Ö –±–ª–æ–∫—É–≤–∞–Ω—å

3. **–ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≥–∞–º–∞–Ω—Ü—è:** –í–∏–∫–æ–Ω—É—é—Ç—å—Å—è –¥–æ –¥–æ—Ä–æ–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
   - –†–∞–Ω–Ω—î –≤—ñ–¥—Ö–∏–ª–µ–Ω–Ω—è —è–∫—â–æ –∫–ª—é—á –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π
   - –û–∫—Ä–µ–º–æ –≤—ñ–¥ –¥–æ—Å—Ç—É–ø—É –¥–æ —Å—Ç–∞–Ω—É –±–ª–æ–∫—á–µ–π–Ω—É

### –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

**–®–≤–∏–¥–∫–∏–π –ø—Ä–æ–≤–∞–ª –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó:**
```cpp
1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ñ–æ—Ä–º–∞—Ç—É (–Ω–µ–≥–∞–π–Ω—ñ)
2. –í–∞–ª—ñ–¥–∞—Ü—ñ—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É (–ª–µ–≥–∫–∞)
3. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥–∞–º–∞–Ω—Ü—è (–ª–æ–∫–∞–ª—å–Ω–∞)
4. –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–æ–∫–∞–∑—É (–¥–æ—Ä–æ–≥–∞ SIMD)
```

**–û–¥–Ω–æ—Ä–∞–∑–æ–≤–µ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É:**
- –û–¥–∏–Ω –≤–∏–∫–ª–∏–∫ `GetNewBlockContext()` –Ω–∞ –ø–æ–¥–∞–Ω–Ω—è
- –ö–µ—à—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –¥–ª—è –∫—ñ–ª—å–∫–æ—Ö –ø–µ—Ä–µ–≤—ñ—Ä–æ–∫
- –ë–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–∏—Ö –∑–∞—Ö–æ–ø–ª–µ–Ω—å cs_main

**–ï—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —á–µ—Ä–≥–∏:**
- –õ–µ–≥–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–¥–∞–Ω–Ω—è
- –ë–µ–∑ base_target/deadline –≤ —á–µ—Ä–∑—ñ (–ø–µ—Ä–µ—Ä–∞—Ö–æ–≤—É—é—Ç—å—Å—è —Å–≤—ñ–∂—ñ)
- –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –≤—ñ–¥–±–∏—Ç–æ–∫ –ø–∞–º'—è—Ç—ñ

### –û–±—Ä–æ–±–∫–∞ –∑–∞—Å—Ç–∞—Ä—ñ–ª–æ—Å—Ç—ñ

**–î–∏–∑–∞–π–Ω "–ø—Ä–æ—Å—Ç–æ–≥–æ" –∫—É–≤–∞—á–∞:**
- –ë–µ–∑ –ø—ñ–¥–ø–∏—Å–æ–∫ –Ω–∞ –ø–æ–¥—ñ—ó –±–ª–æ–∫—á–µ–π–Ω—É
- –õ–µ–¥–∞—á–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –∫–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ
- –ú–æ–≤—á–∞–∑–Ω–µ –≤—ñ–¥–∫–∏–¥–∞–Ω–Ω—è –∑–∞—Å—Ç–∞—Ä—ñ–ª–∏—Ö –ø–æ–¥–∞–Ω—å

**–ü–µ—Ä–µ–≤–∞–≥–∏:**
- –ü—Ä–æ—Å—Ç–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
- –ë–µ–∑ —Å–∫–ª–∞–¥–Ω–æ—ó —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó
- –°—Ç—ñ–π–∫—ñ—Å—Ç—å –¥–æ –∫—Ä–∞–π–Ω—ñ—Ö –≤–∏–ø–∞–¥–∫—ñ–≤

**–û–±—Ä–æ–±–ª—é–≤–∞–Ω—ñ –∫—Ä–∞–π–Ω—ñ –≤–∏–ø–∞–¥–∫–∏:**
- –ó–º—ñ–Ω–∏ –≤–∏—Å–æ—Ç–∏ ‚Üí –≤—ñ–¥–∫–∏–Ω—É—Ç–∏
- –ó–º—ñ–Ω–∏ —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó ‚Üí –≤—ñ–¥–∫–∏–Ω—É—Ç–∏
- –ó–º—ñ–Ω–∏ –±–∞–∑–æ–≤–æ—ó —Ü—ñ–ª—ñ ‚Üí –ø–µ—Ä–µ—Ä–∞—Ö—É–≤–∞—Ç–∏ –¥–µ–¥–ª–∞–π–Ω
- –†–µ–æ—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ—ó ‚Üí —Å–∫–∏–Ω—É—Ç–∏ —Å—Ç–∞–Ω –∫—É–≤–∞–Ω–Ω—è

### –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó:**
```cpp
SHA256(prev_generation_signature || prev_miner_pubkey_33bytes)
```

**–•–µ—à –ø—ñ–¥–ø–∏—Å—É –±–ª–æ–∫—É:**
```cpp
hash = SHA256(SHA256("POCX Signed Block:\n" || block_hash_hex))
```

**–§–æ—Ä–º–∞—Ç –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥–æ –ø—ñ–¥–ø–∏—Å—É:**
- 65 –±–∞–π—Ç—ñ–≤: [recovery_id][r][s]
- –î–æ–∑–≤–æ–ª—è—î –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –∫–ª—é—á–∞
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –µ–∫–æ–Ω–æ–º—ñ—ó –ø—Ä–æ—Å—Ç–æ—Ä—É

**Account ID:**
- 20-–±–∞–π—Ç–æ–≤–∏–π HASH160 —Å—Ç–∏—Å–Ω—É—Ç–æ–≥–æ –ø—É–±–ª—ñ—á–Ω–æ–≥–æ –∫–ª—é—á–∞
- –í—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ñ–æ—Ä–º–∞—Ç–∞–º –∞–¥—Ä–µ—Å Bitcoin (P2PKH, P2WPKH)

### –ú–∞–π–±—É—Ç–Ω—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è

**–ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ –æ–±–º–µ–∂–µ–Ω–Ω—è:**
1. –ë–µ–∑ –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ (—á–∞—Å—Ç–æ—Ç–∞ –ø–æ–¥–∞–Ω—å, —Ä–æ–∑–ø–æ–¥—ñ–ª –¥–µ–¥–ª–∞–π–Ω—ñ–≤)
2. –ë–µ–∑ –¥–µ—Ç–∞–ª—å–Ω–æ—ó –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü—ñ—ó –ø–æ–º–∏–ª–æ–∫ –¥–ª—è –º–∞–π–Ω–µ—Ä—ñ–≤
3. –û–±–º–µ–∂–µ–Ω–µ –∑–∞–ø–∏—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∞—Ç—É—Å—É –∫—É–≤–∞—á–∞ (–ø–æ—Ç–æ—á–Ω–∏–π –¥–µ–¥–ª–∞–π–Ω, –≥–ª–∏–±–∏–Ω–∞ —á–µ—Ä–≥–∏)

**–ú–æ–∂–ª–∏–≤—ñ –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è:**
- RPC –¥–ª—è —Å—Ç–∞—Ç—É—Å—É –∫—É–≤–∞—á–∞
- –ú–µ—Ç—Ä–∏–∫–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –º–∞–π–Ω—ñ–Ω–≥—É
- –ü–æ–∫—Ä–∞—â–µ–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª—É –ø—É–ª—É

---

## –ü–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –∫–æ–¥

**–û—Å–Ω–æ–≤–Ω—ñ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó:**
- –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å RPC: `src/pocx/rpc/mining.cpp`
- –ß–µ—Ä–≥–∞ –∫—É–≤–∞—á–∞: `src/pocx/mining/scheduler.cpp`
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É: `src/pocx/consensus/validation.cpp`
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–æ–∫–∞–∑—É: `src/pocx/consensus/pocx.cpp`
- Time Bending: `src/pocx/algorithms/time_bending.cpp`
- –í–∞–ª—ñ–¥–∞—Ü—ñ—è –±–ª–æ–∫—ñ–≤: `src/validation.cpp` (CheckBlockHeader, ConnectBlock)
- –õ–æ–≥—ñ–∫–∞ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å: `src/pocx/consensus/validation.cpp:GetEffectiveSigner()`
- –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º: `src/pocx/node/node.cpp:GetNewBlockContext()`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∏ –¥–∞–Ω–∏—Ö:**
- –§–æ—Ä–º–∞—Ç –±–ª–æ–∫—É: `src/primitives/block.h`
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É: `src/consensus/params.h`
- –í—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—å: `src/coins.h` (—Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è CCoinsViewCache)

---

## –î–æ–¥–∞—Ç–æ–∫: –°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤

### –§–æ—Ä–º—É–ª–∞ Time Bending

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è:**
```
deadline_seconds = quality / base_target  (—Å–∏—Ä–∏–π)

time_bended_deadline = scale * (deadline_seconds)^(1/3)

–¥–µ:
  scale = block_time / (cbrt(block_time) * Gamma(4/3))
  Gamma(4/3) ‚âà 0.892979511
```

**–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è:**
- –ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –∑ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–æ—é —Ç–æ—á–∫–æ—é (—Ñ–æ—Ä–º–∞—Ç Q42)
- –¶—ñ–ª–æ—á–∏—Å–µ–ª—å–Ω–µ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∫—É–±—ñ—á–Ω–æ–≥–æ –∫–æ—Ä–µ–Ω—è
- –û–ø—Ç–∏–º—ñ–∑–æ–≤–∞–Ω–æ –¥–ª—è 256-–±—ñ—Ç–Ω–æ—ó –∞—Ä–∏—Ñ–º–µ—Ç–∏–∫–∏

### –û–±—á–∏—Å–ª–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ

**–ü—Ä–æ—Ü–µ—Å:**
1. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è scoop –∑ —Å–∏–≥–Ω–∞—Ç—É—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ç–∞ –≤–∏—Å–æ—Ç–∏
2. –ß–∏—Ç–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø–ª–æ—Ç—É –¥–ª—è –æ–±—á–∏—Å–ª–µ–Ω–æ–≥–æ scoop
3. –•–µ—à: `SHABAL256(generation_signature || scoop_data)`
4. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —Ä—ñ–≤–Ω—ñ–≤ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è –≤—ñ–¥ min –¥–æ max
5. –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –Ω–∞–π–∫—Ä–∞—â–æ—ó –∑–Ω–∞–π–¥–µ–Ω–æ—ó —è–∫–æ—Å—Ç—ñ

**–ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è:**
- –†—ñ–≤–µ–Ω—å X0: –ë–∞–∑–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å POC2 (—Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–∏–π)
- –†—ñ–≤–µ–Ω—å X1: –ë–∞–∑–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å XOR-transpose
- –†—ñ–≤–µ–Ω—å Xn: 2^(n-1) √ó –≤–±—É–¥–æ–≤–∞–Ω–∞ —Ä–æ–±–æ—Ç–∞ X1
- –í–∏—â–µ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è = –±—ñ–ª—å—à–µ —Ä–æ–±–æ—Ç–∏ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø–ª–æ—Ç—É

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–∞–∑–æ–≤–æ—ó —Ü—ñ–ª—ñ

**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–∂–Ω–æ–≥–æ –±–ª–æ–∫—É:**
1. –û–±—á–∏—Å–ª–µ–Ω–Ω—è –∫–æ–≤–∑–Ω–æ–≥–æ —Å–µ—Ä–µ–¥–Ω—å–æ–≥–æ –Ω–µ–¥–∞–≤–Ω—ñ—Ö –±–∞–∑–æ–≤–∏—Ö —Ü—ñ–ª–µ–π
2. –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Ñ–∞–∫—Ç–∏—á–Ω–æ–≥–æ —á–∞—Å—É vs —Ü—ñ–ª—å–æ–≤–æ–≥–æ —á–∞—Å—É –¥–ª—è –∫–æ–≤–∑–Ω–æ–≥–æ –≤—ñ–∫–Ω–∞
3. –ü—Ä–æ–ø–æ—Ä—Ü—ñ–π–Ω–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–∞–∑–æ–≤–æ—ó —Ü—ñ–ª—ñ
4. –û–±–º–µ–∂–µ–Ω–Ω—è –¥–ª—è –∑–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è –µ–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–∏—Ö –∫–æ–ª–∏–≤–∞–Ω—å

**–§–æ—Ä–º—É–ª–∞:**
```
avg_base_target = moving_average(–Ω–µ–¥–∞–≤–Ω—ñ –±–∞–∑–æ–≤—ñ —Ü—ñ–ª—ñ)
adjustment_factor = actual_timespan / target_timespan
new_base_target = avg_base_target * adjustment_factor
new_base_target = clamp(new_base_target, min, max)
```

---

*–¶—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –ø–æ–≤–Ω—É —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é –∫–æ–Ω—Å–µ–Ω—Å—É—Å—É PoCX —Å—Ç–∞–Ω–æ–º –Ω–∞ –∂–æ–≤—Ç–µ–Ω—å 2025.*

---

[‚Üê –ù–∞–∑–∞–¥: –§–æ—Ä–º–∞—Ç –ø–ª–æ—Ç—ñ–≤](2-plot-format.md) | [üìò –ó–º—ñ—Å—Ç](index.md) | [–î–∞–ª—ñ: –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∫—É–≤–∞–Ω–Ω—è ‚Üí](4-forging-assignments.md)
