[‚Üê –ü—Ä–µ—Ç—Ö–æ–¥–Ω–æ: –ö–æ–Ω—Å–µ–Ω–∑—É—Å –∏ —Ä—É–¥–∞—Ä–µ—ö–µ](3-consensus-and-mining.md) | [üìò –°–∞–¥—Ä–∂–∞—ò](index.md) | [–°–ª–µ–¥–µ—õ–µ: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—ò–∞ –≤—Ä–µ–º–µ–Ω–∞ ‚Üí](5-timing-security.md)

---

# –ü–æ–≥–ª–∞–≤—ô–µ 4: PoCX —Å–∏—Å—Ç–µ–º –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∫–æ–≤–∞—ö–∞

## –ò–∑–≤—Ä—à–Ω–∏ —Ä–µ–∑–∏–º–µ

–û–≤–∞—ò –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—É—ò–µ **–∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–∏** PoCX —Å–∏—Å—Ç–µ–º –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∫–æ–≤–∞—ö–∞ –∫–æ—ò–∏ –∫–æ—Ä–∏—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏—Å–∫—ô—É—á–∏–≤–æ –Ω–∞ OP_RETURN. –°–∏—Å—Ç–µ–º –æ–º–æ–≥—É—õ–∞–≤–∞ –≤–ª–∞—Å–Ω–∏—Ü–∏–º–∞ –ø–ª–æ—Ç–æ–≤–∞ –¥–∞ –¥–µ–ª–µ–≥–∏—Ä–∞—ò—É –ø—Ä–∞–≤–∞ –∫–æ–≤–∞—ö–∞ –æ–¥–≤–æ—ò–µ–Ω–∏–º –∞–¥—Ä–µ—Å–∞–º–∞ –∫—Ä–æ–∑ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ –Ω–∞ –ª–∞–Ω—Ü—É, —Å–∞ –ø—É–Ω–æ–º –±–µ–∑–±–µ–¥–Ω–æ—à—õ—É —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–µ –∏ –∞—Ç–æ–º—Å–∫–∏–º –æ–ø–µ—Ä–∞—Ü–∏—ò–∞–º–∞ –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞.

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ—Ç–ø—É–Ω–æ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–æ –∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ

## –û—Å–Ω–æ–≤–Ω–∞ —Ñ–∏–ª–æ–∑–æ—Ñ–∏—ò–∞ –¥–∏–∑–∞—ò–Ω–∞

**–ö—ô—É—á–Ω–∏ –ø—Ä–∏–Ω—Ü–∏–ø:** –î–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Å—É –¥–æ–∑–≤–æ–ª–µ, –Ω–µ —Å—Ä–µ–¥—Å—Ç–≤–∞

- –ù–µ–º–∞ —Å–ø–µ—Ü–∏—ò–∞–ª–Ω–∏—Ö UTXO-–∞ –∑–∞ –ø—Ä–∞—õ–µ—ö–µ –∏–ª–∏ —Ç—Ä–æ—à–µ—ö–µ
- –°—Ç–∞—ö–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Å–∫–ª–∞–¥–∏—à—Ç–µ–Ω–æ –æ–¥–≤–æ—ò–µ–Ω–æ –æ–¥ UTXO —Å–∫—É–ø–∞
- –í–ª–∞—Å–Ω–∏—à—Ç–≤–æ –¥–æ–∫–∞–∑–∞–Ω–æ –ø–æ—Ç–ø–∏—Å–æ–º —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ, –Ω–µ —Ç—Ä–æ—à–µ—ö–µ–º UTXO-–∞
- –ö–æ–º–ø–ª–µ—Ç–Ω–æ –ø—Ä–∞—õ–µ—ö–µ –∏—Å—Ç–æ—Ä–∏—ò–µ –∑–∞ –ø–æ—Ç–ø—É–Ω—É —Ä–µ–≤–∏–∑–∏—ò—Å–∫—É —Ç—Ä–∞–≥
- –ê—Ç–æ–º—Å–∫–∞ –∞–∂—É—Ä–∏—Ä–∞—ö–∞ –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞ –∫—Ä–æ–∑ LevelDB –≥—Ä—É–ø–Ω–µ –∑–∞–ø–∏—Å–µ

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ

### –§–æ—Ä–º–∞—Ç —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞

```
–£–ª–∞–∑–∏:
  [0]: –ë–∏–ª–æ –∫–æ—ò–∏ UTXO –∫–æ–Ω—Ç—Ä–æ–ª–∏—Å–∞–Ω –æ–¥ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞ (–¥–æ–∫–∞–∑—É—ò–µ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ + –ø–ª–∞—õ–∞ –Ω–∞–∫–Ω–∞–¥–µ)
       –ú–æ—Ä–∞ –±–∏—Ç–∏ –ø–æ—Ç–ø–∏—Å–∞–Ω –ø—Ä–∏–≤–∞—Ç–Ω–∏–º –∫—ô—É—á–µ–º –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞
  [1+]: –û–ø—Ü–∏–æ–Ω–∏ –¥–æ–¥–∞—Ç–Ω–∏ —É–ª–∞–∑–∏ –∑–∞ –ø–æ–∫—Ä–∏—õ–µ –Ω–∞–∫–Ω–∞–¥–µ

–ò–∑–ª–∞–∑–∏:
  [0]: OP_RETURN (POCX –º–∞—Ä–∫–µ—Ä + –∞–¥—Ä–µ—Å–∞ –ø–ª–æ—Ç–∞ + –∞–¥—Ä–µ—Å–∞ –∫–æ–≤–∞—ö–∞)
       –§–æ—Ä–º–∞—Ç: OP_RETURN <0x2c> "POCX" <plot_addr_20> <forge_addr_20>
       –í–µ–ª–∏—á–∏–Ω–∞: —É–∫—É–ø–Ω–æ 46 –±–∞—ò—Ç–æ–≤–∞ (1 –±–∞—ò—Ç OP_RETURN + 1 –±–∞—ò—Ç –¥—É–∂–∏–Ω–∞ + 44 –±–∞—ò—Ç–∞ –ø–æ–¥–∞—Ü–∏)
       –í—Ä–µ–¥–Ω–æ—Å—Ç: 0 BTC (–Ω–∏—ò–µ –ø–æ—Ç—Ä–æ—à–∏–≤–æ, –Ω–µ –¥–æ–¥–∞—ò–µ —Å–µ —É UTXO —Å–∫—É–ø)

  [1]: –ö—É—Å—É—Ä –Ω–∞–∑–∞–¥ –∫–æ—Ä–∏—Å–Ω–∏–∫—É (–æ–ø—Ü–∏–æ–Ω–æ, —Å—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∏ P2WPKH)
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/assignments/opcodes.cpp:25-52`

### –§–æ—Ä–º–∞—Ç —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ –æ–ø–æ–∑–∏–≤–∞

```
–£–ª–∞–∑–∏:
  [0]: –ë–∏–ª–æ –∫–æ—ò–∏ UTXO –∫–æ–Ω—Ç—Ä–æ–ª–∏—Å–∞–Ω –æ–¥ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞ (–¥–æ–∫–∞–∑—É—ò–µ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ + –ø–ª–∞—õ–∞ –Ω–∞–∫–Ω–∞–¥–µ)
       –ú–æ—Ä–∞ –±–∏—Ç–∏ –ø–æ—Ç–ø–∏—Å–∞–Ω –ø—Ä–∏–≤–∞—Ç–Ω–∏–º –∫—ô—É—á–µ–º –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞
  [1+]: –û–ø—Ü–∏–æ–Ω–∏ –¥–æ–¥–∞—Ç–Ω–∏ —É–ª–∞–∑–∏ –∑–∞ –ø–æ–∫—Ä–∏—õ–µ –Ω–∞–∫–Ω–∞–¥–µ

–ò–∑–ª–∞–∑–∏:
  [0]: OP_RETURN (XCOP –º–∞—Ä–∫–µ—Ä + –∞–¥—Ä–µ—Å–∞ –ø–ª–æ—Ç–∞)
       –§–æ—Ä–º–∞—Ç: OP_RETURN <0x18> "XCOP" <plot_addr_20>
       –í–µ–ª–∏—á–∏–Ω–∞: —É–∫—É–ø–Ω–æ 26 –±–∞—ò—Ç–æ–≤–∞ (1 –±–∞—ò—Ç OP_RETURN + 1 –±–∞—ò—Ç –¥—É–∂–∏–Ω–∞ + 24 –±–∞—ò—Ç–∞ –ø–æ–¥–∞—Ü–∏)
       –í—Ä–µ–¥–Ω–æ—Å—Ç: 0 BTC (–Ω–∏—ò–µ –ø–æ—Ç—Ä–æ—à–∏–≤–æ, –Ω–µ –¥–æ–¥–∞—ò–µ —Å–µ —É UTXO —Å–∫—É–ø)

  [1]: –ö—É—Å—É—Ä –Ω–∞–∑–∞–¥ –∫–æ—Ä–∏—Å–Ω–∏–∫—É (–æ–ø—Ü–∏–æ–Ω–æ, —Å—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∏ P2WPKH)
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/assignments/opcodes.cpp:54-77`

### –ú–∞—Ä–∫–µ—Ä–∏

- **–ú–∞—Ä–∫–µ—Ä –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞:** `POCX` (0x50, 0x4F, 0x43, 0x58) = "Proof of Capacity neXt"
- **–ú–∞—Ä–∫–µ—Ä –æ–ø–æ–∑–∏–≤–∞:** `XCOP` (0x58, 0x43, 0x4F, 0x50) = "eXit Capacity OPeration"

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/assignments/opcodes.cpp:15-19`

### –ö—ô—É—á–Ω–µ –∫–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–µ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞

- –°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–µ Bitcoin —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ (–±–µ–∑ –ø—Ä–æ–º–µ–Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞)
- OP_RETURN –∏–∑–ª–∞–∑–∏ —Å—É –¥–æ–∫–∞–∑–∏–≤–æ –Ω–µ–ø–æ—Ç—Ä–æ—à–∏–≤–∏ (–Ω–∏–∫–∞–¥–∞ —Å–µ –Ω–µ –¥–æ–¥–∞—ò—É —É UTXO —Å–∫—É–ø)
- –í–ª–∞—Å–Ω–∏—à—Ç–≤–æ –Ω–∞–¥ –ø–ª–æ—Ç–æ–º –¥–æ–∫–∞–∑–∞–Ω–æ –ø–æ—Ç–ø–∏—Å–æ–º –Ω–∞ input[0] –æ–¥ –∞–¥—Ä–µ—Å–µ –ø–ª–æ—Ç–∞
- –ù–∏—Å–∫–∞ —Ü–µ–Ω–∞ (~200 –±–∞—ò—Ç–æ–≤–∞, —Ç–∏–ø–∏—á–Ω–æ <0.0001 BTC –Ω–∞–∫–Ω–∞–¥–∞)
- –ù–æ–≤—á–∞–Ω–∏–∫ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –±–∏—Ä–∞ –Ω–∞—ò–≤–µ—õ–∏ UTXO –æ–¥ –∞–¥—Ä–µ—Å–µ –ø–ª–æ—Ç–∞ –¥–∞ –¥–æ–∫–∞–∂–µ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–∫–ª–∞–¥–∏—à—Ç–µ—ö–∞

–°–≤–∏ –ø–æ–¥–∞—Ü–∏ –æ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∏–º–∞ —Å–µ —á—É–≤–∞—ò—É —É –∏—Å—Ç–æ—ò LevelDB –±–∞–∑–∏ –ø–æ–¥–∞—Ç–∞–∫–∞ –∫–∞–æ UTXO —Å–∫—É–ø (`chainstate/`), –∞–ª–∏ —Å–∞ –æ–¥–≤–æ—ò–µ–Ω–∏–º –ø—Ä–µ—Ñ–∏–∫—Å–∏–º–∞ –∫—ô—É—á–µ–≤–∞:

```
chainstate/ LevelDB:
‚îú‚îÄ UTXO —Å–∫—É–ø (Bitcoin Core —Å—Ç–∞–Ω–¥–∞—Ä–¥)
‚îÇ  ‚îî‚îÄ 'C' –ø—Ä–µ—Ñ–∏–∫—Å: COutPoint ‚Üí Coin
‚îÇ
‚îî‚îÄ –°—Ç–∞—ö–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ (PoCX –¥–æ–¥–∞—Ü–∏)
   ‚îî‚îÄ 'A' –ø—Ä–µ—Ñ–∏–∫—Å: (plot_address, assignment_txid) ‚Üí ForgingAssignment
       ‚îî‚îÄ –ö–æ–º–ø–ª–µ—Ç–Ω–∞ –∏—Å—Ç–æ—Ä–∏—ò–∞: —Å–≤–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –ø–æ –ø–ª–æ—Ç—É —Ç–æ–∫–æ–º –≤—Ä–µ–º–µ–Ω–∞
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/txdb.cpp:237-348`

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ ForgingAssignment

```cpp
struct ForgingAssignment {
    // –ò–¥–µ–Ω—Ç–∏—Ç–µ—Ç
    std::array<uint8_t, 20> plotAddress;      // –í–ª–∞—Å–Ω–∏–∫ –ø–ª–æ—Ç–∞ (20-–±–∞—ò—Ç–Ω–∏ P2WPKH —Ö–µ—à)
    std::array<uint8_t, 20> forgingAddress;   // –ù–æ—Å–∏–ª–∞—Ü –ø—Ä–∞–≤–∞ –∫–æ–≤–∞—ö–∞ (20-–±–∞—ò—Ç–Ω–∏ P2WPKH —Ö–µ—à)

    // –ñ–∏–≤–æ—Ç–Ω–∏ —Ü–∏–∫–ª—É—Å –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
    uint256 assignment_txid;                   // –¢—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞ –∫–æ—ò–∞ —ò–µ –∫—Ä–µ–∏—Ä–∞–ª–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ
    int assignment_height;                     // –í–∏—Å–∏–Ω–∞ –±–ª–æ–∫–∞ –∫—Ä–µ–∏—Ä–∞—ö–∞
    int assignment_effective_height;           // –ö–∞–¥–∞ –ø–æ—Å—Ç–∞—ò–µ –∞–∫—Ç–∏–≤–Ω–æ (height + delay)

    // –ñ–∏–≤–æ—Ç–Ω–∏ —Ü–∏–∫–ª—É—Å –æ–ø–æ–∑–∏–≤–∞
    bool revoked;                              // –î–∞ –ª–∏ —ò–µ –æ–≤–æ –æ–ø–æ–∑–≤–∞–Ω–æ?
    uint256 revocation_txid;                   // –¢—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞ –∫–æ—ò–∞ —ò–µ –æ–ø–æ–∑–≤–∞–ª–∞
    int revocation_height;                     // –í–∏—Å–∏–Ω–∞ –±–ª–æ–∫–∞ –æ–ø–æ–∑–∏–≤–∞
    int revocation_effective_height;           // –ö–∞–¥–∞ –æ–ø–æ–∑–∏–≤ –ø–æ—Å—Ç–∞—ò–µ –µ—Ñ–µ–∫—Ç–∏–≤–∞–Ω (height + delay)

    // –ú–µ—Ç–æ–¥–µ —É–ø–∏—Ç–∞ —Å—Ç–∞—ö–∞
    ForgingState GetStateAtHeight(int height) const;
    bool IsActiveAtHeight(int height) const;
};
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/coins.h:111-178`

### –°—Ç–∞—ö–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞

```cpp
enum class ForgingState : uint8_t {
    UNASSIGNED = 0,  // –ù–µ–º–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
    ASSIGNING = 1,   // –î–æ–¥–µ—ô–∏–≤–∞—ö–µ –∫—Ä–µ–∏—Ä–∞–Ω–æ, —á–µ–∫–∞ –∫–∞—à—ö–µ—ö–µ –∞–∫—Ç–∏–≤–∞—Ü–∏—ò–µ
    ASSIGNED = 2,    // –î–æ–¥–µ—ô–∏–≤–∞—ö–µ –∞–∫—Ç–∏–≤–Ω–æ, –∫–æ–≤–∞—ö–µ –¥–æ–∑–≤–æ—ô–µ–Ω–æ
    REVOKING = 3,    // –û–ø–æ–∑–≤–∞–Ω–æ, –∞–ª–∏ —ò–æ—à —É–≤–µ–∫ –∞–∫—Ç–∏–≤–Ω–æ —Ç–æ–∫–æ–º –ø–µ—Ä–∏–æ–¥–∞ –∫–∞—à—ö–µ—ö–∞
    REVOKED = 4      // –ü–æ—Ç–ø—É–Ω–æ –æ–ø–æ–∑–≤–∞–Ω–æ, –≤–∏—à–µ –Ω–∏—ò–µ –∞–∫—Ç–∏–≤–Ω–æ
};
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/coins.h:98-104`

### –ö—ô—É—á–µ–≤–∏ –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞

```cpp
// –ö—ô—É—á –∏—Å—Ç–æ—Ä–∏—ò–µ: —á—É–≤–∞ –∫–æ–º–ø–ª–µ—Ç–∞–Ω –∑–∞–ø–∏—Å –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
// –§–æ—Ä–º–∞—Ç –∫—ô—É—á–∞: (prefix, plotAddress, assignment_height, assignment_txid)
struct AssignmentHistoryKey {
    uint8_t prefix;                       // DB_ASSIGNMENT_HISTORY = 'A'
    std::array<uint8_t, 20> plotAddress;  // –ê–¥—Ä–µ—Å–∞ –ø–ª–æ—Ç–∞ (20 –±–∞—ò—Ç–æ–≤–∞)
    int assignment_height;                // –í–∏—Å–∏–Ω–∞ –∑–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—ò—É —Å–æ—Ä—Ç–∏—Ä–∞—ö–∞
    uint256 assignment_txid;              // ID —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ
};
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/txdb.cpp:245-262`

### –ü—Ä–∞—õ–µ—ö–µ –∏—Å—Ç–æ—Ä–∏—ò–µ

- –°–≤–∞–∫–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ —Ç—Ä–∞—ò–Ω–æ —Å–∫–ª–∞–¥–∏—à—Ç–µ–Ω–æ (–Ω–∏–∫–∞–¥–∞ —Å–µ –Ω–µ –±—Ä–∏—à–µ –æ—Å–∏–º —Ä–µ–æ—Ä–≥–∞)
- –í–∏—à–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –ø–æ –ø–ª–æ—Ç—É –ø—Ä–∞—õ–µ–Ω–æ —Ç–æ–∫–æ–º –≤—Ä–µ–º–µ–Ω–∞
- –û–º–æ–≥—É—õ–∞–≤–∞ –ø–æ—Ç–ø—É–Ω—É —Ä–µ–≤–∏–∑–∏—ò—Å–∫—É —Ç—Ä–∞–≥ –∏ —É–ø–∏—Ç–µ –∏—Å—Ç–æ—Ä–∏—ò—Å–∫–æ–≥ —Å—Ç–∞—ö–∞
- –û–ø–æ–∑–≤–∞–Ω–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –æ—Å—Ç–∞—ò—É —É –±–∞–∑–∏ –ø–æ–¥–∞—Ç–∞–∫–∞ —Å–∞ `revoked=true`

## –û–±—Ä–∞–¥–∞ –±–ª–æ–∫–∞

### ConnectBlock –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—ò–∞

OP_RETURN-–æ–≤–∏ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∏ –æ–ø–æ–∑–∏–≤–∞ —Å–µ –æ–±—Ä–∞—í—É—ò—É —Ç–æ–∫–æ–º –ø–æ–≤–µ–∑–∏–≤–∞—ö–∞ –±–ª–æ–∫–∞ —É `validation.cpp`:

```cpp
// –õ–æ–∫–∞—Ü–∏—ò–∞: –ü–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–µ —Å–∫—Ä–∏–ø—Ç–µ, –ø—Ä–µ UpdateCoins
#ifdef ENABLE_POCX
for (const auto& tx : block.vtx) {
    for (const CTxOut& output : tx.vout) {
        if (IsAssignmentOpReturn(output)) {
            // –ü–∞—Ä—Å–∏—Ä–∞—ò OP_RETURN –ø–æ–¥–∞—Ç–∫–µ
            auto [plot_addr, forge_addr] = ParseAssignmentOpReturn(output);

            // –í–µ—Ä–∏—Ñ–∏–∫—É—ò –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ (tx –º–æ—Ä–∞ –±–∏—Ç–∏ –ø–æ—Ç–ø–∏—Å–∞–Ω –æ–¥ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞)
            if (!VerifyPlotOwnership(tx, plot_addr, view))
                return state.Invalid("bad-assignment-ownership");

            // –ü—Ä–æ–≤–µ—Ä–∏ —Å—Ç–∞—ö–µ –ø–ª–æ—Ç–∞ (–º–æ—Ä–∞ –±–∏—Ç–∏ UNASSIGNED –∏–ª–∏ REVOKED)
            ForgingState state = GetPlotForgingState(plot_addr, height, view);
            if (state != UNASSIGNED && state != REVOKED)
                return state.Invalid("plot-not-available-for-assignment");

            // –ö—Ä–µ–∏—Ä–∞—ò –Ω–æ–≤–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ
            int activation_height = height + consensus.nForgingAssignmentDelay;
            ForgingAssignment assignment(plot_addr, forge_addr, tx.GetHash(),
                                       height, activation_height);

            view.AddForgingAssignment(assignment);

            // –°–∫–ª–∞–¥–∏—à—Ç–∏ –ø–æ–¥–∞—Ç–∫–µ –∑–∞ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö–µ
            blockundo.vforgingundo.emplace_back(UndoType::ADDED, assignment);
        }
        else if (IsRevocationOpReturn(output)) {
            // –ü–∞—Ä—Å–∏—Ä–∞—ò OP_RETURN –ø–æ–¥–∞—Ç–∫–µ
            auto plot_addr = ParseRevocationOpReturn(output);

            // –í–µ—Ä–∏—Ñ–∏–∫—É—ò –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ
            if (!VerifyPlotOwnership(tx, plot_addr, view))
                return state.Invalid("bad-revocation-ownership");

            // –î–æ–±–∞–≤–∏ —Ç—Ä–µ–Ω—É—Ç–Ω–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ
            auto existing = view.GetForgingAssignment(plot_addr, height);
            if (!existing || existing->revoked)
                return state.Invalid("no-assignment-to-revoke");

            // –°–∫–ª–∞–¥–∏—à—Ç–∏ —Å—Ç–∞—Ä–æ —Å—Ç–∞—ö–µ –∑–∞ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö–µ
            blockundo.vforgingundo.emplace_back(UndoType::REVOKED, *existing);

            // –û–∑–Ω–∞—á–∏ –∫–∞–æ –æ–ø–æ–∑–≤–∞–Ω–æ
            ForgingAssignment revoked = *existing;
            revoked.revoked = true;
            revoked.revocation_txid = tx.GetHash();
            revoked.revocation_height = height;
            revoked.revocation_effective_height = height + consensus.nForgingRevocationDelay;

            view.UpdateForgingAssignment(revoked);
        }
    }
}
#endif

// UpdateCoins –Ω–∞—Å—Ç–∞–≤—ô–∞ –Ω–æ—Ä–º–∞–ª–Ω–æ (–∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –ø—Ä–µ—Å–∫–∞—á–µ OP_RETURN –∏–∑–ª–∞–∑–µ)
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/validation.cpp:2775-2878`

### –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–∞

```cpp
bool VerifyPlotOwnership(const CTransaction& tx,
                        const std::array<uint8_t, 20>& plotAddress,
                        const CCoinsViewCache& view)
{
    // –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞ —ò–µ –±–∞—Ä–µ–º —ò–µ–¥–∞–Ω —É–ª–∞–∑ –ø–æ—Ç–ø–∏—Å–∞–Ω –æ–¥ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞
    for (const auto& input : tx.vin) {
        Coin coin = view.GetCoin(input.prevout);
        if (!coin) continue;

        // –ò–∑–≤—É—Ü–∏ –æ–¥—Ä–µ–¥–∏—à—Ç–µ
        CTxDestination dest;
        if (!ExtractDestination(coin.out.scriptPubKey, dest)) continue;

        // –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞ –ª–∏ —ò–µ P2WPKH –Ω–∞ –∞–¥—Ä–µ—Å—É –ø–ª–æ—Ç–∞
        if (auto* witness_addr = std::get_if<WitnessV0KeyHash>(&dest)) {
            if (std::equal(witness_addr->begin(), witness_addr->end(),
                          plotAddress.begin())) {
                // Bitcoin Core —ò–µ –≤–µ—õ –≤–∞–ª–∏–¥–∏—Ä–∞–æ –ø–æ—Ç–ø–∏—Å
                return true;
            }
        }
    }
    return false;
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/assignments/opcodes.cpp:217-256`

### –ö–∞—à—ö–µ—ö–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—ò–µ

–î–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∏ –æ–ø–æ–∑–∏–≤–∏ –∏–º–∞—ò—É –ø–æ–¥–µ—Å–∏–≤–∞ –∫–∞—à—ö–µ—ö–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—ò–µ –¥–∞ –±–∏ —Å–ø—Ä–µ—á–∏–ª–∏ –Ω–∞–ø–∞–¥–µ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–µ:

```cpp
// –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞ (–ø–æ–¥–µ—Å–∏–≤–∏ –ø–æ –º—Ä–µ–∂–∏)
// –ü—Ä–∏–º–µ—Ä: 30 –±–ª–æ–∫–æ–≤–∞ = ~1 —Å–∞—Ç —Å–∞ 2-–º–∏–Ω—É—Ç–Ω–∏–º –≤—Ä–µ–º–µ–Ω–æ–º –±–ª–æ–∫–∞
consensus.nForgingAssignmentDelay;   // –ö–∞—à—ö–µ—ö–µ –∞–∫—Ç–∏–≤–∞—Ü–∏—ò–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
consensus.nForgingRevocationDelay;   // –ö–∞—à—ö–µ—ö–µ –∞–∫—Ç–∏–≤–∞—Ü–∏—ò–µ –æ–ø–æ–∑–∏–≤–∞
```

**–ü—Ä–µ–ª–∞–∑–∏ —Å—Ç–∞—ö–∞:**
- –î–æ–¥–µ—ô–∏–≤–∞—ö–µ: `UNASSIGNED ‚Üí ASSIGNING (–∫–∞—à—ö–µ—ö–µ) ‚Üí ASSIGNED`
- –û–ø–æ–∑–∏–≤: `ASSIGNED ‚Üí REVOKING (–∫–∞—à—ö–µ—ö–µ) ‚Üí REVOKED`

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/consensus/params.h`, `src/kernel/chainparams.cpp`

## –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ mempool-–∞

–¢—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∏ –æ–ø–æ–∑–∏–≤–∞ —Å–µ –≤–∞–ª–∏–¥–∏—Ä–∞—ò—É –ø—Ä–∏ –ø—Ä–∏—Ö–≤–∞—Ç–∞—ö—É —É mempool –¥–∞ –±–∏ —Å–µ –æ–¥–±–∏–ª–µ –Ω–µ–≤–∞–∂–µ—õ–µ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ –ø—Ä–µ –º—Ä–µ–∂–Ω–æ–≥ —à–∏—Ä–µ—ö–∞.

### –ü—Ä–æ–≤–µ—Ä–µ –Ω–∞ –Ω–∏–≤–æ—É —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ (CheckTransaction)

–ò–∑–≤–µ–¥–µ–Ω–µ —É `src/consensus/tx_check.cpp` –±–µ–∑ –ø—Ä–∏—Å—Ç—É–ø–∞ —Å—Ç–∞—ö—É –ª–∞–Ω—Ü–∞:

1. **–ú–∞–∫—Å–∏–º—É–º —ò–µ–¥–∞–Ω POCX OP_RETURN:** –¢—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞ –Ω–µ –º–æ–∂–µ —Å–∞–¥—Ä–∂–∞—Ç–∏ –≤–∏—à–µ POCX/XCOP –º–∞—Ä–∫–µ—Ä–∞

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/consensus/tx_check.cpp:63-77`

### –ü—Ä–æ–≤–µ—Ä–µ –ø—Ä–∏—Ö–≤–∞—Ç–∞—ö–∞ —É mempool (PreChecks)

–ò–∑–≤–µ–¥–µ–Ω–µ —É `src/validation.cpp` —Å–∞ –ø–æ—Ç–ø—É–Ω–∏–º –ø—Ä–∏—Å—Ç—É–ø–æ–º —Å—Ç–∞—ö—É –ª–∞–Ω—Ü–∞ –∏ mempool-–∞:

#### –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞

1. **–í–ª–∞—Å–Ω–∏—à—Ç–≤–æ –Ω–∞–¥ –ø–ª–æ—Ç–æ–º:** –¢—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞ –º–æ—Ä–∞ –±–∏—Ç–∏ –ø–æ—Ç–ø–∏—Å–∞–Ω–∞ –æ–¥ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞
2. **–°—Ç–∞—ö–µ –ø–ª–æ—Ç–∞:** –ü–ª–æ—Ç –º–æ—Ä–∞ –±–∏—Ç–∏ UNASSIGNED (0) –∏–ª–∏ REVOKED (4)
3. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç–∏ —É mempool-—É:** –ù–µ–º–∞ –¥—Ä—É–≥–æ–≥ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∑–∞ –æ–≤–∞—ò –ø–ª–æ—Ç —É mempool-—É (–ø—Ä–≤–∏ –≤–∏—í–µ–Ω –ø–æ–±–µ—í—É—ò–µ)

#### –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –æ–ø–æ–∑–∏–≤–∞

1. **–í–ª–∞—Å–Ω–∏—à—Ç–≤–æ –Ω–∞–¥ –ø–ª–æ—Ç–æ–º:** –¢—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞ –º–æ—Ä–∞ –±–∏—Ç–∏ –ø–æ—Ç–ø–∏—Å–∞–Ω–∞ –æ–¥ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞
2. **–ê–∫—Ç–∏–≤–Ω–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ:** –ü–ª–æ—Ç –º–æ—Ä–∞ –±–∏—Ç–∏ —Å–∞–º–æ —É ASSIGNED (2) —Å—Ç–∞—ö—É
3. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç–∏ —É mempool-—É:** –ù–µ–º–∞ –¥—Ä—É–≥–æ–≥ –æ–ø–æ–∑–∏–≤–∞ –∑–∞ –æ–≤–∞—ò –ø–ª–æ—Ç —É mempool-—É

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/validation.cpp:898-993`

### –¢–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–µ

```
–ï–º–∏—Ç–æ–≤–∞—ö–µ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ
       ‚Üì
CheckTransaction() [tx_check.cpp]
  ‚úì –ú–∞–∫—Å–∏–º—É–º —ò–µ–¥–∞–Ω POCX OP_RETURN
       ‚Üì
MemPoolAccept::PreChecks() [validation.cpp]
  ‚úì –í–µ—Ä–∏—Ñ–∏–∫—É—ò –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ –Ω–∞–¥ –ø–ª–æ—Ç–æ–º
  ‚úì –ü—Ä–æ–≤–µ—Ä–∏ —Å—Ç–∞—ö–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
  ‚úì –ü—Ä–æ–≤–µ—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ —É mempool-—É
       ‚Üì
   –í–∞–∂–µ—õ–µ ‚Üí –ü—Ä–∏—Ö–≤–∞—Ç–∏ —É mempool
   –ù–µ–≤–∞–∂–µ—õ–µ ‚Üí –û–¥–±–∏—ò (–Ω–µ —à–∏—Ä–∏)
       ‚Üì
–†—É–¥–∞—Ä–µ—ö–µ –±–ª–æ–∫–∞
       ‚Üì
ConnectBlock() [validation.cpp]
  ‚úì –ü–æ–Ω–æ–≤–æ –≤–∞–ª–∏–¥–∏—Ä–∞—ò —Å–≤–µ –ø—Ä–æ–≤–µ—Ä–µ (–¥—É–±–∏–Ω—Å–∫–∞ –æ–¥–±—Ä–∞–Ω–∞)
  ‚úì –ü—Ä–∏–º–µ–Ω–∏ –ø—Ä–æ–º–µ–Ω–µ —Å—Ç–∞—ö–∞
  ‚úì –ó–∞–±–µ–ª–µ–∂–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–µ –∑–∞ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö–µ
```

### –î—É–±–∏–Ω—Å–∫–∞ –æ–¥–±—Ä–∞–Ω–∞

–°–≤–µ –ø—Ä–æ–≤–µ—Ä–µ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–µ mempool-–∞ —Å–µ –ø–æ–Ω–æ–≤–æ –∏–∑–≤—Ä—à–∞–≤–∞—ò—É —Ç–æ–∫–æ–º `ConnectBlock()` –∑–∞ –∑–∞—à—Ç–∏—Ç—É –æ–¥:
- –ù–∞–ø–∞–¥–∞ –∑–∞–æ–±–∏–ª–∞–∂–µ—ö–∞ mempool-–∞
- –ù–µ–≤–∞–∂–µ—õ–∏—Ö –±–ª–æ–∫–æ–≤–∞ –æ–¥ –∑–ª–æ–Ω–∞–º–µ—Ä–Ω–∏—Ö —Ä—É–¥–∞—Ä–∞
- –ì—Ä–∞–Ω–∏—á–Ω–∏—Ö —Å–ª—É—á–∞—ò–µ–≤–∞ —Ç–æ–∫–æ–º —Å—Ü–µ–Ω–∞—Ä–∏—ò–∞ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–µ

–í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –±–ª–æ–∫–∞ –æ—Å—Ç–∞—ò–µ –∞—É—Ç–æ—Ä–∏—Ç–∞—Ç–∏–≤–Ω–∞ –∑–∞ –∫–æ–Ω—Å–µ–Ω–∑—É—Å.

## –ê—Ç–æ–º—Å–∫–∞ –∞–∂—É—Ä–∏—Ä–∞—ö–∞ –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞

### –¢—Ä–æ—Å–ª–æ—ò–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   CCoinsViewCache (–º–µ–º–æ—Ä–∏—ò—Å–∫–∏ –∫–µ—à)      ‚îÇ  ‚Üê –ü—Ä–æ–º–µ–Ω–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –ø—Ä–∞—õ–µ–Ω–µ —É –º–µ–º–æ—Ä–∏—ò–∏
‚îÇ   - Coins: cacheCoins                   ‚îÇ
‚îÇ   - Assignments: pendingAssignments     ‚îÇ
‚îÇ   - –ü—Ä–∞—õ–µ—ö–µ –∏–∑–º–µ–Ω–∞: dirtyPlots          ‚îÇ
‚îÇ   - –ë—Ä–∏—Å–∞—ö–∞: deletedAssignments         ‚îÇ
‚îÇ   - –ü—Ä–∞—õ–µ—ö–µ –º–µ–º–æ—Ä–∏—ò–µ: cachedAssignmentsUsage ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì Flush()
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   CCoinsViewDB (—Å–ª–æ—ò –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞)     ‚îÇ  ‚Üê –à–µ–¥–∞–Ω –∞—Ç–æ–º—Å–∫–∏ –∑–∞–ø–∏—Å
‚îÇ   - BatchWrite(): UTXO + –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì WriteBatch()
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   LevelDB (–¥–∏—Å–∫–æ–≤–Ω–æ —Å–∫–ª–∞–¥–∏—à—Ç–µ—ö–µ)        ‚îÇ  ‚Üê ACID –≥–∞—Ä–∞–Ω—Ü–∏—ò–µ
‚îÇ   - –ê—Ç–æ–º—Å–∫–∞ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–æ—Ü–µ—Å –∏—Å–ø–∏—Ä–∞—ö–∞

–ö–∞–¥–∞ —Å–µ –ø–æ–∑–æ–≤–µ `view.Flush()` —Ç–æ–∫–æ–º –ø–æ–≤–µ–∑–∏–≤–∞—ö–∞ –±–ª–æ–∫–∞:

```cpp
bool CCoinsViewCache::Flush() {
    // 1. –£–ø–∏—à–∏ –ø—Ä–æ–º–µ–Ω–µ –º–æ–Ω–µ—Ç–∞ —É –±–∞–∑—É
    auto cursor = CoinsViewCacheCursor(/*...*/, /*will_erase=*/true);
    bool fOk = base->BatchWrite(cursor, hashBlock);

    // 2. –£–ø–∏—à–∏ –ø—Ä–æ–º–µ–Ω–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∞—Ç–æ–º—Å–∫–∏
    if (fOk && !dirtyPlots.empty()) {
        // –ü—Ä–∏–∫—É–ø–∏ –∏–∑–º–µ—ö–µ–Ω–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
        ForgingAssignmentsMap assignmentsToWrite;
        PlotAddressAssignmentMap currentToWrite;  // –ü—Ä–∞–∑–Ω–æ - –Ω–µ–∫–æ—Ä–∏—à—õ–µ–Ω–æ

        for (const auto& plotAddr : dirtyPlots) {
            auto it = pendingAssignments.find(plotAddr);
            if (it != pendingAssignments.end()) {
                for (const auto& assignment : it->second) {
                    assignmentsToWrite[{plotAddr, assignment}] = assignment;
                }
            }
        }

        // –£–ø–∏—à–∏ —É –±–∞–∑—É –ø–æ–¥–∞—Ç–∞–∫–∞
        fOk = base->BatchWriteAssignments(assignmentsToWrite, currentToWrite,
                                         deletedAssignments);

        if (fOk) {
            // –û—á–∏—Å—Ç–∏ –ø—Ä–∞—õ–µ—ö–µ
            dirtyPlots.clear();
            deletedAssignments.clear();
        }
    }

    if (fOk) {
        cacheCoins.clear();  // –û—Å–ª–æ–±–æ–¥–∏ –º–µ–º–æ—Ä–∏—ò—É
        pendingAssignments.clear();
        cachedAssignmentsUsage = 0;
    }

    return fOk;
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/coins.cpp:278-315`

### –ì—Ä—É–ø–Ω–∏ –∑–∞–ø–∏—Å –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞

```cpp
bool CCoinsViewDB::BatchWrite(CoinsViewCacheCursor& cursor, const uint256& hashBlock) {
    CDBBatch batch(*m_db);  // –à–µ–¥–Ω–∞ LevelDB –≥—Ä—É–ø–∞

    // 1. –û–∑–Ω–∞—á–∏ –ø—Ä–µ–ª–∞–∑–Ω–æ —Å—Ç–∞—ö–µ
    batch.Write(DB_HEAD_BLOCKS, Vector(hashBlock, old_tip));

    // 2. –£–ø–∏—à–∏ —Å–≤–µ –ø—Ä–æ–º–µ–Ω–µ –º–æ–Ω–µ—Ç–∞
    for (auto it = cursor.Begin(); it != cursor.End(); it = cursor.NextAndMaybeErase(*it)) {
        if (it->second.coin.IsSpent())
            batch.Erase(CoinKey(it->first));
        else
            batch.Write(CoinKey(it->first), it->second.coin);
    }

    // 3. –û–∑–Ω–∞—á–∏ –∫–æ–Ω–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ —Å—Ç–∞—ö–µ
    batch.Write(DB_BEST_BLOCK, hashBlock);

    // 4. –ê–¢–û–ú–°–ö–ò –ö–û–ú–ò–¢
    bool ret = m_db->WriteBatch(batch);

    return ret;
}

// –î–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Å–µ —É–ø–∏—Å—É—ò—É –æ–¥–≤–æ—ò–µ–Ω–æ –∞–ª–∏ —É –∏—Å—Ç–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç—É —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞
bool CCoinsViewDB::BatchWriteAssignments(
    const ForgingAssignmentsMap& assignments,
    const PlotAddressAssignmentMap& currentAssignments,  // –ù–µ–∫–æ—Ä–∏—à—õ–µ–Ω –ø–∞—Ä–∞–º–µ—Ç–∞—Ä (–∑–∞–¥—Ä–∂–∞–Ω –∑–∞ API –∫–æ–º–ø–∞—Ç–∏–±–∏–ª–Ω–æ—Å—Ç)
    const DeletedAssignmentsSet& deletedAssignments)
{
    CDBBatch batch(*m_db);  // –ù–æ–≤–∞ –≥—Ä—É–ø–∞, –∞–ª–∏ –∏—Å—Ç–∞ –±–∞–∑–∞ –ø–æ–¥–∞—Ç–∞–∫–∞

    // –£–ø–∏—à–∏ –∏—Å—Ç–æ—Ä–∏—ò—É –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
    for (const auto& [key, assignment] : assignments) {
        const auto& [plot_addr, txid] = key;
        batch.Write(AssignmentHistoryKey(plot_addr, txid), assignment);
    }

    // –û–±—Ä–∏—à–∏ –∏–∑–±—Ä–∏—Å–∞–Ω–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∏–∑ –∏—Å—Ç–æ—Ä–∏—ò–µ
    for (const auto& [plot_addr, txid] : deletedAssignments) {
        batch.Erase(AssignmentHistoryKey(plot_addr, txid));
    }

    // –ê–¢–û–ú–°–ö–ò –ö–û–ú–ò–¢
    return m_db->WriteBatch(batch);
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/txdb.cpp:332-348`

### –ì–∞—Ä–∞–Ω—Ü–∏—ò–µ –∞—Ç–æ–º–∏—á–Ω–æ—Å—Ç–∏

‚úÖ **–®—Ç–∞ —ò–µ –∞—Ç–æ–º—Å–∫–æ:**
- –°–≤–µ –ø—Ä–æ–º–µ–Ω–µ –º–æ–Ω–µ—Ç–∞ —É–Ω—É—Ç–∞—Ä –±–ª–æ–∫–∞ —Å–µ —É–ø–∏—Å—É—ò—É –∞—Ç–æ–º—Å–∫–∏
- –°–≤–µ –ø—Ä–æ–º–µ–Ω–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ —É–Ω—É—Ç–∞—Ä –±–ª–æ–∫–∞ —Å–µ —É–ø–∏—Å—É—ò—É –∞—Ç–æ–º—Å–∫–∏
- –ë–∞–∑–∞ –ø–æ–¥–∞—Ç–∞–∫–∞ –æ—Å—Ç–∞—ò–µ –∫–æ–Ω–∑–∏—Å—Ç–µ–Ω—Ç–Ω–∞ –ø—Ä–µ–∫–æ –ø–∞–¥–æ–≤–∞

‚ö†Ô∏è **–¢—Ä–µ–Ω—É—Ç–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ—ö–µ:**
- –ú–æ–Ω–µ—Ç–µ –∏ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Å–µ —É–ø–∏—Å—É—ò—É —É **–æ–¥–≤–æ—ò–µ–Ω–∏–º** LevelDB –≥—Ä—É–ø–Ω–∏–º –æ–ø–µ—Ä–∞—Ü–∏—ò–∞–º–∞
- –û–±–µ –æ–ø–µ—Ä–∞—Ü–∏—ò–µ —Å–µ –¥–µ—à–∞–≤–∞—ò—É —Ç–æ–∫–æ–º `view.Flush()`, –∞–ª–∏ –Ω–µ —É —ò–µ–¥–Ω–æ–º –∞—Ç–æ–º—Å–∫–æ–º –∑–∞–ø–∏—Å—É
- –£ –ø—Ä–∞–∫—Å–∏: –û–±–µ –≥—Ä—É–ø–µ —Å–µ –∑–∞–≤—Ä—à–∞–≤–∞—ò—É –±—Ä–∑–æ –ø—Ä–µ fsync –¥–∏—Å–∫–∞
- –†–∏–∑–∏–∫ —ò–µ –º–∏–Ω–∏–º–∞–ª–∞–Ω: –û–±–µ –±–∏ —Ç—Ä–µ–±–∞–ª–æ –ø–æ–Ω–æ–≤–æ –ø–æ–∫—Ä–µ–Ω—É—Ç–∏ –∏–∑ –∏—Å—Ç–æ–≥ –±–ª–æ–∫–∞ —Ç–æ–∫–æ–º –æ–ø–æ—Ä–∞–≤–∫–∞ –æ–¥ –ø–∞–¥–∞

**–ù–∞–ø–æ–º–µ–Ω–∞:** –û–≤–æ —Å–µ —Ä–∞–∑–ª–∏–∫—É—ò–µ –æ–¥ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–æ–≥ –ø–ª–∞–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –∫–æ—ò–∏ —ò–µ –∑–∞—Ö—Ç–µ–≤–∞–æ —ò–µ–¥–Ω—É —É–Ω–∏—Ñ–∏–∫–æ–≤–∞–Ω—É –≥—Ä—É–ø—É. –¢—Ä–µ–Ω—É—Ç–Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞ –∫–æ—Ä–∏—Å—Ç–∏ –¥–≤–µ –≥—Ä—É–ø–µ –∞–ª–∏ –æ–¥—Ä–∂–∞–≤–∞ –∫–æ–Ω–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç –∫—Ä–æ–∑ –ø–æ—Å—Ç–æ—ò–µ—õ–µ Bitcoin Core –º–µ—Ö–∞–Ω–∏–∑–º–µ –æ–ø–æ—Ä–∞–≤–∫–∞ –æ–¥ –ø–∞–¥–∞ (DB_HEAD_BLOCKS –º–∞—Ä–∫–µ—Ä).

## –†—É–∫–æ–≤–∞—ö–µ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–æ–º

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–¥–∞—Ç–∞–∫–∞ –∑–∞ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö–µ

```cpp
struct ForgingUndo {
    enum class UndoType : uint8_t {
        ADDED = 0,      // –î–æ–¥–µ—ô–∏–≤–∞—ö–µ —ò–µ –¥–æ–¥–∞—Ç–æ (–æ–±—Ä–∏—à–∏ –ø—Ä–∏ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö—É)
        MODIFIED = 1,   // –î–æ–¥–µ—ô–∏–≤–∞—ö–µ —ò–µ –º–æ–¥–∏—Ñ–∏–∫–æ–≤–∞–Ω–æ (–≤—Ä–∞—Ç–∏ –ø—Ä–∏ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö—É)
        REVOKED = 2     // –î–æ–¥–µ—ô–∏–≤–∞—ö–µ —ò–µ –æ–ø–æ–∑–≤–∞–Ω–æ (–ø–æ–Ω–∏—à—Ç–∏ –æ–ø–æ–∑–∏–≤ –ø—Ä–∏ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö—É)
    };

    UndoType type;
    ForgingAssignment assignment;  // –ü—É–Ω–æ —Å—Ç–∞—ö–µ –ø—Ä–µ –ø—Ä–æ–º–µ–Ω–µ
};

struct CBlockUndo {
    std::vector<CTxUndo> vtxundo;           // UTXO –ø–æ–¥–∞—Ü–∏ –∑–∞ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö–µ
    std::vector<ForgingUndo> vforgingundo;  // –ü–æ–¥–∞—Ü–∏ –∑–∞ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
};
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/undo.h:63-105`

### –ü—Ä–æ—Ü–µ—Å DisconnectBlock

–ö–∞–¥–∞ —Å–µ –±–ª–æ–∫ –∏—Å–∫—ô—É—á—É—ò–µ —Ç–æ–∫–æ–º —Ä–µ–æ—Ä–≥–∞:

```cpp
DisconnectResult Chainstate::DisconnectBlock(const CBlock& block,
                                              const CBlockIndex* pindex,
                                              CCoinsViewCache& view)
{
    // ... —Å—Ç–∞–Ω–¥–∞—Ä–¥–Ω–æ –∏—Å–∫—ô—É—á–∏–≤–∞—ö–µ UTXO ...

    // –ü—Ä–æ—á–∏—Ç–∞—ò –ø–æ–¥–∞—Ç–∫–µ –∑–∞ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö–µ —Å–∞ –¥–∏—Å–∫–∞
    CBlockUndo blockUndo;
    if (!ReadBlockUndo(blockUndo, *pindex))
        return DISCONNECT_FAILED;

    #ifdef ENABLE_POCX
    // –ü–æ–Ω–∏—à—Ç–∏ –ø—Ä–æ–º–µ–Ω–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ (–æ–±—Ä–∞–¥–∏ –æ–±—Ä–Ω—É—Ç–∏–º —Ä–µ–¥–æ—Å–ª–µ–¥–æ–º)
    for (auto it = blockUndo.vforgingundo.rbegin();
         it != blockUndo.vforgingundo.rend(); ++it) {

        switch (it->type) {
            case UndoType::ADDED:
                // –î–æ–¥–µ—ô–∏–≤–∞—ö–µ —ò–µ –¥–æ–¥–∞—Ç–æ - —É–∫–ª–æ–Ω–∏ –≥–∞
                view.RemoveForgingAssignment(
                    it->assignment.plotAddress,
                    it->assignment.assignment_txid
                );
                break;

            case UndoType::REVOKED:
                // –î–æ–¥–µ—ô–∏–≤–∞—ö–µ —ò–µ –æ–ø–æ–∑–≤–∞–Ω–æ - –≤—Ä–∞—Ç–∏ –Ω–µ–æ–ø–æ–∑–≤–∞–Ω–æ —Å—Ç–∞—ö–µ
                view.RestoreForgingAssignment(it->assignment);
                break;

            case UndoType::MODIFIED:
                // –î–æ–¥–µ—ô–∏–≤–∞—ö–µ —ò–µ –º–æ–¥–∏—Ñ–∏–∫–æ–≤–∞–Ω–æ - –≤—Ä–∞—Ç–∏ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ —Å—Ç–∞—ö–µ
                view.UpdateForgingAssignment(it->assignment);
                break;
        }
    }
    #endif

    return DISCONNECT_OK;
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/validation.cpp:2381-2415`

### –£–ø—Ä–∞–≤—ô–∞—ö–µ –∫–µ—à–æ–º —Ç–æ–∫–æ–º —Ä–µ–æ—Ä–≥–∞

```cpp
class CCoinsViewCache {
private:
    // –ö–µ—à–µ–≤–∏ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
    mutable std::map<std::array<uint8_t, 20>, std::vector<ForgingAssignment>> pendingAssignments;
    mutable std::set<std::array<uint8_t, 20>> dirtyPlots;  // –ü—Ä–∞—Ç–∏ –º–æ–¥–∏—Ñ–∏–∫–æ–≤–∞–Ω–µ –ø–ª–æ—Ç–æ–≤–µ
    mutable std::set<std::pair<std::array<uint8_t, 20>, uint256>> deletedAssignments;  // –ü—Ä–∞—Ç–∏ –±—Ä–∏—Å–∞—ö–∞
    mutable size_t cachedAssignmentsUsage{0};  // –ü—Ä–∞—õ–µ—ö–µ –º–µ–º–æ—Ä–∏—ò–µ

public:
    void AddForgingAssignment(const ForgingAssignment& assignment) {
        pendingAssignments[assignment.plotAddress].push_back(assignment);
        dirtyPlots.insert(assignment.plotAddress);
        cachedAssignmentsUsage += sizeof(ForgingAssignment);
    }

    void RemoveForgingAssignment(const std::array<uint8_t, 20>& plotAddress,
                                 const uint256& assignment_txid) {
        auto key = std::make_pair(plotAddress, assignment_txid);
        deletedAssignments.insert(key);
        dirtyPlots.insert(plotAddress);
        if (cachedAssignmentsUsage >= sizeof(ForgingAssignment)) {
            cachedAssignmentsUsage -= sizeof(ForgingAssignment);
        }
    }

    void RestoreForgingAssignment(const ForgingAssignment& assignment) {
        pendingAssignments[assignment.plotAddress].push_back(assignment);
        dirtyPlots.insert(assignment.plotAddress);
        auto key = std::make_pair(assignment.plotAddress, assignment.assignment_txid);
        deletedAssignments.erase(key);
        if (true) {
            cachedAssignmentsUsage += sizeof(ForgingAssignment);
        }
    }
};
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/coins.cpp:494-565`

## RPC –∏–Ω—Ç–µ—Ä—Ñ–µ—ò—Å

### –ö–æ–º–∞–Ω–¥–µ —á–≤–æ—Ä–∞ (–Ω–∏—ò–µ –ø–æ—Ç—Ä–µ–±–∞–Ω –Ω–æ–≤—á–∞–Ω–∏–∫)

#### get_assignment
```bash
bitcoin-cli get_assignment "pocx1qplot..."
```

–í—Ä–∞—õ–∞ —Ç—Ä–µ–Ω—É—Ç–Ω–∏ —Å—Ç–∞—Ç—É—Å –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∑–∞ –∞–¥—Ä–µ—Å—É –ø–ª–æ—Ç–∞:
```json
{
  "plot_address": "pocx1qplot...",
  "has_assignment": true,
  "state": "ASSIGNED",
  "forging_address": "pocx1qforger...",
  "assignment_txid": "abc123...",
  "assignment_height": 100,
  "activation_height": 244,
  "revoked": false
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/rpc/assignments.cpp:31-126`

### –ö–æ–º–∞–Ω–¥–µ –Ω–æ–≤—á–∞–Ω–∏–∫–∞ (–ø–æ—Ç—Ä–µ–±–∞–Ω –Ω–æ–≤—á–∞–Ω–∏–∫)

#### create_assignment
```bash
bitcoin-cli create_assignment "pocx1qplot..." "pocx1qforger..."
```

–ö—Ä–µ–∏—Ä–∞ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò—É –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞:
- –ê—É—Ç–æ–º–∞—Ç—Å–∫–∏ –±–∏—Ä–∞ –Ω–∞—ò–≤–µ—õ–∏ UTXO –æ–¥ –∞–¥—Ä–µ—Å–µ –ø–ª–æ—Ç–∞ –¥–∞ –¥–æ–∫–∞–∂–µ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ
- –ì—Ä–∞–¥–∏ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò—É —Å–∞ OP_RETURN + –∏–∑–ª–∞–∑–æ–º –∑–∞ –∫—É—Å—É—Ä
- –ü–æ—Ç–ø–∏—Å—É—ò–µ –∫—ô—É—á–µ–º –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞
- –ï–º–∏—Ç—É—ò–µ –Ω–∞ –º—Ä–µ–∂—É

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/rpc/assignments_wallet.cpp:29-93`

#### revoke_assignment
```bash
bitcoin-cli revoke_assignment "pocx1qplot..."
```

–ö—Ä–µ–∏—Ä–∞ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò—É –æ–ø–æ–∑–∏–≤–∞:
- –ê—É—Ç–æ–º–∞—Ç—Å–∫–∏ –±–∏—Ä–∞ –Ω–∞—ò–≤–µ—õ–∏ UTXO –æ–¥ –∞–¥—Ä–µ—Å–µ –ø–ª–æ—Ç–∞ –¥–∞ –¥–æ–∫–∞–∂–µ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ
- –ì—Ä–∞–¥–∏ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò—É —Å–∞ OP_RETURN + –∏–∑–ª–∞–∑–æ–º –∑–∞ –∫—É—Å—É—Ä
- –ü–æ—Ç–ø–∏—Å—É—ò–µ –∫—ô—É—á–µ–º –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞
- –ï–º–∏—Ç—É—ò–µ –Ω–∞ –º—Ä–µ–∂—É

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/rpc/assignments_wallet.cpp:95-154`

### –ö—Ä–µ–∏—Ä–∞—ö–µ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ –Ω–æ–≤—á–∞–Ω–∏–∫–∞

–ü—Ä–æ—Ü–µ—Å –∫—Ä–µ–∏—Ä–∞—ö–∞ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ –Ω–æ–≤—á–∞–Ω–∏–∫–∞:

```cpp
1. –ü–∞—Ä—Å–∏—Ä–∞—ò –∏ –≤–∞–ª–∏–¥–∏—Ä–∞—ò –∞–¥—Ä–µ—Å–µ (–º–æ—Ä–∞—ò—É –±–∏—Ç–∏ P2WPKH bech32)
2. –ü—Ä–æ–Ω–∞—í–∏ –Ω–∞—ò–≤–µ—õ–∏ UTXO –æ–¥ –∞–¥—Ä–µ—Å–µ –ø–ª–æ—Ç–∞ (–¥–æ–∫–∞–∑—É—ò–µ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ)
3. –ö—Ä–µ–∏—Ä–∞—ò –ø—Ä–∏–≤—Ä–µ–º–µ–Ω—É —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò—É —Å–∞ dummy –∏–∑–ª–∞–∑–æ–º
4. –ü–æ—Ç–ø–∏—à–∏ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò—É (–¥–æ–±–∏—ò —Ç–∞—á–Ω—É –≤–µ–ª–∏—á–∏–Ω—É —Å–∞ witness –ø–æ–¥–∞—Ü–∏–º–∞)
5. –ó–∞–º–µ–Ω–∏ dummy –∏–∑–ª–∞–∑ —Å–∞ OP_RETURN
6. –ü–æ–¥–µ—Å–∏ –Ω–∞–∫–Ω–∞–¥–µ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤—É –ø—Ä–æ–º–µ–Ω–µ –≤–µ–ª–∏—á–∏–Ω–µ
7. –ü–æ–Ω–æ–≤–æ –ø–æ—Ç–ø–∏—à–∏ —Ñ–∏–Ω–∞–ª–Ω—É —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò—É
8. –ï–º–∏—Ç—É—ò –Ω–∞ –º—Ä–µ–∂—É
```

**–ö—ô—É—á–Ω–∏ —É–≤–∏–¥:** –ù–æ–≤—á–∞–Ω–∏–∫ –º–æ—Ä–∞ –ø–æ—Ç—Ä–æ—à–∏—Ç–∏ –æ–¥ –∞–¥—Ä–µ—Å–µ –ø–ª–æ—Ç–∞ –¥–∞ –¥–æ–∫–∞–∂–µ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ, —Ç–∞–∫–æ –¥–∞ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ —Ñ–æ—Ä—Å–∏—Ä–∞ —Å–µ–ª–µ–∫—Ü–∏—ò—É –º–æ–Ω–µ—Ç–∞ –æ–¥ —Ç–µ –∞–¥—Ä–µ—Å–µ.

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/assignments/transactions.cpp:38-263`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞—Ç–æ—Ç–µ–∫–∞

### –û—Å–Ω–æ–≤–Ω–µ –¥–∞—Ç–æ—Ç–µ–∫–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–µ

```
src/
‚îú‚îÄ‚îÄ coins.h                        # ForgingAssignment —Å—Ç—Ä—É–∫—Ç—É—Ä–∞, CCoinsViewCache –º–µ—Ç–æ–¥–µ [710 –ª–∏–Ω–∏—ò–∞]
‚îú‚îÄ‚îÄ coins.cpp                      # –£–ø—Ä–∞–≤—ô–∞—ö–µ –∫–µ—à–æ–º, –≥—Ä—É–ø–Ω–∏ –∑–∞–ø–∏—Å–∏ [603 –ª–∏–Ω–∏—ò–µ]
‚îÇ
‚îú‚îÄ‚îÄ txdb.h                         # CCoinsViewDB –º–µ—Ç–æ–¥–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ [90 –ª–∏–Ω–∏—ò–∞]
‚îú‚îÄ‚îÄ txdb.cpp                       # –ß–∏—Ç–∞—ö–µ/–ø–∏—Å–∞—ö–µ –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞ [349 –ª–∏–Ω–∏—ò–∞]
‚îÇ
‚îú‚îÄ‚îÄ undo.h                         # ForgingUndo —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞ —Ä–µ–æ—Ä–≥–µ
‚îÇ
‚îú‚îÄ‚îÄ validation.cpp                 # ConnectBlock/DisconnectBlock –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—ò–∞
‚îÇ
‚îî‚îÄ‚îÄ pocx/
    ‚îú‚îÄ‚îÄ assignments/
    ‚îÇ   ‚îú‚îÄ‚îÄ opcodes.h              # OP_RETURN —Ñ–æ—Ä–º–∞—Ç, –ø–∞—Ä—Å–∏—Ä–∞—ö–µ, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞
    ‚îÇ   ‚îú‚îÄ‚îÄ opcodes.cpp            # [259 –ª–∏–Ω–∏—ò–∞] –î–µ—Ñ–∏–Ω–∏—Ü–∏—ò–µ –º–∞—Ä–∫–µ—Ä–∞, OP_RETURN –æ–ø–µ—Ä–∞—Ü–∏—ò–µ, –ø—Ä–æ–≤–µ—Ä–∞ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–∞
    ‚îÇ   ‚îú‚îÄ‚îÄ assignment_state.h     # GetEffectiveSigner, GetAssignmentState –ø–æ–º–æ—õ–Ω–∏—Ü–∏
    ‚îÇ   ‚îú‚îÄ‚îÄ assignment_state.cpp   # –§—É–Ω–∫—Ü–∏—ò–µ —É–ø–∏—Ç–∞ —Å—Ç–∞—ö–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
    ‚îÇ   ‚îú‚îÄ‚îÄ transactions.h         # API –∑–∞ –∫—Ä–µ–∏—Ä–∞—ö–µ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞ –Ω–æ–≤—á–∞–Ω–∏–∫–∞
    ‚îÇ   ‚îî‚îÄ‚îÄ transactions.cpp       # create_assignment, revoke_assignment —Ñ—É–Ω–∫—Ü–∏—ò–µ –Ω–æ–≤—á–∞–Ω–∏–∫–∞
    ‚îÇ
    ‚îú‚îÄ‚îÄ rpc/
    ‚îÇ   ‚îú‚îÄ‚îÄ assignments.h          # RPC –∫–æ–º–∞–Ω–¥–µ —á–≤–æ—Ä–∞ (–±–µ–∑ –Ω–æ–≤—á–∞–Ω–∏–∫–∞)
    ‚îÇ   ‚îú‚îÄ‚îÄ assignments.cpp        # get_assignment, list_assignments RPC-–æ–≤–∏
    ‚îÇ   ‚îú‚îÄ‚îÄ assignments_wallet.h   # RPC –∫–æ–º–∞–Ω–¥–µ –Ω–æ–≤—á–∞–Ω–∏–∫–∞
    ‚îÇ   ‚îî‚îÄ‚îÄ assignments_wallet.cpp # create_assignment, revoke_assignment RPC-–æ–≤–∏
    ‚îÇ
    ‚îî‚îÄ‚îÄ consensus/
        ‚îî‚îÄ‚îÄ params.h               # nForgingAssignmentDelay, nForgingRevocationDelay
```

## –ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–µ –ø–µ—Ä—Ñ–æ—Ä–º–∞–Ω—Å–∏

### –û–ø–µ—Ä–∞—Ü–∏—ò–µ –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞

- **–î–æ–±–∞–≤–∏ —Ç—Ä–µ–Ω—É—Ç–Ω–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ:** O(n) - —Å–∫–µ–Ω–∏—Ä–∞—ò —Å–≤–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∑–∞ –∞–¥—Ä–µ—Å—É –ø–ª–æ—Ç–∞ –¥–∞ –ø—Ä–æ–Ω–∞—í–µ—à –Ω–∞—ò–Ω–æ–≤–∏—ò–µ
- **–î–æ–±–∞–≤–∏ –∏—Å—Ç–æ—Ä–∏—ò—É –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞:** O(n) - –∏—Ç–µ—Ä–∏—Ä–∞—ò —Å–≤–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∑–∞ –ø–ª–æ—Ç
- **–ö—Ä–µ–∏—Ä–∞—ò –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ:** O(1) - —ò–µ–¥–∞–Ω —É–Ω–æ—Å
- **–û–ø–æ–∑–æ–≤–∏ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ:** O(1) - —ò–µ–¥–Ω–æ –∞–∂—É—Ä–∏—Ä–∞—ö–µ
- **–†–µ–æ—Ä–≥ (–ø–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö—É):** O(1) - –¥–∏—Ä–µ–∫—Ç–Ω–∞ –ø—Ä–∏–º–µ–Ω–∞ –ø–æ–¥–∞—Ç–∞–∫–∞ –∑–∞ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö–µ

–ì–¥–µ —ò–µ n = –±—Ä–æ—ò –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∑–∞ –ø–ª–æ—Ç (—Ç–∏–ø–∏—á–Ω–æ –º–∞–ª–∏, < 10)

### –£–ø–æ—Ç—Ä–µ–±–∞ –º–µ–º–æ—Ä–∏—ò–µ

- **–ü–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö—É:** ~160 –±–∞—ò—Ç–æ–≤–∞ (ForgingAssignment —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
- **Overhead –∫–µ—à–∞:** Overhead —Ö–µ—à –º–∞–ø–µ –∑–∞ –ø—Ä–∞—õ–µ—ö–µ –∏–∑–º–µ–Ω–∞
- **–¢–∏–ø–∏—á–∞–Ω –±–ª–æ–∫:** <10 –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ = <2 KB –º–µ–º–æ—Ä–∏—ò–µ

### –£–ø–æ—Ç—Ä–µ–±–∞ –¥–∏—Å–∫–∞

- **–ü–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö—É:** ~200 –±–∞—ò—Ç–æ–≤–∞ –Ω–∞ –¥–∏—Å–∫—É (—Å–∞ LevelDB overhead-–æ–º)
- **10000 –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞:** ~2 MB –ø—Ä–æ—Å—Ç–æ—Ä–∞ –Ω–∞ –¥–∏—Å–∫—É
- **–ó–∞–Ω–µ–º–∞—Ä—ô–∏–≤–æ —É –ø–æ—Ä–µ—í–µ—ö—É —Å–∞ UTXO —Å–∫—É–ø–æ–º:** <0.001% —Ç–∏–ø–∏—á–Ω–æ–≥ chainstate-–∞

## –¢—Ä–µ–Ω—É—Ç–Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ—ö–∞ –∏ –±—É–¥—É—õ–∏ —Ä–∞–¥

### –û–≥—Ä–∞–Ω–∏—á–µ—ö–µ –∞—Ç–æ–º–∏—á–Ω–æ—Å—Ç–∏

**–¢—Ä–µ–Ω—É—Ç–Ω–æ:** –ú–æ–Ω–µ—Ç–µ –∏ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Å–µ —É–ø–∏—Å—É—ò—É —É –æ–¥–≤–æ—ò–µ–Ω–∏–º LevelDB –≥—Ä—É–ø–∞–º–∞ —Ç–æ–∫–æ–º `view.Flush()`

**–£—Ç–∏—Ü–∞—ò:** –¢–µ–æ—Ä–∏—ò—Å–∫–∏ —Ä–∏–∑–∏–∫ –Ω–µ–∫–æ–Ω–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –∞–∫–æ –¥–æ—í–µ –¥–æ –ø–∞–¥–∞ –∏–∑–º–µ—í—É –≥—Ä—É–ø–∞

**–£–±–ª–∞–∂–µ—ö–µ:**
- –û–±–µ –≥—Ä—É–ø–µ —Å–µ –∑–∞–≤—Ä—à–∞–≤–∞—ò—É –±—Ä–∑–æ –ø—Ä–µ fsync
- Bitcoin Core –æ–ø–æ—Ä–∞–≤–∞–∫ –æ–¥ –ø–∞–¥–∞ –∫–æ—Ä–∏—Å—Ç–∏ DB_HEAD_BLOCKS –º–∞—Ä–∫–µ—Ä
- –£ –ø—Ä–∞–∫—Å–∏: –ù–∏–∫–∞–¥–∞ –ø—Ä–∏–º–µ—õ–µ–Ω–æ —Ç–æ–∫–æ–º —Ç–µ—Å—Ç–∏—Ä–∞—ö–∞

**–ë—É–¥—É—õ–µ –ø–æ–±–æ—ô—à–∞—ö–µ:** –£—ò–µ–¥–∏–Ω–∏ —É —ò–µ–¥–Ω—É LevelDB –≥—Ä—É–ø–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—ò—É

### –ß–∏—à—õ–µ—ö–µ –∏—Å—Ç–æ—Ä–∏—ò–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞

**–¢—Ä–µ–Ω—É—Ç–Ω–æ:** –°–≤–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Ç—Ä–∞—ò–Ω–æ —Å–∫–ª–∞–¥–∏—à—Ç–µ–Ω–∞

**–£—Ç–∏—Ü–∞—ò:** ~200 –±–∞—ò—Ç–æ–≤–∞ –ø–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö—É –∑–∞—É–≤–µ–∫

**–ë—É–¥—É—õ–µ:** –û–ø—Ü–∏–æ–Ω–æ —á–∏—à—õ–µ—ö–µ –ø–æ—Ç–ø—É–Ω–æ –æ–ø–æ–∑–≤–∞–Ω–∏—Ö –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Å—Ç–∞—Ä–∏—ò–∏—Ö –æ–¥ N –±–ª–æ–∫–æ–≤–∞

**–ù–∞–ø–æ–º–µ–Ω–∞:** –ú–∞–ª–æ –≤–µ—Ä–æ–≤–∞—Ç–Ω–æ –¥–∞ —õ–µ –±–∏—Ç–∏ –ø–æ—Ç—Ä–µ–±–Ω–æ - —á–∞–∫ –∏ 1 –º–∏–ª–∏–æ–Ω –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ = 200 MB

## –°—Ç–∞—Ç—É—Å —Ç–µ—Å—Ç–∏—Ä–∞—ö–∞

### –ò–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–∏ —Ç–µ—Å—Ç–æ–≤–∏

‚úÖ OP_RETURN –ø–∞—Ä—Å–∏—Ä–∞—ö–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞
‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–∞
‚úÖ ConnectBlock –∫—Ä–µ–∏—Ä–∞—ö–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
‚úÖ ConnectBlock –æ–ø–æ–∑–∏–≤
‚úÖ DisconnectBlock —Ä—É–∫–æ–≤–∞—ö–µ —Ä–µ–æ—Ä–≥–æ–º
‚úÖ –û–ø–µ—Ä–∞—Ü–∏—ò–µ —á–∏—Ç–∞—ö–∞/–ø–∏—Å–∞—ö–∞ –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞
‚úÖ –ü—Ä–µ–ª–∞–∑–∏ —Å—Ç–∞—ö–∞ (UNASSIGNED ‚Üí ASSIGNING ‚Üí ASSIGNED ‚Üí REVOKING ‚Üí REVOKED)
‚úÖ RPC –∫–æ–º–∞–Ω–¥–µ (get_assignment, create_assignment, revoke_assignment)
‚úÖ –ö—Ä–µ–∏—Ä–∞—ö–µ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞ –Ω–æ–≤—á–∞–Ω–∏–∫–∞

### –û–±–ª–∞—Å—Ç–∏ –ø–æ–∫—Ä–∏–≤–µ–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–æ–≤–∞

- –à–µ–¥–∏–Ω–∏—á–Ω–∏ —Ç–µ—Å—Ç–æ–≤–∏: `src/test/pocx_*_tests.cpp`
- –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–∏ —Ç–µ—Å—Ç–æ–≤–∏: `test/functional/feature_pocx_*.py`
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–∏ —Ç–µ—Å—Ç–æ–≤–∏: –†—É—á–Ω–æ —Ç–µ—Å—Ç–∏—Ä–∞—ö–µ —Å–∞ regtest

## –ü—Ä–∞–≤–∏–ª–∞ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞

### –ü—Ä–∞–≤–∏–ª–∞ –∫—Ä–µ–∏—Ä–∞—ö–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞

1. **–í–ª–∞—Å–Ω–∏—à—Ç–≤–æ:** –¢—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞ –º–æ—Ä–∞ –±–∏—Ç–∏ –ø–æ—Ç–ø–∏—Å–∞–Ω–∞ –æ–¥ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞
2. **–°—Ç–∞—ö–µ:** –ü–ª–æ—Ç –º–æ—Ä–∞ –±–∏—Ç–∏ —É UNASSIGNED –∏–ª–∏ REVOKED —Å—Ç–∞—ö—É
3. **–§–æ—Ä–º–∞—Ç:** –í–∞–∂–µ—õ–∏ OP_RETURN —Å–∞ POCX –º–∞—Ä–∫–µ—Ä–æ–º + 2x 20-–±–∞—ò—Ç–Ω–µ –∞–¥—Ä–µ—Å–µ
4. **–à–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–æ—Å—Ç:** –à–µ–¥–Ω–æ –∞–∫—Ç–∏–≤–Ω–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ –ø–æ –ø–ª–æ—Ç—É –∏—Å—Ç–æ–≤—Ä–µ–º–µ–Ω–æ

### –ü—Ä–∞–≤–∏–ª–∞ –æ–ø–æ–∑–∏–≤–∞

1. **–í–ª–∞—Å–Ω–∏—à—Ç–≤–æ:** –¢—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞ –º–æ—Ä–∞ –±–∏—Ç–∏ –ø–æ—Ç–ø–∏—Å–∞–Ω–∞ –æ–¥ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞
2. **–ü–æ—Å—Ç–æ—ò–∞—ö–µ:** –î–æ–¥–µ—ô–∏–≤–∞—ö–µ –º–æ—Ä–∞ –ø–æ—Å—Ç–æ—ò–∞—Ç–∏ –∏ –Ω–µ —Å–º–µ –≤–µ—õ –±–∏—Ç–∏ –æ–ø–æ–∑–≤–∞–Ω–æ
3. **–§–æ—Ä–º–∞—Ç:** –í–∞–∂–µ—õ–∏ OP_RETURN —Å–∞ XCOP –º–∞—Ä–∫–µ—Ä–æ–º + 20-–±–∞—ò—Ç–Ω–∞ –∞–¥—Ä–µ—Å–∞

### –ü—Ä–∞–≤–∏–ª–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—ò–µ

- **–ê–∫—Ç–∏–≤–∞—Ü–∏—ò–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞:** `assignment_height + nForgingAssignmentDelay`
- **–ê–∫—Ç–∏–≤–∞—Ü–∏—ò–∞ –æ–ø–æ–∑–∏–≤–∞:** `revocation_height + nForgingRevocationDelay`
- **–ö–∞—à—ö–µ—ö–∞:** –ü–æ–¥–µ—Å–∏–≤–∞ –ø–æ –º—Ä–µ–∂–∏ (–Ω–ø—Ä. 30 –±–ª–æ–∫–æ–≤–∞ = ~1 —Å–∞—Ç —Å–∞ 2-–º–∏–Ω—É—Ç–Ω–∏–º –≤—Ä–µ–º–µ–Ω–æ–º –±–ª–æ–∫–∞)

### –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –±–ª–æ–∫–∞

- –ù–µ–≤–∞–∂–µ—õ–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ/–æ–ø–æ–∑–∏–≤ ‚Üí –±–ª–æ–∫ –æ–¥–±–∏—ò–µ–Ω (–Ω–µ—É—Å–ø–µ—Ö –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞)
- OP_RETURN –∏–∑–ª–∞–∑–∏ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏ –∏—Å–∫—ô—É—á–µ–Ω–∏ –∏–∑ UTXO —Å–∫—É–ø–∞ (—Å—Ç–∞–Ω–¥–∞—Ä–¥–Ω–æ Bitcoin –ø–æ–Ω–∞—à–∞—ö–µ)
- –û–±—Ä–∞–¥–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Å–µ –¥–µ—à–∞–≤–∞ –ø—Ä–µ –∞–∂—É—Ä–∏—Ä–∞—ö–∞ UTXO —É ConnectBlock

## –ó–∞–∫—ô—É—á–∞–∫

PoCX —Å–∏—Å—Ç–µ–º –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∫–æ–≤–∞—ö–∞ –∫–∞–∫–æ —ò–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω –æ–±–µ–∑–±–µ—í—É—ò–µ:

‚úÖ **–à–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–æ—Å—Ç:** –°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–µ Bitcoin —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ, –±–µ–∑ —Å–ø–µ—Ü–∏—ò–∞–ª–Ω–∏—Ö UTXO-–∞
‚úÖ **–ò—Å–ø–ª–∞—Ç–∏–≤–æ—Å—Ç:** –ë–µ–∑ –∑–∞—Ö—Ç–µ–≤–∞ –∑–∞ –ø—Ä–∞—à–∏–Ω—É, —Å–∞–º–æ –Ω–∞–∫–Ω–∞–¥–µ –∑–∞ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò—É
‚úÖ **–ë–µ–∑–±–µ–¥–Ω–æ—Å—Ç —Ä–µ–æ—Ä–≥–∞:** –°–≤–µ–æ–±—É—Ö–≤–∞—Ç–Ω–∏ –ø–æ–¥–∞—Ü–∏ –∑–∞ –ø–æ–Ω–∏—à—Ç–∞–≤–∞—ö–µ –≤—Ä–∞—õ–∞—ò—É —Ç–∞—á–Ω–æ —Å—Ç–∞—ö–µ
‚úÖ **–ê—Ç–æ–º—Å–∫–∞ –∞–∂—É—Ä–∏—Ä–∞—ö–∞:** –ö–æ–Ω–∑–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç –±–∞–∑–µ –ø–æ–¥–∞—Ç–∞–∫–∞ –∫—Ä–æ–∑ LevelDB –≥—Ä—É–ø–µ
‚úÖ **–ö–æ–º–ø–ª–µ—Ç–Ω–∞ –∏—Å—Ç–æ—Ä–∏—ò–∞:** –ü–æ—Ç–ø—É–Ω–∞ —Ä–µ–≤–∏–∑–∏—ò—Å–∫–∞ —Ç—Ä–∞–≥ —Å–≤–∏—Ö –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Ç–æ–∫–æ–º –≤—Ä–µ–º–µ–Ω–∞
‚úÖ **–ß–∏—Å—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** –ú–∏–Ω–∏–º–∞–ª–Ω–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ Bitcoin Core, –∏–∑–æ–ª–æ–≤–∞–Ω PoCX –∫–æ–¥
‚úÖ **–°–ø—Ä–µ–º–Ω–æ –∑–∞ –ø—Ä–æ–¥—É–∫—Ü–∏—ò—É:** –ü–æ—Ç–ø—É–Ω–æ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–æ, —Ç–µ—Å—Ç–∏—Ä–∞–Ω–æ –∏ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ

### –ö–≤–∞–ª–∏—Ç–µ—Ç –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–µ

- **–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–∞ –∫–æ–¥–∞:** –û–¥–ª–∏—á–Ω–∞ - —á–∏—Å—Ç–æ —Ä–∞–∑–¥–≤–∞—ò–∞—ö–µ –∏–∑–º–µ—í—É Bitcoin Core –∏ PoCX
- **–†—É–∫–æ–≤–∞—ö–µ –≥—Ä–µ—à–∫–∞–º–∞:** –°–≤–µ–æ–±—É—Ö–≤–∞—Ç–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** –ö–æ–º–µ–Ω—Ç–∞—Ä–∏ –∫–æ–¥–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–±—Ä–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω–∏
- **–¢–µ—Å—Ç–∏—Ä–∞—ö–µ:** –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–Ω–æ—Å—Ç —Ç–µ—Å—Ç–∏—Ä–∞–Ω–∞, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—ò–∞ –≤–µ—Ä–∏—Ñ–∏–∫–æ–≤–∞–Ω–∞

### –í–∞–ª–∏–¥–∏—Ä–∞–Ω–µ –∫—ô—É—á–Ω–µ –¥–∏–∑–∞—ò–Ω–µ—Ä—Å–∫–µ –æ–¥–ª—É–∫–µ

1. ‚úÖ –ü—Ä–∏—Å—Ç—É–ø –∏—Å–∫—ô—É—á–∏–≤–æ –Ω–∞ OP_RETURN (—É –æ–¥–Ω–æ—Å—É –Ω–∞ –∑–∞—Å–Ω–æ–≤–∞–Ω –Ω–∞ UTXO)
2. ‚úÖ –û–¥–≤–æ—ò–µ–Ω–æ —Å–∫–ª–∞–¥–∏—à—Ç–µ—ö–µ —É –±–∞–∑–∏ –ø–æ–¥–∞—Ç–∞–∫–∞ (—É –æ–¥–Ω–æ—Å—É –Ω–∞ Coin extraData)
3. ‚úÖ –ü—Ä–∞—õ–µ—ö–µ –∫–æ–º–ø–ª–µ—Ç–Ω–µ –∏—Å—Ç–æ—Ä–∏—ò–µ (—É –æ–¥–Ω–æ—Å—É –Ω–∞ —Å–∞–º–æ —Ç—Ä–µ–Ω—É—Ç–Ω–æ)
4. ‚úÖ –í–ª–∞—Å–Ω–∏—à—Ç–≤–æ –ø—É—Ç–µ–º –ø–æ—Ç–ø–∏—Å–∞ (—É –æ–¥–Ω–æ—Å—É –Ω–∞ —Ç—Ä–æ—à–µ—ö–µ UTXO-–∞)
5. ‚úÖ –ö–∞—à—ö–µ—ö–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—ò–µ (—Å–ø—Ä–µ—á–∞–≤–∞ –Ω–∞–ø–∞–¥–µ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–µ)

–°–∏—Å—Ç–µ–º —É—Å–ø–µ—à–Ω–æ –ø–æ—Å—Ç–∏–∂–µ —Å–≤–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ–Ω—Å–∫–µ —Ü–∏—ô–µ–≤–µ —Å–∞ —á–∏—Å—Ç–æ–º, –æ–¥—Ä–∂–∏–≤–æ–º –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–æ–º.

---

[‚Üê –ü—Ä–µ—Ç—Ö–æ–¥–Ω–æ: –ö–æ–Ω—Å–µ–Ω–∑—É—Å –∏ —Ä—É–¥–∞—Ä–µ—ö–µ](3-consensus-and-mining.md) | [üìò –°–∞–¥—Ä–∂–∞—ò](index.md) | [–°–ª–µ–¥–µ—õ–µ: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—ò–∞ –≤—Ä–µ–º–µ–Ω–∞ ‚Üí](5-timing-security.md)
