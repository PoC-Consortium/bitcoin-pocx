[‚Üê –ü—Ä–µ—Ç—Ö–æ–¥–Ω–æ: –§–æ—Ä–º–∞—Ç –ø–ª–æ—Ç–æ–≤–∞](2-plot-format.md) | [üìò –°–∞–¥—Ä–∂–∞—ò](index.md) | [–°–ª–µ–¥–µ—õ–µ: –î–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∫–æ–≤–∞—ö–∞ ‚Üí](4-forging-assignments.md)

---

# –ü–æ–≥–ª–∞–≤—ô–µ 3: Bitcoin-PoCX –∫–æ–Ω—Å–µ–Ω–∑—É—Å –∏ –ø—Ä–æ—Ü–µ—Å —Ä—É–¥–∞—Ä–µ—ö–∞

–ö–æ–º–ø–ª–µ—Ç–Ω–∞ —Ç–µ—Ö–Ω–∏—á–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ PoCX (Proof of Capacity –Ω–æ–≤–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—ò–µ) –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞ –∏ –ø—Ä–æ—Ü–µ—Å–∞ —Ä—É–¥–∞—Ä–µ—ö–∞ –∏–Ω—Ç–µ–≥—Ä–∏—Å–∞–Ω–æ–≥ —É Bitcoin Core.

---

## –°–∞–¥—Ä–∂–∞—ò

1. [–ü—Ä–µ–≥–ª–µ–¥](#–ø—Ä–µ–≥–ª–µ–¥)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞)
3. [–ü—Ä–æ—Ü–µ—Å —Ä—É–¥–∞—Ä–µ—ö–∞](#–ø—Ä–æ—Ü–µ—Å-—Ä—É–¥–∞—Ä–µ—ö–∞)
4. [–í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –±–ª–æ–∫–∞](#–≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞-–±–ª–æ–∫–∞)
5. [–°–∏—Å—Ç–µ–º –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞](#—Å–∏—Å—Ç–µ–º-–¥–æ–¥–µ—ô–∏–≤–∞—ö–∞)
6. [–ú—Ä–µ–∂–Ω–æ —à–∏—Ä–µ—ö–µ](#–º—Ä–µ–∂–Ω–æ-—à–∏—Ä–µ—ö–µ)
7. [–¢–µ—Ö–Ω–∏—á–∫–∏ –¥–µ—Ç–∞—ô–∏](#—Ç–µ—Ö–Ω–∏—á–∫–∏-–¥–µ—Ç–∞—ô–∏)

---

## –ü—Ä–µ–≥–ª–µ–¥

Bitcoin-PoCX –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞ —á–∏—Å—Ç –º–µ—Ö–∞–Ω–∏–∑–∞–º –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞ –∑–∞—Å–Ω–æ–≤–∞–Ω –Ω–∞ Proof of Capacity –∫–∞–æ –∫–æ–º–ø–ª–µ—Ç–Ω—É –∑–∞–º–µ–Ω—É –∑–∞ Bitcoin-–æ–≤ Proof of Work. –û–≤–æ —ò–µ –Ω–æ–≤–∏ –ª–∞–Ω–∞—Ü –±–µ–∑ –∑–∞—Ö—Ç–µ–≤–∞ –∑–∞ –∫–æ–º–ø–∞—Ç–∏–±–∏–ª–Ω–æ—à—õ—É —É–Ω–∞–∑–∞–¥.

**–ö—ô—É—á–Ω–µ –æ—Å–æ–±–∏–Ω–µ:**
- **–ï–Ω–µ—Ä–≥–µ—Ç—Å–∫–∏ –µ—Ñ–∏–∫–∞—Å–∞–Ω:** –†—É–¥–∞—Ä–µ—ö–µ –∫–æ—Ä–∏—Å—Ç–∏ —É–Ω–∞–ø—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∏—Å–∞–Ω–µ –ø–ª–æ—Ç –¥–∞—Ç–æ—Ç–µ–∫–µ —É–º–µ—Å—Ç–æ —Ä–∞—á—É–Ω–∞—Ä—Å–∫–æ–≥ —Ö–µ—à–∏—Ä–∞—ö–∞
- **–†–æ–∫–æ–≤–∏ —Å–∞–≤–∏—ò–µ–Ω–∏ –≤—Ä–µ–º–µ–Ω–æ–º:** –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞ –¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏—ò–µ (–µ–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏—ò–∞–ª–Ω–∞‚Üí—Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç) —Å–º–∞—ö—É—ò–µ –¥—É–≥–µ –±–ª–æ–∫–æ–≤–µ, –ø–æ–±–æ—ô—à–∞–≤–∞ –ø—Ä–æ—Å–µ—á–Ω–∞ –≤—Ä–µ–º–µ–Ω–∞ –±–ª–æ–∫–æ–≤–∞
- **–ü–æ–¥—Ä—à–∫–∞ –∑–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ:** –í–ª–∞—Å–Ω–∏—Ü–∏ –ø–ª–æ—Ç–æ–≤–∞ –º–æ–≥—É –¥–µ–ª–µ–≥–∏—Ä–∞—Ç–∏ –ø—Ä–∞–≤–∞ –∫–æ–≤–∞—ö–∞ –¥—Ä—É–≥–∏–º –∞–¥—Ä–µ—Å–∞–º–∞
- **–ù–∞—Ç–∏–≤–Ω–∞ C++ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—ò–∞:** –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—Å–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–∏ —É C++ –∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò—É –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞

**–¢–æ–∫ —Ä—É–¥–∞—Ä–µ—ö–∞:**
```
–°–ø–æ—ô–Ω–∏ —Ä—É–¥–∞—Ä ‚Üí get_mining_info ‚Üí –ò–∑—Ä–∞—á—É–Ω–∞—ò nonce ‚Üí submit_nonce ‚Üí
–†–µ–¥ —á–µ–∫–∞—ö–∞ –∫–æ–≤–∞—á–∞ ‚Üí –ß–µ–∫–∞—ö–µ —Ä–æ–∫–∞ ‚Üí –ö–æ–≤–∞—ö–µ –±–ª–æ–∫–∞ ‚Üí –ú—Ä–µ–∂–Ω–æ —à–∏—Ä–µ—ö–µ ‚Üí
–í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –±–ª–æ–∫–∞ ‚Üí –ü—Ä–æ–¥—É–∂–µ—ö–µ –ª–∞–Ω—Ü–∞
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–ª–æ–∫–∞

PoCX –±–ª–æ–∫–æ–≤–∏ –ø—Ä–æ—à–∏—Ä—É—ò—É Bitcoin-–æ–≤—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±–ª–æ–∫–∞ —Å–∞ –¥–æ–¥–∞—Ç–Ω–∏–º –ø–æ—ô–∏–º–∞ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞:

```cpp
struct PoCXProof {
    std::array<uint8_t, 32> seed;             // Seed –ø–ª–æ—Ç–∞ (32 –±–∞—ò—Ç–∞)
    std::array<uint8_t, 20> account_id;       // –ê–¥—Ä–µ—Å–∞ –ø–ª–æ—Ç–∞ (20-–±–∞—ò—Ç–Ω–∏ hash160)
    uint32_t compression;                     // –ù–∏–≤–æ —Å–∫–∞–ª–∏—Ä–∞—ö–∞ (1-255)
    uint64_t nonce;                           // Nonce —Ä—É–¥–∞—Ä–µ—ö–∞ (64-–±–∏—Ç)
    uint64_t quality;                         // –ü—Ä–∏—ò–∞–≤—ô–µ–Ω–∏ –∫–≤–∞–ª–∏—Ç–µ—Ç (–∏–∑–ª–∞–∑ PoC —Ö–µ—à–∞)
};

class CBlockHeader {
    // –°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞ Bitcoin –ø–æ—ô–∞
    int32_t nVersion;
    uint256 hashPrevBlock;
    uint256 hashMerkleRoot;
    uint32_t nTime;

    // PoCX –ø–æ—ô–∞ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞ (–∑–∞–º–µ—ö—É—ò—É nBits –∏ nNonce)
    int nHeight;                              // –í–∏—Å–∏–Ω–∞ –±–ª–æ–∫–∞ (–≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
    uint256 generationSignature;              // –ì–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–∏ –ø–æ—Ç–ø–∏—Å (–µ–Ω—Ç—Ä–æ–ø–∏—ò–∞ —Ä—É–¥–∞—Ä–µ—ö–∞)
    uint64_t nBaseTarget;                     // –ü–∞—Ä–∞–º–µ—Ç–∞—Ä —Ç–µ–∂–∏–Ω–µ (–∏–Ω–≤–µ—Ä–∑–Ω–∞ —Ç–µ–∂–∏–Ω–∞)
    PoCXProof pocxProof;                      // –î–æ–∫–∞–∑ —Ä—É–¥–∞—Ä–µ—ö–∞

    // –ü–æ—ô–∞ –ø–æ—Ç–ø–∏—Å–∞ –±–ª–æ–∫–∞
    std::array<uint8_t, 33> vchPubKey;        // –ö–æ–º–ø—Ä–µ—Å–æ–≤–∞–Ω —ò–∞–≤–Ω–∏ –∫—ô—É—á (33 –±–∞—ò—Ç–∞)
    std::array<uint8_t, 65> vchSignature;     // –ö–æ–º–ø–∞–∫—Ç–Ω–∏ –ø–æ—Ç–ø–∏—Å (65 –±–∞—ò—Ç–æ–≤–∞)
};

class CBlock : public CBlockHeader {
    std::vector<CTransactionRef> vtx;         // –¢—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ
};
```

**–ù–∞–ø–æ–º–µ–Ω–∞:** –ü–æ—Ç–ø–∏—Å (`vchSignature`) —ò–µ –∏—Å–∫—ô—É—á–µ–Ω –∏–∑ –∏–∑—Ä–∞—á—É–Ω–∞–≤–∞—ö–∞ —Ö–µ—à–∞ –±–ª–æ–∫–∞ –¥–∞ –±–∏ —Å–µ —Å–ø—Ä–µ—á–∏–ª–∞ –º–∞–ª–µ–∞–±–∏–ª–Ω–æ—Å—Ç.

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/primitives/block.h`

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–∏ –ø–æ—Ç–ø–∏—Å

–ì–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–∏ –ø–æ—Ç–ø–∏—Å –∫—Ä–µ–∏—Ä–∞ –µ–Ω—Ç—Ä–æ–ø–∏—ò—É –∑–∞ —Ä—É–¥–∞—Ä–µ—ö–µ –∏ —Å–ø—Ä–µ—á–∞–≤–∞ –Ω–∞–ø–∞–¥–µ –ø—Ä–µ—Ç–ø—Ä–µ—Ç—Ä–∞–∂–∏–≤–∞—ö–∞.

**–ò–∑—Ä–∞—á—É–Ω–∞–≤–∞—ö–µ:**
```
generationSignature = SHA256(prev_generationSignature || prev_miner_pubkey)
```

**–ì–µ–Ω–µ–∑–∏—Å –±–ª–æ–∫:** –ö–æ—Ä–∏—Å—Ç–∏ —Ö–∞—Ä–¥–∫–æ–¥–∏—Ä–∞–Ω–∏ –∏–Ω–∏—Ü–∏—ò–∞–ª–Ω–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–∏ –ø–æ—Ç–ø–∏—Å

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/node/node.cpp:GetNewBlockContext()`

### –ë–∞–∑–Ω–∏ —Ü–∏—ô (—Ç–µ–∂–∏–Ω–∞)

–ë–∞–∑–Ω–∏ —Ü–∏—ô —ò–µ –∏–Ω–≤–µ—Ä–∑–∏—ò–∞ —Ç–µ–∂–∏–Ω–µ ‚Äî –≤–∏—à–µ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –∑–Ω–∞—á–µ –ª–∞–∫—à–µ —Ä—É–¥–∞—Ä–µ—ö–µ.

**–ê–ª–≥–æ—Ä–∏—Ç–∞–º –ø–æ–¥–µ—à–∞–≤–∞—ö–∞:**
- –¶–∏—ô–∞–Ω–æ –≤—Ä–µ–º–µ –±–ª–æ–∫–∞: 120 —Å–µ–∫—É–Ω–¥–∏ (mainnet), 1 —Å–µ–∫—É–Ω–¥–∞ (regtest)
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø–æ–¥–µ—à–∞–≤–∞—ö–∞: –°–≤–∞–∫–∏ –±–ª–æ–∫
- –ö–æ—Ä–∏—Å—Ç–∏ –ø–æ–∫—Ä–µ—Ç–Ω–∏ –ø—Ä–æ—Å–µ–∫ –Ω–µ–¥–∞–≤–Ω–∏—Ö –±–∞–∑–Ω–∏—Ö —Ü–∏—ô–µ–≤–∞
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–∞ —Å–ø—Ä–µ—á–∏ –µ–∫—Å—Ç—Ä–µ–º–Ω–µ –ø—Ä–æ–º–µ–Ω–µ —Ç–µ–∂–∏–Ω–µ

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/consensus/params.h`, –ø–æ–¥–µ—à–∞–≤–∞—ö–µ —Ç–µ–∂–∏–Ω–µ —É –∫—Ä–µ–∏—Ä–∞—ö—É –±–ª–æ–∫–∞

### –ù–∏–≤–æ–∏ —Å–∫–∞–ª–∏—Ä–∞—ö–∞

PoCX –ø–æ–¥—Ä–∂–∞–≤–∞ —Å–∫–∞–ª–∞–±–∏–ª–Ω–∏ –¥–æ–∫–∞–∑ —Ä–∞–¥–∞ —É –ø–ª–æ—Ç –¥–∞—Ç–æ—Ç–µ–∫–∞–º–∞ –∫—Ä–æ–∑ –Ω–∏–≤–æ–µ —Å–∫–∞–ª–∏—Ä–∞—ö–∞ (Xn).

**–î–∏–Ω–∞–º–∏—á–∫–µ –≥—Ä–∞–Ω–∏—Ü–µ:**
```cpp
struct CompressionBounds {
    uint8_t nPoCXMinCompression;     // –ú–∏–Ω–∏–º–∞–ª–Ω–∏ –ø—Ä–∏—Ö–≤–∞—õ–µ–Ω –Ω–∏–≤–æ
    uint8_t nPoCXTargetCompression;  // –ü—Ä–µ–ø–æ—Ä—É—á–µ–Ω–∏ –Ω–∏–≤–æ
};
```

**–†–∞—Å–ø–æ—Ä–µ–¥ –ø–æ–≤–µ—õ–∞—ö–∞ —Å–∫–∞–ª–∏—Ä–∞—ö–∞:**
- –ï–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏—ò–∞–ª–Ω–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏: –ì–æ–¥–∏–Ω–µ 4, 12, 28, 60, 124 (–ø—Ä–µ–ø–æ–ª–æ–≤—ô–∞–≤–∞—ö–∞ 1, 3, 7, 15, 31)
- –ú–∏–Ω–∏–º–∞–ª–Ω–∏ –Ω–∏–≤–æ —Å–∫–∞–ª–∏—Ä–∞—ö–∞ —Å–µ –ø–æ–≤–µ—õ–∞–≤–∞ –∑–∞ 1
- –¶–∏—ô–∞–Ω–∏ –Ω–∏–≤–æ —Å–∫–∞–ª–∏—Ä–∞—ö–∞ —Å–µ –ø–æ–≤–µ—õ–∞–≤–∞ –∑–∞ 1
- –û–¥—Ä–∂–∞–≤–∞ —Å–∏–≥—É—Ä–Ω–æ—Å–Ω—É –º–∞—Ä–≥–∏–Ω—É –∏–∑–º–µ—í—É —Ç—Ä–æ—à–∫–æ–≤–∞ –∫—Ä–µ–∏—Ä–∞—ö–∞ –ø–ª–æ—Ç–∞ –∏ –ø—Ä–µ—Ç—Ä–∞–∂–∏–≤–∞—ö–∞
- –ú–∞–∫—Å–∏–º–∞–ª–Ω–∏ –Ω–∏–≤–æ —Å–∫–∞–ª–∏—Ä–∞—ö–∞: 255

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/algorithms/algorithms.h:GetPoCXCompressionBounds()`

---

## –ü—Ä–æ—Ü–µ—Å —Ä—É–¥–∞—Ä–µ—ö–∞

### 1. –ü—Ä–µ—É–∑–∏–º–∞—ö–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—ò–∞ –æ —Ä—É–¥–∞—Ä–µ—ö—É

**RPC –∫–æ–º–∞–Ω–¥–∞:** `get_mining_info`

**–ü—Ä–æ—Ü–µ—Å:**
1. –ü–æ–∑–æ–≤–∏ `GetNewBlockContext(chainman)` –¥–∞ –ø—Ä–µ—É–∑–º–µ—à —Ç—Ä–µ–Ω—É—Ç–Ω–æ —Å—Ç–∞—ö–µ –±–ª–æ–∫—á–µ—ò–Ω–∞
2. –ò–∑—Ä–∞—á—É–Ω–∞—ò –¥–∏–Ω–∞–º–∏—á–∫–µ –≥—Ä–∞–Ω–∏—Ü–µ –∫–æ–º–ø—Ä–µ—Å–∏—ò–µ –∑–∞ —Ç—Ä–µ–Ω—É—Ç–Ω—É –≤–∏—Å–∏–Ω—É
3. –í—Ä–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ —Ä—É–¥–∞—Ä–µ—ö–∞

**–û–¥–≥–æ–≤–æ—Ä:**
```json
{
  "generation_signature": "abc123...",
  "base_target": 18325193796,
  "height": 12345,
  "block_hash": "def456...",
  "target_quality": 18446744073709551615,
  "minimum_compression_level": 0,
  "target_compression_level": 0
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/rpc/mining.cpp:get_mining_info()`

**–ù–∞–ø–æ–º–µ–Ω–µ:**
- –ù–µ–º–∞ –∑–∞–¥—Ä–∂–∞–Ω–∏—Ö –∑–∞–∫—ô—É—á–∞–≤–∞—ö–∞ —Ç–æ–∫–æ–º –≥–µ–Ω–µ—Ä–∏—Å–∞—ö–∞ –æ–¥–≥–æ–≤–æ—Ä–∞
- –ü—Ä–µ—É–∑–∏–º–∞—ö–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Ä—É–∫—É—ò–µ `cs_main` –∏–Ω—Ç–µ—Ä–Ω–æ
- `block_hash` —É–∫—ô—É—á–µ–Ω –∑–∞ —Ä–µ—Ñ–µ—Ä–µ–Ω—Ü—É –∞–ª–∏ —Å–µ –Ω–µ –∫–æ—Ä–∏—Å—Ç–∏ —É –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∏

### 2. –°–ø–æ—ô–Ω–æ —Ä—É–¥–∞—Ä–µ—ö–µ

**–û–¥–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç–∏ —Å–ø–æ—ô–Ω–æ–≥ —Ä—É–¥–∞—Ä–∞:**
1. –ß–∏—Ç–∞—ò –ø–ª–æ—Ç –¥–∞—Ç–æ—Ç–µ–∫–µ —Å–∞ –¥–∏—Å–∫–∞
2. –ò–∑—Ä–∞—á—É–Ω–∞—ò scoop –Ω–∞ –æ—Å–Ω–æ–≤—É –≥–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–æ–≥ –ø–æ—Ç–ø–∏—Å–∞ –∏ –≤–∏—Å–∏–Ω–µ
3. –ü—Ä–æ–Ω–∞—í–∏ nonce —Å–∞ –Ω–∞—ò–±–æ—ô–∏–º —Ä–æ–∫–æ–º
4. –ü–æ—à–∞—ô–∏ –Ω–∞ —á–≤–æ—Ä –ø—Ä–µ–∫–æ `submit_nonce`

**–§–æ—Ä–º–∞—Ç –ø–ª–æ—Ç –¥–∞—Ç–æ—Ç–µ–∫–µ:**
- –ó–∞—Å–Ω–æ–≤–∞–Ω –Ω–∞ POC2 —Ñ–æ—Ä–º–∞—Ç—É (Burstcoin)
- –ü–æ–±–æ—ô—à–∞–Ω —Å–∞ –±–µ–∑–±–µ–¥–Ω–æ—Å–Ω–∏–º –∏—Å–ø—Ä–∞–≤–∫–∞–º–∞ –∏ –ø–æ–±–æ—ô—à–∞—ö–∏–º–∞ —Å–∫–∞–ª–∞–±–∏–ª–Ω–æ—Å—Ç–∏
- –ü–æ–≥–ª–µ–¥–∞—ò—Ç–µ –∞—Ç—Ä–∏–±—É—Ü–∏—ò—É —É `CLAUDE.md`

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞ —Ä—É–¥–∞—Ä–∞:** –°–ø–æ—ô–Ω–∞ (–Ω–ø—Ä. –∑–∞—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ Scavenger)

### 3. –°–ª–∞—ö–µ nonce-–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞

**RPC –∫–æ–º–∞–Ω–¥–∞:** `submit_nonce`

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
```
height, generation_signature, account_id, seed, nonce, quality (–æ–ø—Ü–∏–æ–Ω–æ)
```

**–¢–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–µ (–æ–ø—Ç–∏–º–∏–∑–æ–≤–∞–Ω —Ä–µ–¥–æ—Å–ª–µ–¥):**

#### –ö–æ—Ä–∞–∫ 1: –ë—Ä–∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ —Ñ–æ—Ä–º–∞—Ç–∞
```cpp
// Account ID: 40 —Ö–µ–∫—Å –∫–∞—Ä–∞–∫—Ç–µ—Ä–∞ = 20 –±–∞—ò—Ç–æ–≤–∞
if (account_id.length() != 40 || !IsHex(account_id)) reject;

// Seed: 64 —Ö–µ–∫—Å –∫–∞—Ä–∞–∫—Ç–µ—Ä–∞ = 32 –±–∞—ò—Ç–∞
if (seed.length() != 64 || !IsHex(seed)) reject;
```

#### –ö–æ—Ä–∞–∫ 2: –ü—Ä–µ—É–∑–∏–º–∞—ö–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```cpp
auto context = pocx::consensus::GetNewBlockContext(chainman);
// –í—Ä–∞—õ–∞: height, generation_signature, base_target, block_hash
```

**–ó–∞–∫—ô—É—á–∞–≤–∞—ö–µ:** `cs_main` —Å–µ —Ä—É–∫—É—ò–µ –∏–Ω—Ç–µ—Ä–Ω–æ, –Ω–µ–º–∞ –∑–∞–∫—ô—É—á–∞–≤–∞—ö–∞ —É RPC –Ω–∏—Ç–∏

#### –ö–æ—Ä–∞–∫ 3: –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
```cpp
// –ü—Ä–æ–≤–µ—Ä–∞ –≤–∏—Å–∏–Ω–µ
if (height != context.height) reject;

// –ü—Ä–æ–≤–µ—Ä–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–æ–≥ –ø–æ—Ç–ø–∏—Å–∞
if (submitted_gen_sig != context.generation_signature) reject;
```

#### –ö–æ—Ä–∞–∫ 4: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ –Ω–æ–≤—á–∞–Ω–∏–∫–∞
```cpp
// –û–¥—Ä–µ–¥–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫–∞ (—É–∑–∏–º–∞—ò—É—õ–∏ —É –æ–±–∑–∏—Ä –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞)
effective_signer = GetEffectiveSigner(plot_address, height, view);

// –ü—Ä–æ–≤–µ—Ä–∏ –¥–∞ –ª–∏ —á–≤–æ—Ä –∏–º–∞ –ø—Ä–∏–≤–∞—Ç–Ω–∏ –∫—ô—É—á –∑–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫–∞
if (!HaveAccountKey(effective_signer, wallet)) reject;
```

**–ü–æ–¥—Ä—à–∫–∞ –∑–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ:** –í–ª–∞—Å–Ω–∏–∫ –ø–ª–æ—Ç–∞ –º–æ–∂–µ –¥–æ–¥–µ–ª–∏—Ç–∏ –ø—Ä–∞–≤–∞ –∫–æ–≤–∞—ö–∞ –¥—Ä—É–≥–æ—ò –∞–¥—Ä–µ—Å–∏. –ù–æ–≤—á–∞–Ω–∏–∫ –º–æ—Ä–∞ –∏–º–∞—Ç–∏ –∫—ô—É—á –∑–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫–∞, –Ω–µ –æ–±–∞–≤–µ–∑–Ω–æ –∑–∞ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞.

#### –ö–æ—Ä–∞–∫ 5: –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –¥–æ–∫–∞–∑–∞
```cpp
bool success = pocx_validate_block(
    generation_signature_hex,
    base_target,
    account_payload,     // 20 –±–∞—ò—Ç–æ–≤–∞
    block_height,
    nonce,
    seed,                // 32 –±–∞—ò—Ç–∞
    min_compression,
    max_compression,
    &result             // –ò–∑–ª–∞–∑: quality, deadline
);
```

**–ê–ª–≥–æ—Ä–∏—Ç–∞–º:**
1. –î–µ–∫–æ–¥–∏—Ä–∞—ò –≥–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–∏ –ø–æ—Ç–ø–∏—Å –∏–∑ —Ö–µ–∫—Å–∞
2. –ò–∑—Ä–∞—á—É–Ω–∞—ò –Ω–∞—ò–±–æ—ô–∏ –∫–≤–∞–ª–∏—Ç–µ—Ç —É –æ–ø—Å–µ–≥—É –∫–æ–º–ø—Ä–µ—Å–∏—ò–µ –∫–æ—Ä–∏—Å—Ç–µ—õ–∏ SIMD-–æ–ø—Ç–∏–º–∏–∑–æ–≤–∞–Ω–µ –∞–ª–≥–æ—Ä–∏—Ç–º–µ
3. –í–∞–ª–∏–¥–∏—Ä–∞—ò –¥–∞ –∫–≤–∞–ª–∏—Ç–µ—Ç –∑–∞–¥–æ–≤–æ—ô–∞–≤–∞ –∑–∞—Ö—Ç–µ–≤–µ —Ç–µ–∂–∏–Ω–µ
4. –í—Ä–∞—Ç–∏ —Å–∏—Ä–æ–≤—É –≤—Ä–µ–¥–Ω–æ—Å—Ç –∫–≤–∞–ª–∏—Ç–µ—Ç–∞

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/consensus/validation.cpp:pocx_validate_block()`

#### –ö–æ—Ä–∞–∫ 6: –ò–∑—Ä–∞—á—É–Ω–∞–≤–∞—ö–µ —Å–∞–≤–∏—ò–∞—ö–∞ –≤—Ä–µ–º–µ–Ω–∞
```cpp
// –°–∏—Ä–æ–≤–∏ —Ä–æ–∫ –ø–æ–¥–µ—à–µ–Ω —Ç–µ–∂–∏–Ω–æ–º (—Å–µ–∫—É–Ω–¥–µ)
uint64_t deadline_seconds = quality / base_target;

// –í—Ä–µ–º–µ –∫–æ–≤–∞—ö–∞ —Å–∞–≤–∏—ò–µ–Ω–æ –≤—Ä–µ–º–µ–Ω–æ–º (—Å–µ–∫—É–Ω–¥–µ)
uint64_t forge_time = CalculateTimeBendedDeadline(
    quality, base_target, block_time
);
```

**–§–æ—Ä–º—É–ª–∞ —Å–∞–≤–∏—ò–∞—ö–∞ –≤—Ä–µ–º–µ–Ω–∞:**
```
Y = scale * (X^(1/3))
–≥–¥–µ:
  X = quality / base_target
  scale = block_time / (cbrt(block_time) * Gamma(4/3))
  Gamma(4/3) ‚âà 0.892979511
```

**–°–≤—Ä—Ö–∞:** –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—à–µ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏—ò–∞–ª–Ω—É —É —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç –¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏—ò—É. –í–µ–æ–º–∞ –¥–æ–±—Ä–∞ —Ä–µ—à–µ—ö–∞ —Å–µ –∫—É—ò—É –∫–∞—Å–Ω–∏—ò–µ (–º—Ä–µ–∂–∞ –∏–º–∞ –≤—Ä–µ–º–µ–Ω–∞ –¥–∞ —Å–∫–µ–Ω–∏—Ä–∞ –¥–∏—Å–∫–æ–≤–µ), –ª–æ—à–∞ —Ä–µ—à–µ—ö–∞ —Å—É –ø–æ–±–æ—ô—à–∞–Ω–∞. –°–º–∞—ö—É—ò–µ –¥—É–≥–µ –±–ª–æ–∫–æ–≤–µ, –æ–¥—Ä–∂–∞–≤–∞ –ø—Ä–æ—Å–µ–∫ –æ–¥ 120s.

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/algorithms/time_bending.cpp:CalculateTimeBendedDeadline()`

#### –ö–æ—Ä–∞–∫ 7: –°–ª–∞—ö–µ –∫–æ–≤–∞—á—É
```cpp
g_pocx_scheduler->SubmitNonce(
    account_id,
    seed,
    nonce,
    raw_quality,      // –ù–ï deadline - –ø–æ–Ω–æ–≤–æ —Å–µ —Ä–∞—á—É–Ω–∞ —É –∫–æ–≤–∞—á—É
    height,
    generation_signature
);
```

**–î–∏–∑–∞—ò–Ω –∑–∞—Å–Ω–æ–≤–∞–Ω –Ω–∞ —Ä–µ–¥—É —á–µ–∫–∞—ö–∞:**
- –°–ª–∞—ö–µ —É–≤–µ–∫ —É—Å–ø–µ–≤–∞ (–¥–æ–¥–∞—ò–µ —Å–µ —É —Ä–µ–¥ —á–µ–∫–∞—ö–∞)
- RPC —Å–µ –æ–¥–º–∞—Ö –≤—Ä–∞—õ–∞
- –†–∞–¥–Ω–∞ –Ω–∏—Ç –æ–±—Ä–∞—í—É—ò–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–æ

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/rpc/mining.cpp:submit_nonce()`

### 4. –û–±—Ä–∞–¥–∞ —Ä–µ–¥–∞ —á–µ–∫–∞—ö–∞ –∫–æ–≤–∞—á–∞

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- –à–µ–¥–Ω–∞ —Ç—Ä–∞—ò–Ω–∞ —Ä–∞–¥–Ω–∞ –Ω–∏—Ç
- FIFO —Ä–µ–¥ —á–µ–∫–∞—ö–∞ –∑–∞ —Å–ª–∞—ö–µ
- –°—Ç–∞—ö–µ –∫–æ–≤–∞—ö–∞ –±–µ–∑ –∑–∞–∫—ô—É—á–∞–≤–∞—ö–∞ (—Å–∞–º–æ —Ä–∞–¥–Ω–∞ –Ω–∏—Ç)
- –ë–µ–∑ —É–≥–Ω–µ–∂—í–µ–Ω–∏—Ö –∑–∞–∫—ô—É—á–∞–≤–∞—ö–∞ (–ø—Ä–µ–≤–µ–Ω—Ü–∏—ò–∞ –º—Ä—Ç–≤–µ –ø–µ—Ç—ô–µ)

**–ì–ª–∞–≤–Ω–∞ –ø–µ—Ç—ô–∞ —Ä–∞–¥–Ω–µ –Ω–∏—Ç–∏:**
```cpp
while (!shutdown) {
    // 1. –ü—Ä–æ–≤–µ—Ä–∏ –∑–∞ —Å–ª–∞—ö–∞ —É —Ä–µ–¥—É —á–µ–∫–∞—ö–∞
    if (has_submission) {
        ProcessSubmission(submission);
        continue;
    }

    // 2. –ß–µ–∫–∞—ò —Ä–æ–∫ –∏–ª–∏ –Ω–æ–≤–æ —Å–ª–∞—ö–µ
    if (has_forging_state) {
        WaitForDeadlineOrNewSubmission();
    } else {
        WaitForNewSubmission();
    }
}
```

**–õ–æ–≥–∏–∫–∞ ProcessSubmission:**
```cpp
1. –î–æ–±–∞–≤–∏ —Å–≤–µ–∂ –∫–æ–Ω—Ç–µ–∫—Å—Ç: GetNewBlockContext(*chainman)

2. –ü—Ä–æ–≤–µ—Ä–µ –∑–∞—Å—Ç–∞—Ä–µ–ª–æ—Å—Ç–∏ (—Ç–∏—Ö–æ –æ–¥–±–∞—Ü–∏–≤–∞—ö–µ):
   - –ù–µ–ø–æ–¥—É–¥–∞—Ä–∞—ö–µ –≤–∏—Å–∏–Ω–µ ‚Üí –æ–¥–±–∞—Ü–∏
   - –ù–µ–ø–æ–¥—É–¥–∞—Ä–∞—ö–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–æ–≥ –ø–æ—Ç–ø–∏—Å–∞ ‚Üí –æ–¥–±–∞—Ü–∏
   - –ü—Ä–æ–º–µ—ö–µ–Ω —Ö–µ—à –≤—Ä—Ö–∞ –±–ª–æ–∫–∞ (—Ä–µ–æ—Ä–≥) ‚Üí —Ä–µ—Å–µ—Ç—É—ò —Å—Ç–∞—ö–µ –∫–æ–≤–∞—ö–∞

3. –ü–æ—Ä–µ—í–µ—ö–µ –∫–≤–∞–ª–∏—Ç–µ—Ç–∞:
   - –ê–∫–æ —ò–µ quality >= current_best ‚Üí –æ–¥–±–∞—Ü–∏

4. –ò–∑—Ä–∞—á—É–Ω–∞—ò —Ä–æ–∫ —Å–∞–≤–∏—ò–µ–Ω –≤—Ä–µ–º–µ–Ω–æ–º:
   deadline = CalculateTimeBendedDeadline(quality, base_target, block_time)

5. –ê–∂—É—Ä–∏—Ä–∞—ò —Å—Ç–∞—ö–µ –∫–æ–≤–∞—ö–∞:
   - –û—Ç–∫–∞–∂–∏ –ø–æ—Å—Ç–æ—ò–µ—õ–µ –∫–æ–≤–∞—ö–µ (–∞–∫–æ —ò–µ –ø—Ä–æ–Ω–∞—í–µ–Ω–æ –±–æ—ô–µ)
   - –°–∫–ª–∞–¥–∏—à—Ç–∏: account_id, seed, nonce, quality, deadline
   - –ò–∑—Ä–∞—á—É–Ω–∞—ò: forge_time = block_time + deadline_seconds
   - –°–∫–ª–∞–¥–∏—à—Ç–∏ —Ö–µ—à –≤—Ä—Ö–∞ –∑–∞ –¥–µ—Ç–µ–∫—Ü–∏—ò—É —Ä–µ–æ—Ä–≥–∞
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/mining/scheduler.cpp:ProcessSubmission()`

### 5. –ß–µ–∫–∞—ö–µ —Ä–æ–∫–∞ –∏ –∫–æ–≤–∞—ö–µ –±–ª–æ–∫–∞

**WaitForDeadlineOrNewSubmission:**

**–£—Å–ª–æ–≤–∏ —á–µ–∫–∞—ö–∞:**
```cpp
condition_variable.wait_until(forge_time, [&] {
    return shutdown ||
           !submission_queue.empty() ||
           forging_cancelled;
});
```

**–ö–∞–¥–∞ —ò–µ —Ä–æ–∫ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç - –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ —Å–≤–µ–∂–µ–≥ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
```cpp
1. –î–æ–±–∞–≤–∏ —Ç—Ä–µ–Ω—É—Ç–Ω–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç: GetNewBlockContext(*chainman)

2. –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –≤–∏—Å–∏–Ω–µ:
   if (forging_height != current_height) {
       reset_forging_state();
       return;
   }

3. –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–æ–≥ –ø–æ—Ç–ø–∏—Å–∞:
   if (forging_gen_sig != current_gen_sig) {
       reset_forging_state();
       return;
   }

4. –ì—Ä–∞–Ω–∏—á–Ω–∏ —Å–ª—É—á–∞—ò –±–∞–∑–Ω–æ–≥ —Ü–∏—ô–∞:
   if (forging_base_target != current_base_target) {
       // –ü—Ä–µ—Ä–∞—á—É–Ω–∞—ò —Ä–æ–∫ —Å–∞ –Ω–æ–≤–∏–º –±–∞–∑–Ω–∏–º —Ü–∏—ô–µ–º
       new_deadline = CalculateTimeBendedDeadline(quality, new_base_target, block_time);
       update_forge_time(new_deadline);
       return; // –ß–µ–∫–∞—ò –ø–æ–Ω–æ–≤–æ
   }

5. –°–≤–µ –≤–∞–∂–∏ ‚Üí ForgeBlock()
```

**–ü—Ä–æ—Ü–µ—Å ForgeBlock:**

```cpp
1. –û–¥—Ä–µ–¥–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫–∞ (–ø–æ–¥—Ä—à–∫–∞ –∑–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ):
   effective_signer = GetEffectiveSigner(plot_address, height, view);

2. –ö—Ä–µ–∏—Ä–∞—ò coinbase —Å–∫—Ä–∏–ø—Ç—É:
   coinbase_script = P2WPKH(effective_signer);  // –ü–ª–∞—õ–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º –ø–æ—Ç–ø–∏—Å–Ω–∏–∫—É

3. –ö—Ä–µ–∏—Ä–∞—ò —à–∞–±–ª–æ–Ω –±–ª–æ–∫–∞:
   options.coinbase_output_script = coinbase_script;
   options.use_mempool = true;
   template = mining->createNewBlock(options);

4. –î–æ–¥–∞—ò PoCX –¥–æ–∫–∞–∑:
   block.pocxProof.account_id = plot_address;    // –û—Ä–∏–≥–∏–Ω–∞–ª–Ω–∞ –∞–¥—Ä–µ—Å–∞ –ø–ª–æ—Ç–∞
   block.pocxProof.seed = seed;
   block.pocxProof.nonce = nonce;

5. –ü—Ä–µ—Ä–∞—á—É–Ω–∞—ò merkle –∫–æ—Ä–µ–Ω:
   block.hashMerkleRoot = BlockMerkleRoot(block);

6. –ü–æ—Ç–ø–∏—à–∏ –±–ª–æ–∫:
   // –ö–æ—Ä–∏—Å—Ç–∏ –∫—ô—É—á –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫–∞ (–º–æ–∂–µ –±–∏—Ç–∏ –¥—Ä—É–≥–∞—á–∏—ò–∏ –æ–¥ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞)
   hash = PoCXBlockSignatureHash(block.GetHash());
   key.SignCompact(hash, signature);
   block.vchSignature = signature;
   block.vchPubKey = effective_signer_pubkey;

7. –ü–æ—à–∞—ô–∏ —É –ª–∞–Ω–∞—Ü:
   chainman->ProcessNewBlock(block, force=true, min_pow_checked=true);

8. –†—É–∫–æ–≤–∞—ö–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–æ–º:
   if (accepted) {
       log_success();
       reset_forging_state();  // –°–ø—Ä–µ–º–Ω–æ –∑–∞ —Å–ª–µ–¥–µ—õ–∏ –±–ª–æ–∫
   } else {
       log_failure();
       reset_forging_state();
   }
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/pocx/mining/scheduler.cpp:ForgeBlock()`

**–ö—ô—É—á–Ω–µ –¥–∏–∑–∞—ò–Ω–µ—Ä—Å–∫–µ –æ–¥–ª—É–∫–µ:**
- Coinbase –ø–ª–∞—õ–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º –ø–æ—Ç–ø–∏—Å–Ω–∏–∫—É (–ø–æ—à—Ç—É—ò–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞)
- –î–æ–∫–∞–∑ —Å–∞–¥—Ä–∂–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω—É –∞–¥—Ä–µ—Å—É –ø–ª–æ—Ç–∞ (–∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò—É)
- –ü–æ—Ç–ø–∏—Å –æ–¥ –∫—ô—É—á–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫–∞ (–¥–æ–∫–∞–∑ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–∞)
- –ö—Ä–µ–∏—Ä–∞—ö–µ —à–∞–±–ª–æ–Ω–∞ —É–∫—ô—É—á—É—ò–µ mempool —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ –∞—É—Ç–æ–º–∞—Ç—Å–∫–∏

---

## –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –±–ª–æ–∫–∞

### –¢–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–µ –¥–æ–ª–∞–∑–µ—õ–µ–≥ –±–ª–æ–∫–∞

–ö–∞–¥–∞ —Å–µ –±–ª–æ–∫ –ø—Ä–∏–º–∏ –æ–¥ –º—Ä–µ–∂–µ –∏–ª–∏ –ø–æ—à–∞—ô–µ –ª–æ–∫–∞–ª–Ω–æ, –ø—Ä–æ–ª–∞–∑–∏ –∫—Ä–æ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏—ò—É —É –≤–∏—à–µ —Ñ–∞–∑–∞:

### –§–∞–∑–∞ 1: –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –∑–∞–≥–ª–∞–≤—ô–∞ (CheckBlockHeader)

**–í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**

```cpp
static bool CheckBlockHeader(
    const CBlockHeader& block,
    BlockValidationState& state,
    const Consensus::Params& consensusParams,
    bool fCheckPOW = true
)
```

**PoCX –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ (–∫–∞–¥–∞ —ò–µ ENABLE_POCX –¥–µ—Ñ–∏–Ω–∏—Å–∞–Ω):**
```cpp
if (block.nHeight > 0 && fCheckPOW) {
    // –û—Å–Ω–æ–≤–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –ø–æ—Ç–ø–∏—Å–∞ (–±–µ–∑ –ø–æ–¥—Ä—à–∫–µ –∑–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ —ò–æ—à)
    if (!VerifyPoCXBlockCompactSignature(block)) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-pocx-sig");
    }
}
```

**–û—Å–Ω–æ–≤–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –ø–æ—Ç–ø–∏—Å–∞:**
1. –ü—Ä–æ–≤–µ—Ä–∏ –ø—Ä–∏—Å—É—Å—Ç–≤–æ –ø–æ—ô–∞ pubkey –∏ signature
2. –í–∞–ª–∏–¥–∏—Ä–∞—ò –≤–µ–ª–∏—á–∏–Ω—É pubkey-–∞ (33 –±–∞—ò—Ç–∞ –∫–æ–º–ø—Ä–µ—Å–æ–≤–∞–Ω–æ)
3. –í–∞–ª–∏–¥–∏—Ä–∞—ò –≤–µ–ª–∏—á–∏–Ω—É –ø–æ—Ç–ø–∏—Å–∞ (65 –±–∞—ò—Ç–æ–≤–∞ –∫–æ–º–ø–∞–∫—Ç–Ω–æ)
4. –ü–æ–≤—Ä–∞—Ç–∏ pubkey –∏–∑ –ø–æ—Ç–ø–∏—Å–∞: `pubkey.RecoverCompact(hash, signature)`
5. –í–µ—Ä–∏—Ñ–∏–∫—É—ò –¥–∞ –ø–æ–≤—Ä–∞—õ–µ–Ω–∏ pubkey –æ–¥–≥–æ–≤–∞—Ä–∞ —Å–∫–ª–∞–¥–∏—à—Ç–µ–Ω–æ–º pubkey-—É

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/validation.cpp:CheckBlockHeader()`
**–õ–æ–≥–∏–∫–∞ –ø–æ—Ç–ø–∏—Å–∞:** `src/pocx/consensus/pocx.cpp:VerifyPoCXBlockCompactSignature()`

### –§–∞–∑–∞ 2: –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –±–ª–æ–∫–∞ (CheckBlock)

**–í–∞–ª–∏–¥–∏—Ä–∞:**
- –¢–∞—á–Ω–æ—Å—Ç merkle –∫–æ—Ä–µ–Ω–∞
- –í–∞–ª–∏–¥–Ω–æ—Å—Ç —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞
- –ó–∞—Ö—Ç–µ–≤–∏ coinbase-–∞
- –û–≥—Ä–∞–Ω–∏—á–µ—ö–∞ –≤–µ–ª–∏—á–∏–Ω–µ –±–ª–æ–∫–∞
- –°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞ Bitcoin –ø—Ä–∞–≤–∏–ª–∞ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/consensus/validation.cpp:CheckBlock()`

### –§–∞–∑–∞ 3: –ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –∑–∞–≥–ª–∞–≤—ô–∞ (ContextualCheckBlockHeader)

**PoCX-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞:**

```cpp
#ifdef ENABLE_POCX
    // –ö–æ—Ä–∞–∫ 1: –í–∞–ª–∏–¥–∏—Ä–∞—ò –≥–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–∏ –ø–æ—Ç–ø–∏—Å
    uint256 expected_gen_sig = CalculateGenerationSignature(pindexPrev);
    if (block.generationSignature != expected_gen_sig) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-gen-sig");
    }

    // –ö–æ—Ä–∞–∫ 2: –í–∞–ª–∏–¥–∏—Ä–∞—ò –±–∞–∑–Ω–∏ —Ü–∏—ô
    uint64_t expected_base_target = CalculateNextBaseTarget(pindexPrev, block.nTime);
    if (block.nBaseTarget != expected_base_target) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-diff");
    }

    // –ö–æ—Ä–∞–∫ 3: –í–∞–ª–∏–¥–∏—Ä–∞—ò –¥–æ–∫–∞–∑ –∫–∞–ø–∞—Ü–∏—Ç–µ—Ç–∞
    auto compression_bounds = GetPoCXCompressionBounds(block.nHeight, halving_interval);
    auto result = ValidateProofOfCapacity(
        block.generationSignature,
        block.pocxProof,
        block.nBaseTarget,
        block.nHeight,
        compression_bounds.nPoCXMinCompression,
        compression_bounds.nPoCXTargetCompression,
        block_time
    );

    if (!result.is_valid) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-pocx-proof");
    }

    // –ö–æ—Ä–∞–∫ 4: –í–µ—Ä–∏—Ñ–∏–∫—É—ò –≤—Ä–µ–º–µ —Ä–æ–∫–∞
    uint32_t elapsed_time = block.nTime - pindexPrev->nTime;
    if (result.deadline > elapsed_time) {
        return state.Invalid(BLOCK_INVALID_HEADER, "pocx-deadline-not-met");
    }
#endif
```

**–ö–æ—Ä–∞—Ü–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–µ:**
1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–∏ –ø–æ—Ç–ø–∏—Å:** –ú–æ—Ä–∞ –æ–¥–≥–æ–≤–∞—Ä–∞—Ç–∏ –∏–∑—Ä–∞—á—É–Ω–∞—Ç–æ—ò –≤—Ä–µ–¥–Ω–æ—Å—Ç–∏ –∏–∑ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ–≥ –±–ª–æ–∫–∞
2. **–ë–∞–∑–Ω–∏ —Ü–∏—ô:** –ú–æ—Ä–∞ –æ–¥–≥–æ–≤–∞—Ä–∞—Ç–∏ –∏–∑—Ä–∞—á—É–Ω–∞–≤–∞—ö—É –ø–æ–¥–µ—à–∞–≤–∞—ö–∞ —Ç–µ–∂–∏–Ω–µ
3. **–ù–∏–≤–æ —Å–∫–∞–ª–∏—Ä–∞—ö–∞:** –ú–æ—Ä–∞ –∑–∞–¥–æ–≤–æ—ô–∏—Ç–∏ –º–∏–Ω–∏–º—É–º –º—Ä–µ–∂–µ (`compression >= min_compression`)
4. **–¢–≤—Ä–¥—ö–∞ –∫–≤–∞–ª–∏—Ç–µ—Ç–∞:** –ü—Ä–∏—ò–∞–≤—ô–µ–Ω–∏ –∫–≤–∞–ª–∏—Ç–µ—Ç –º–æ—Ä–∞ –æ–¥–≥–æ–≤–∞—Ä–∞—Ç–∏ –∏–∑—Ä–∞—á—É–Ω–∞—Ç–æ–º –∫–≤–∞–ª–∏—Ç–µ—Ç—É –∏–∑ –¥–æ–∫–∞–∑–∞
5. **–î–æ–∫–∞–∑ –∫–∞–ø–∞—Ü–∏—Ç–µ—Ç–∞:** –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—Å–∫–æ–≥ –¥–æ–∫–∞–∑–∞ (SIMD-–æ–ø—Ç–∏–º–∏–∑–æ–≤–∞–Ω–∞)
6. **–í—Ä–µ–º–µ —Ä–æ–∫–∞:** –†–æ–∫ —Å–∞–≤–∏—ò–µ–Ω –≤—Ä–µ–º–µ–Ω–æ–º (`poc_time`) –º–æ—Ä–∞ –±–∏—Ç–∏ ‚â§ –ø—Ä–æ—Ç–µ–∫–ª–æ–≥ –≤—Ä–µ–º–µ–Ω–∞

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/validation.cpp:ContextualCheckBlockHeader()`

### –§–∞–∑–∞ 4: –ü–æ–≤–µ–∑–∏–≤–∞—ö–µ –±–ª–æ–∫–∞ (ConnectBlock)

**–ü–æ—Ç–ø—É–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞:**

```cpp
#ifdef ENABLE_POCX
    // –ü—Ä–æ—à–∏—Ä–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –ø–æ—Ç–ø–∏—Å–∞ —Å–∞ –ø–æ–¥—Ä—à–∫–æ–º –∑–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ
    if (pindex->nHeight > 0 && !fJustCheck) {
        if (!VerifyPoCXBlockCompactSignature(block, view, pindex->nHeight)) {
            return state.Invalid(BLOCK_CONSENSUS, "bad-pocx-assignment-sig");
        }
    }
#endif
```

**–ü—Ä–æ—à–∏—Ä–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –ø–æ—Ç–ø–∏—Å–∞:**
1. –ò–∑–≤—Ä—à–∏ –æ—Å–Ω–æ–≤–Ω—É –≤–∞–ª–∏–¥–∞—Ü–∏—ò—É –ø–æ—Ç–ø–∏—Å–∞
2. –ò–∑–≤—É—Ü–∏ account ID –∏–∑ –ø–æ–≤—Ä–∞—õ–µ–Ω–æ–≥ pubkey-–∞
3. –î–æ–±–∞–≤–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫–∞ –∑–∞ –∞–¥—Ä–µ—Å—É –ø–ª–æ—Ç–∞: `GetEffectiveSigner(plot_address, height, view)`
4. –í–µ—Ä–∏—Ñ–∏–∫—É—ò –¥–∞ account pubkey-–∞ –æ–¥–≥–æ–≤–∞—Ä–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º –ø–æ—Ç–ø–∏—Å–Ω–∏–∫—É

**–õ–æ–≥–∏–∫–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞:**
```cpp
std::array<uint8_t, 20> GetEffectiveSigner(
    const std::array<uint8_t, 20>& plotAddress,
    int nHeight,
    const CCoinsViewCache& view
) {
    auto assignment = view.GetForgingAssignment(plotAddress, nHeight);

    if (assignment.has_value() && assignment->IsActiveAtHeight(nHeight)) {
        return assignment->forgingAddress;  // –í—Ä–∞—Ç–∏ –¥–æ–¥–µ—ô–µ–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫–∞
    }

    return plotAddress;  // –ù–µ–º–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ - –≤–ª–∞—Å–Ω–∏–∫ –ø–ª–æ—Ç–∞ –ø–æ—Ç–ø–∏—Å—É—ò–µ
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:**
- –ü–æ–≤–µ–∑–∏–≤–∞—ö–µ: `src/validation.cpp:ConnectBlock()`
- –ü—Ä–æ—à–∏—Ä–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞: `src/pocx/consensus/pocx.cpp:VerifyPoCXBlockCompactSignature()`
- –õ–æ–≥–∏–∫–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞: `src/pocx/consensus/validation.cpp:GetEffectiveSigner()`

### –§–∞–∑–∞ 5: –ê–∫—Ç–∏–≤–∞—Ü–∏—ò–∞ –ª–∞–Ω—Ü–∞

**–¢–æ–∫ ProcessNewBlock:**
```cpp
bool ProcessNewBlock(const std::shared_ptr<const CBlock>& block,
                    bool force_processing,
                    bool min_pow_checked,
                    bool* new_block)
{
    1. AcceptBlock ‚Üí –í–∞–ª–∏–¥–∏—Ä–∞—ò –∏ —Å–∞—á—É–≤–∞—ò –Ω–∞ –¥–∏—Å–∫
    2. ActivateBestChain ‚Üí –ê–∂—É—Ä–∏—Ä–∞—ò –≤—Ä—Ö –ª–∞–Ω—Ü–∞ –∞–∫–æ —ò–µ –æ–≤–æ –Ω–∞—ò–±–æ—ô–∏ –ª–∞–Ω–∞—Ü
    3. –û–±–∞–≤–µ—Å—Ç–∏ –º—Ä–µ–∂—É –æ –Ω–æ–≤–æ–º –±–ª–æ–∫—É
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/validation.cpp:ProcessNewBlock()`

### –†–µ–∑–∏–º–µ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–µ

**–ö–æ–º–ø–ª–µ—Ç–Ω–∞ –ø—É—Ç–∞—ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–µ:**
```
–ü—Ä–∏–º–∏ –±–ª–æ–∫
    ‚Üì
CheckBlockHeader (–æ—Å–Ω–æ–≤–Ω–∏ –ø–æ—Ç–ø–∏—Å)
    ‚Üì
CheckBlock (—Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ, merkle)
    ‚Üì
ContextualCheckBlockHeader (gen sig, base target, PoC –¥–æ–∫–∞–∑, —Ä–æ–∫)
    ‚Üì
ConnectBlock (–ø—Ä–æ—à–∏—Ä–µ–Ω–∏ –ø–æ—Ç–ø–∏—Å —Å–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∏–º–∞, –ø—Ä–µ–ª–∞–∑–∏ —Å—Ç–∞—ö–∞)
    ‚Üì
ActivateBestChain (—Ä—É–∫–æ–≤–∞—ö–µ —Ä–µ–æ—Ä–≥–æ–º, –ø—Ä–æ–¥—É–∂–µ—ö–µ –ª–∞–Ω—Ü–∞)
    ‚Üì
–ú—Ä–µ–∂–Ω–æ —à–∏—Ä–µ—ö–µ
```

---

## –°–∏—Å—Ç–µ–º –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞

### –ü—Ä–µ–≥–ª–µ–¥

–î–æ–¥–µ—ô–∏–≤–∞—ö–∞ –æ–º–æ–≥—É—õ–∞–≤–∞—ò—É –≤–ª–∞—Å–Ω–∏—Ü–∏–º–∞ –ø–ª–æ—Ç–æ–≤–∞ –¥–∞ –¥–µ–ª–µ–≥–∏—Ä–∞—ò—É –ø—Ä–∞–≤–∞ –∫–æ–≤–∞—ö–∞ –¥—Ä—É–≥–∏–º –∞–¥—Ä–µ—Å–∞–º–∞ –¥–æ–∫ –∑–∞–¥—Ä–∂–∞–≤–∞—ò—É –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ –Ω–∞–¥ –ø–ª–æ—Ç–æ–º.

**–°–ª—É—á–∞—ò–µ–≤–∏ —É–ø–æ—Ç—Ä–µ–±–µ:**
- –†—É–¥–∞—Ä–µ—ö–µ —É –ø—É–ª—É (–ø–ª–æ—Ç–æ–≤–∏ —Å–µ –¥–æ–¥–µ—ô—É—ò—É –∞–¥—Ä–µ—Å–∏ –ø—É–ª–∞)
- –•–ª–∞–¥–Ω–æ —Å–∫–ª–∞–¥–∏—à—Ç–µ—ö–µ (–∫—ô—É—á –∑–∞ —Ä—É–¥–∞—Ä–µ—ö–µ –æ–¥–≤–æ—ò–µ–Ω –æ–¥ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–∞ –Ω–∞–¥ –ø–ª–æ—Ç–æ–º)
- –í–∏—à–µ—Å—Ç—Ä–∞–Ω–∞—á–∫–æ —Ä—É–¥–∞—Ä–µ—ö–µ (–¥–µ—ô–µ–Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞

**–î–∏–∑–∞—ò–Ω –∏—Å–∫—ô—É—á–∏–≤–æ –Ω–∞ OP_RETURN:**
- –î–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Å–∫–ª–∞–¥–∏—à—Ç–µ–Ω–∞ —É OP_RETURN –∏–∑–ª–∞–∑–∏–º–∞ (–±–µ–∑ UTXO)
- –ë–µ–∑ –∑–∞—Ö—Ç–µ–≤–∞ –∑–∞ —Ç—Ä–æ—à–µ—ö–µ (–±–µ–∑ –ø—Ä–∞—à–∏–Ω–µ, –±–µ–∑ –Ω–∞–∫–Ω–∞–¥–∞ –∑–∞ –¥—Ä–∂–∞—ö–µ)
- –ü—Ä–∞—õ–µ–Ω–æ —É –ø—Ä–æ—à–∏—Ä–µ–Ω–æ–º —Å—Ç–∞—ö—É CCoinsViewCache
- –ê–∫—Ç–∏–≤–∏—Ä–∞–Ω–æ –Ω–∞–∫–æ–Ω –ø–µ—Ä–∏–æ–¥–∞ –∫–∞—à—ö–µ—ö–∞ (–ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–Ω–æ: 4 –±–ª–æ–∫–∞)

**–°—Ç–∞—ö–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞:**
```cpp
enum class ForgingState : uint8_t {
    UNASSIGNED = 0,  // –ù–µ–º–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞
    ASSIGNING = 1,   // –î–æ–¥–µ—ô–∏–≤–∞—ö–µ —á–µ–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏—ò—É (–ø–µ—Ä–∏–æ–¥ –∫–∞—à—ö–µ—ö–∞)
    ASSIGNED = 2,    // –î–æ–¥–µ—ô–∏–≤–∞—ö–µ –∞–∫—Ç–∏–≤–Ω–æ, –∫–æ–≤–∞—ö–µ –¥–æ–∑–≤–æ—ô–µ–Ω–æ
    REVOKING = 3,    // –û–ø–æ–∑–∏–≤ —É —Ç–æ–∫—É (–ø–µ—Ä–∏–æ–¥ –∫–∞—à—ö–µ—ö–∞, —ò–æ—à —É–≤–µ–∫ –∞–∫—Ç–∏–≤–Ω–æ)
    REVOKED = 4      // –û–ø–æ–∑–∏–≤ –∑–∞–≤—Ä—à–µ–Ω, –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ –≤–∏—à–µ –Ω–∏—ò–µ –∞–∫—Ç–∏–≤–Ω–æ
};
```

### –ö—Ä–µ–∏—Ä–∞—ö–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞

**–§–æ—Ä–º–∞—Ç —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ:**
```cpp
Transaction {
    inputs: [any]  // –î–æ–∫–∞–∑—É—ò–µ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ –Ω–∞–¥ –∞–¥—Ä–µ—Å–æ–º –ø–ª–æ—Ç–∞
    outputs: [
        OP_RETURN <ASSIGN_MAGIC> <plot_address> <forging_address>
    ]
}
```

**–ü—Ä–∞–≤–∏–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–µ:**
1. –£–ª–∞–∑ –º–æ—Ä–∞ –±–∏—Ç–∏ –ø–æ—Ç–ø–∏—Å–∞–Ω –æ–¥ —Å—Ç—Ä–∞–Ω–µ –≤–ª–∞—Å–Ω–∏–∫–∞ –ø–ª–æ—Ç–∞ (–¥–æ–∫–∞–∑—É—ò–µ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ)
2. OP_RETURN —Å–∞–¥—Ä–∂–∏ –≤–∞–ª–∏–¥–Ω–µ –ø–æ–¥–∞—Ç–∫–µ –æ –¥–æ–¥–µ—ô–∏–≤–∞—ö—É
3. –ü–ª–æ—Ç –º–æ—Ä–∞ –±–∏—Ç–∏ UNASSIGNED –∏–ª–∏ REVOKED
4. –ë–µ–∑ –¥—É–ø–ª–∏—Ä–∞–Ω–∏—Ö –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ —É mempool-—É –∫–æ—ò–∞ —á–µ–∫–∞—ò—É
5. –ú–∏–Ω–∏–º–∞–ª–Ω–∞ –Ω–∞–∫–Ω–∞–¥–∞ –∑–∞ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò—É –ø–ª–∞—õ–µ–Ω–∞

**–ê–∫—Ç–∏–≤–∞—Ü–∏—ò–∞:**
- –î–æ–¥–µ—ô–∏–≤–∞—ö–µ –ø–æ—Å—Ç–∞—ò–µ ASSIGNING –ø—Ä–∏ –ø–æ—Ç–≤—Ä–¥–∏
- –ü–æ—Å—Ç–∞—ò–µ ASSIGNED –Ω–∞–∫–æ–Ω –ø–µ—Ä–∏–æ–¥–∞ –∫–∞—à—ö–µ—ö–∞ (4 –±–ª–æ–∫–∞ regtest, 30 –±–ª–æ–∫–æ–≤–∞ mainnet)
- –ö–∞—à—ö–µ—ö–µ —Å–ø—Ä–µ—á–∞–≤–∞ –±—Ä–∑–æ –ø–æ–Ω–æ–≤–Ω–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ —Ç–æ–∫–æ–º —Ç—Ä–∫–∞ –±–ª–æ–∫–æ–≤–∞

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** `src/script/forging_assignment.h`, –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ —É ConnectBlock

### –û–ø–æ–∑–∏–≤–∞—ö–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞

**–§–æ—Ä–º–∞—Ç —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ:**
```cpp
Transaction {
    inputs: [any]  // –î–æ–∫–∞–∑—É—ò–µ –≤–ª–∞—Å–Ω–∏—à—Ç–≤–æ –Ω–∞–¥ –∞–¥—Ä–µ—Å–æ–º –ø–ª–æ—Ç–∞
    outputs: [
        OP_RETURN <REVOKE_MAGIC> <plot_address>
    ]
}
```

**–ï—Ñ–µ–∫–∞—Ç:**
- –¢—Ä–µ–Ω—É—Ç–Ω–∏ –ø—Ä–µ–ª–∞–∑ —Å—Ç–∞—ö–∞ —É REVOKED
- –í–ª–∞—Å–Ω–∏–∫ –ø–ª–æ—Ç–∞ –º–æ–∂–µ –æ–¥–º–∞—Ö –∫–æ–≤–∞—Ç–∏
- –ú–æ–∂–µ –∫—Ä–µ–∏—Ä–∞—Ç–∏ –Ω–æ–≤–æ –¥–æ–¥–µ—ô–∏–≤–∞—ö–µ –ø–æ—Å–ª–µ

### –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ —Ç–æ–∫–æ–º —Ä—É–¥–∞—Ä–µ—ö–∞

**–û–¥—Ä–µ—í–∏–≤–∞—ö–µ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫–∞:**
```cpp
// –£ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∏ submit_nonce
effective_signer = GetEffectiveSigner(plot_address, height, view);
if (!HaveAccountKey(effective_signer, wallet)) reject;

// –£ –∫–æ–≤–∞—ö—É –±–ª–æ–∫–∞
coinbase_script = P2WPKH(effective_signer);  // –ù–∞–≥—Ä–∞–¥–∞ –∏–¥–µ –æ–≤–¥–µ

// –£ –ø–æ—Ç–ø–∏—Å—É –±–ª–æ–∫–∞
signature = effective_signer_key.SignCompact(hash);  // –ú–æ—Ä–∞ –ø–æ—Ç–ø–∏—Å–∞—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫
```

**–í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –±–ª–æ–∫–∞:**
```cpp
// –£ VerifyPoCXBlockCompactSignature (–ø—Ä–æ—à–∏—Ä–µ–Ω–æ)
effective_signer = GetEffectiveSigner(proof.account_id, height, view);
pubkey_account = ExtractAccountIDFromPubKey(block.vchPubKey);
if (pubkey_account != effective_signer) reject;
```

**–ö—ô—É—á–Ω–µ –æ—Å–æ–±–∏–Ω–µ:**
- –î–æ–∫–∞–∑ —É–≤–µ–∫ —Å–∞–¥—Ä–∂–∏ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω—É –∞–¥—Ä–µ—Å—É –ø–ª–æ—Ç–∞
- –ü–æ—Ç–ø–∏—Å –º–æ—Ä–∞ –±–∏—Ç–∏ –æ–¥ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–Ω–∏–∫–∞
- Coinbase –ø–ª–∞—õ–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º –ø–æ—Ç–ø–∏—Å–Ω–∏–∫—É
- –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –∫–æ—Ä–∏—Å—Ç–∏ —Å—Ç–∞—ö–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞ –Ω–∞ –≤–∏—Å–∏–Ω–∏ –±–ª–æ–∫–∞

---

## –ú—Ä–µ–∂–Ω–æ —à–∏—Ä–µ—ö–µ

### –û–±—ò–∞–≤—ô–∏–≤–∞—ö–µ –±–ª–æ–∫–∞

**–°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∏ Bitcoin P2P –ø—Ä–æ—Ç–æ–∫–æ–ª:**
1. –ò—Å–∫–æ–≤–∞–Ω–∏ –±–ª–æ–∫ –ø–æ—Å–ª–∞—Ç –ø—Ä–µ–∫–æ `ProcessNewBlock()`
2. –ë–ª–æ–∫ –≤–∞–ª–∏–¥–∏—Ä–∞–Ω –∏ –¥–æ–¥–∞—Ç —É –ª–∞–Ω–∞—Ü
3. –ú—Ä–µ–∂–Ω–æ –æ–±–∞–≤–µ—à—Ç–µ—ö–µ: `GetMainSignals().BlockConnected()`
4. P2P —Å–ª–æ—ò –µ–º–∏—Ç—É—ò–µ –±–ª–æ–∫ –ø–∏—Ä–æ–≤–∏–º–∞

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:** –°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞ Bitcoin Core net_processing

### –†–µ–ª–µ—ò –±–ª–æ–∫–æ–≤–∞

**–ö–æ–º–ø–∞–∫—Ç–Ω–∏ –±–ª–æ–∫–æ–≤–∏ (BIP 152):**
- –ö–æ—Ä–∏—Å—Ç–µ —Å–µ –∑–∞ –µ—Ñ–∏–∫–∞—Å–Ω–æ —à–∏—Ä–µ—ö–µ –±–ª–æ–∫–æ–≤–∞
- –°–∞–º–æ ID-–æ–≤–∏ —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–∞ —Å–µ —à–∞—ô—É –∏–Ω–∏—Ü–∏—ò–∞–ª–Ω–æ
- –ü–∏—Ä–æ–≤–∏ –∑–∞—Ö—Ç–µ–≤–∞—ò—É —Ç—Ä–∞–Ω—Å–∞–∫—Ü–∏—ò–µ –∫–æ—ò–µ –Ω–µ–¥–æ—Å—Ç–∞—ò—É

**–†–µ–ª–µ—ò –ø—É–Ω–∏—Ö –±–ª–æ–∫–æ–≤–∞:**
- –†–µ–∑–µ—Ä–≤–Ω–∞ –æ–ø—Ü–∏—ò–∞ –∫–∞–¥–∞ –∫–æ–º–ø–∞–∫—Ç–Ω–∏ –±–ª–æ–∫–æ–≤–∏ –Ω–µ —É—Å–ø–µ—ò—É
- –ü—Ä–µ–Ω–æ—Å–µ —Å–µ –∫–æ–º–ø–ª–µ—Ç–Ω–∏ –ø–æ–¥–∞—Ü–∏ –±–ª–æ–∫–∞

### –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–µ –ª–∞–Ω—Ü–∞

**–†—É–∫–æ–≤–∞—ö–µ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–æ–º:**
```cpp
// –£ —Ä–∞–¥–Ω–æ—ò –Ω–∏—Ç–∏ –∫–æ–≤–∞—á–∞
if (current_tip_hash != stored_tip_hash) {
    // –î–µ—Ç–µ–∫—Ç–æ–≤–∞–Ω–∞ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–∞ –ª–∞–Ω—Ü–∞
    reset_forging_state();
    log("–í—Ä—Ö –ª–∞–Ω—Ü–∞ –ø—Ä–æ–º–µ—ö–µ–Ω, —Ä–µ—Å–µ—Ç—É—ò–µ–º –∫–æ–≤–∞—ö–µ");
}
```

**–ù–∞ –Ω–∏–≤–æ—É –±–ª–æ–∫—á–µ—ò–Ω–∞:**
- –°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–æ Bitcoin Core —Ä—É–∫–æ–≤–∞—ö–µ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–æ–º
- –ù–∞—ò–±–æ—ô–∏ –ª–∞–Ω–∞—Ü –æ–¥—Ä–µ—í–µ–Ω chainwork-–æ–º
- –ò—Å–∫—ô—É—á–µ–Ω–∏ –±–ª–æ–∫–æ–≤–∏ –≤—Ä–∞—õ–µ–Ω–∏ —É mempool

---

## –¢–µ—Ö–Ω–∏—á–∫–∏ –¥–µ—Ç–∞—ô–∏

### –ü—Ä–µ–≤–µ–Ω—Ü–∏—ò–∞ –º—Ä—Ç–≤–µ –ø–µ—Ç—ô–µ

**ABBA –æ–±—Ä–∞–∑–∞—Ü –º—Ä—Ç–≤–µ –ø–µ—Ç—ô–µ (—Å–ø—Ä–µ—á–µ–Ω):**
```
–ù–∏—Ç A: cs_main ‚Üí cs_wallet
–ù–∏—Ç B: cs_wallet ‚Üí cs_main
```

**–†–µ—à–µ—ö–µ:**
1. **submit_nonce:** –ë–µ–∑ —É–ø–æ—Ç—Ä–µ–±–µ cs_main
   - `GetNewBlockContext()` —Ä—É–∫—É—ò–µ –∑–∞–∫—ô—É—á–∞–≤–∞—ö–µ–º –∏–Ω—Ç–µ—Ä–Ω–æ
   - –°–≤–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –ø—Ä–µ —Å–ª–∞—ö–∞ –∫–æ–≤–∞—á—É

2. **–ö–æ–≤–∞—á:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∑–∞—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ —Ä–µ–¥—É —á–µ–∫–∞—ö–∞
   - –à–µ–¥–Ω–∞ —Ä–∞–¥–Ω–∞ –Ω–∏—Ç (–±–µ–∑ —Å–ø–∞—ò–∞—ö–∞ –Ω–∏—Ç–∏)
   - –°–≤–µ–∂ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏ —Å–≤–∞–∫–æ–º –ø—Ä–∏—Å—Ç—É–ø—É
   - –ë–µ–∑ —É–≥–Ω–µ–∂—í–µ–Ω–∏—Ö –∑–∞–∫—ô—É—á–∞–≤–∞—ö–∞

3. **–ü—Ä–æ–≤–µ—Ä–µ –Ω–æ–≤—á–∞–Ω–∏–∫–∞:** –ò–∑–≤—Ä—à–∞–≤–∞—ò—É —Å–µ –ø—Ä–µ —Å–∫—É–ø–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—ò–∞
   - –†–∞–Ω–æ –æ–¥–±–∞—Ü–∏–≤–∞—ö–µ –∞–∫–æ –∫—ô—É—á –Ω–∏—ò–µ –¥–æ—Å—Ç—É–ø–∞–Ω
   - –û–¥–≤–æ—ò–µ–Ω–æ –æ–¥ –ø—Ä–∏—Å—Ç—É–ø–∞ —Å—Ç–∞—ö—É –±–ª–æ–∫—á–µ—ò–Ω–∞

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—ò–µ –ø–µ—Ä—Ñ–æ—Ä–º–∞–Ω—Å–∏

**–í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ —Å–∞ –±—Ä–∑–∏–º –Ω–µ—É—Å–ø–µ—Ö–æ–º:**
```cpp
1. –ü—Ä–æ–≤–µ—Ä–µ —Ñ–æ—Ä–º–∞—Ç–∞ (—Ç—Ä–µ–Ω—É—Ç–Ω–æ)
2. –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–ª–∞–≥–∞–Ω–∞)
3. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—ò–∞ –Ω–æ–≤—á–∞–Ω–∏–∫–∞ (–ª–æ–∫–∞–ª–Ω–∞)
4. –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –¥–æ–∫–∞–∑–∞ (—Å–∫—É–ø–∞ SIMD)
```

**–à–µ–¥–Ω–æ –ø—Ä–µ—É–∑–∏–º–∞—ö–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
- –à–µ–¥–∞–Ω –ø–æ–∑–∏–≤ `GetNewBlockContext()` –ø–æ —Å–ª–∞—ö—É
- –ö–µ—à–∏—Ä–∞—ö–µ —Ä–µ–∑—É–ª—Ç–∞—Ç–∞ –∑–∞ –≤–∏—à–µ –ø—Ä–æ–≤–µ—Ä–∞
- –ë–µ–∑ –ø–æ–Ω–æ–≤—ô–µ–Ω–∏—Ö –ø—Ä–µ—É–∑–∏–º–∞—ö–∞ cs_main

**–ï—Ñ–∏–∫–∞—Å–Ω–æ—Å—Ç —Ä–µ–¥–∞ —á–µ–∫–∞—ö–∞:**
- –õ–∞–≥–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–ª–∞—ö–∞
- –ë–µ–∑ base_target/deadline —É —Ä–µ–¥—É —á–µ–∫–∞—ö–∞ (–ø—Ä–µ—Ä–∞—á—É–Ω–∞–≤–∞ —Å–µ —Å–≤–µ–∂–µ)
- –ú–∏–Ω–∏–º–∞–ª–Ω–∏ –º–µ–º–æ—Ä–∏—ò—Å–∫–∏ –æ—Ç–∏—Å–∞–∫

### –†—É–∫–æ–≤–∞—ö–µ –∑–∞—Å—Ç–∞—Ä–µ–ª–æ—à—õ—É

**‚Äû–ì–ª—É–ø" –¥–∏–∑–∞—ò–Ω –∫–æ–≤–∞—á–∞:**
- –ë–µ–∑ –ø—Ä–µ—Ç–ø–ª–∞—Ç–∞ –Ω–∞ –¥–æ–≥–∞—í–∞—ò–µ –±–ª–æ–∫—á–µ—ò–Ω–∞
- –õ–µ—ö–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –∫–∞–¥–∞ —ò–µ –ø–æ—Ç—Ä–µ–±–Ω–∞
- –¢–∏—Ö–∞ –æ–¥–±–∞—Ü–∏–≤–∞—ö–∞ –∑–∞—Å—Ç–∞—Ä–µ–ª–∏—Ö —Å–ª–∞—ö–∞

**–ü—Ä–µ–¥–Ω–æ—Å—Ç–∏:**
- –à–µ–¥–Ω–æ—Å—Ç–∞–≤–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ë–µ–∑ —Å–ª–æ–∂–µ–Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—ò–µ
- –†–æ–±—É—Å—Ç–Ω–æ –ø—Ä–æ—Ç–∏–≤ –≥—Ä–∞–Ω–∏—á–Ω–∏—Ö —Å–ª—É—á–∞—ò–µ–≤–∞

**–†—É–∫–æ–≤–∞—ö–µ –≥—Ä–∞–Ω–∏—á–Ω–∏–º —Å–ª—É—á–∞—ò–µ–≤–∏–º–∞:**
- –ü—Ä–æ–º–µ–Ω–µ –≤–∏—Å–∏–Ω–µ ‚Üí –æ–¥–±–∞—Ü–∏
- –ü—Ä–æ–º–µ–Ω–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–æ–≥ –ø–æ—Ç–ø–∏—Å–∞ ‚Üí –æ–¥–±–∞—Ü–∏
- –ü—Ä–æ–º–µ–Ω–µ –±–∞–∑–Ω–æ–≥ —Ü–∏—ô–∞ ‚Üí –ø—Ä–µ—Ä–∞—á—É–Ω–∞—ò —Ä–æ–∫
- –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—ò–µ ‚Üí —Ä–µ—Å–µ—Ç—É—ò —Å—Ç–∞—ö–µ –∫–æ–≤–∞—ö–∞

### –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—Å–∫–∏ –¥–µ—Ç–∞—ô–∏

**–ì–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–∏ –ø–æ—Ç–ø–∏—Å:**
```cpp
SHA256(prev_generation_signature || prev_miner_pubkey_33bytes)
```

**–•–µ—à –ø–æ—Ç–ø–∏—Å–∞ –±–ª–æ–∫–∞:**
```cpp
hash = SHA256(SHA256("POCX Signed Block:\n" || block_hash_hex))
```

**–§–æ—Ä–º–∞—Ç –∫–æ–º–ø–∞–∫—Ç–Ω–æ–≥ –ø–æ—Ç–ø–∏—Å–∞:**
- 65 –±–∞—ò—Ç–æ–≤–∞: [recovery_id][r][s]
- –û–º–æ–≥—É—õ–∞–≤–∞ –ø–æ–≤—Ä–∞—Ç —ò–∞–≤–Ω–æ–≥ –∫—ô—É—á–∞
- –ö–æ—Ä–∏—Å—Ç–∏ —Å–µ —Ä–∞–¥–∏ –µ—Ñ–∏–∫–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å—Ç–æ—Ä–∞

**Account ID:**
- 20-–±–∞—ò—Ç–Ω–∏ HASH160 –∫–æ–º–ø—Ä–µ—Å–æ–≤–∞–Ω–æ–≥ —ò–∞–≤–Ω–æ–≥ –∫—ô—É—á–∞
- –û–¥–≥–æ–≤–∞—Ä–∞ Bitcoin —Ñ–æ—Ä–º–∞—Ç–∏–º–∞ –∞–¥—Ä–µ—Å–∞ (P2PKH, P2WPKH)

### –ë—É–¥—É—õ–∞ —É–Ω–∞–ø—Ä–µ—í–µ—ö–∞

**–î–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω–∞ –æ–≥—Ä–∞–Ω–∏—á–µ—ö–∞:**
1. –ë–µ–∑ –º–µ—Ç—Ä–∏–∫–∞ –ø–µ—Ä—Ñ–æ—Ä–º–∞–Ω—Å–∏ (—Å—Ç–æ–ø–µ —Å–ª–∞—ö–∞, –¥–∏—Å—Ç—Ä–∏–±—É—Ü–∏—ò–µ —Ä–æ–∫–æ–≤–∞)
2. –ë–µ–∑ –¥–µ—Ç–∞—ô–Ω–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—ò–µ –≥—Ä–µ—à–∞–∫–∞ –∑–∞ —Ä—É–¥–∞—Ä–µ
3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ —É–ø–∏—Ç–∏–≤–∞—ö–µ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–≤–∞—á–∞ (—Ç—Ä–µ–Ω—É—Ç–Ω–∏ —Ä–æ–∫, –¥—É–±–∏–Ω–∞ —Ä–µ–¥–∞ —á–µ–∫–∞—ö–∞)

**–ü–æ—Ç–µ–Ω—Ü–∏—ò–∞–ª–Ω–∞ –ø–æ–±–æ—ô—à–∞—ö–∞:**
- RPC –∑–∞ —Å—Ç–∞—Ç—É—Å –∫–æ–≤–∞—á–∞
- –ú–µ—Ç—Ä–∏–∫–µ –∑–∞ –µ—Ñ–∏–∫–∞—Å–Ω–æ—Å—Ç —Ä—É–¥–∞—Ä–µ—ö–∞
- –ü–æ–±–æ—ô—à–∞–Ω–æ –ª–æ–≥–æ–≤–∞—ö–µ –∑–∞ –æ—Ç–∫–ª–∞—ö–∞—ö–µ –≥—Ä–µ—à–∞–∫–∞
- –ü–æ–¥—Ä—à–∫–∞ –∑–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª –ø—É–ª–æ–≤–∞

---

## –†–µ—Ñ–µ—Ä–µ–Ω—Ü–µ –∫–æ–¥–∞

**–û—Å–Ω–æ–≤–Ω–µ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–µ:**
- RPC –∏–Ω—Ç–µ—Ä—Ñ–µ—ò—Å: `src/pocx/rpc/mining.cpp`
- –†–µ–¥ —á–µ–∫–∞—ö–∞ –∫–æ–≤–∞—á–∞: `src/pocx/mining/scheduler.cpp`
- –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞: `src/pocx/consensus/validation.cpp`
- –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –¥–æ–∫–∞–∑–∞: `src/pocx/consensus/pocx.cpp`
- –°–∞–≤–∏—ò–∞—ö–µ –≤—Ä–µ–º–µ–Ω–∞: `src/pocx/algorithms/time_bending.cpp`
- –í–∞–ª–∏–¥–∞—Ü–∏—ò–∞ –±–ª–æ–∫–∞: `src/validation.cpp` (CheckBlockHeader, ConnectBlock)
- –õ–æ–≥–∏–∫–∞ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞: `src/pocx/consensus/validation.cpp:GetEffectiveSigner()`
- –£–ø—Ä–∞–≤—ô–∞—ö–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º: `src/pocx/node/node.cpp:GetNewBlockContext()`

**–°—Ç—Ä—É–∫—Ç—É—Ä–µ –ø–æ–¥–∞—Ç–∞–∫–∞:**
- –§–æ—Ä–º–∞—Ç –±–ª–æ–∫–∞: `src/primitives/block.h`
- –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞: `src/consensus/params.h`
- –ü—Ä–∞—õ–µ—ö–µ –¥–æ–¥–µ—ô–∏–≤–∞—ö–∞: `src/coins.h` (–ø—Ä–æ—à–∏—Ä–µ—ö–∞ CCoinsViewCache)

---

## –î–æ–¥–∞—Ç–∞–∫: –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—ò–µ –∞–ª–≥–æ—Ä–∏—Ç–∞–º–∞

### –§–æ—Ä–º—É–ª–∞ —Å–∞–≤–∏—ò–∞—ö–∞ –≤—Ä–µ–º–µ–Ω–∞

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–∫–∞ –¥–µ—Ñ–∏–Ω–∏—Ü–∏—ò–∞:**
```
deadline_seconds = quality / base_target  (—Å–∏—Ä–æ–≤–æ)

time_bended_deadline = scale * (deadline_seconds)^(1/3)

–≥–¥–µ:
  scale = block_time / (cbrt(block_time) * Gamma(4/3))
  Gamma(4/3) ‚âà 0.892979511
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò–∞:**
- –ê—Ä–∏—Ç–º–µ—Ç–∏–∫–∞ —Å–∞ —Ñ–∏–∫—Å–Ω–æ–º —Ç–∞—á–∫–æ–º (Q42 —Ñ–æ—Ä–º–∞—Ç)
- –ò–∑—Ä–∞—á—É–Ω–∞–≤–∞—ö–µ –∫—É–±–Ω–æ–≥ –∫–æ—Ä–µ–Ω–∞ —Å–∞–º–æ —Ü–µ–ª–∏–º –±—Ä–æ—ò–µ–≤–∏–º–∞
- –û–ø—Ç–∏–º–∏–∑–æ–≤–∞–Ω–æ –∑–∞ 256-–±–∏—Ç–Ω—É –∞—Ä–∏—Ç–º–µ—Ç–∏–∫—É

### –ò–∑—Ä–∞—á—É–Ω–∞–≤–∞—ö–µ –∫–≤–∞–ª–∏—Ç–µ—Ç–∞

**–ü—Ä–æ—Ü–µ—Å:**
1. –ì–µ–Ω–µ—Ä–∏—à–∏ scoop –∏–∑ –≥–µ–Ω–µ—Ä–∞—Ü–∏—ò—Å–∫–æ–≥ –ø–æ—Ç–ø–∏—Å–∞ –∏ –≤–∏—Å–∏–Ω–µ
2. –ü—Ä–æ—á–∏—Ç–∞—ò –ø–æ–¥–∞—Ç–∫–µ –ø–ª–æ—Ç–∞ –∑–∞ –∏–∑—Ä–∞—á—É–Ω–∞—Ç–∏ scoop
3. –•–µ—à: `SHABAL256(generation_signature || scoop_data)`
4. –¢–µ—Å—Ç–∏—Ä–∞—ò –Ω–∏–≤–æ–µ —Å–∫–∞–ª–∏—Ä–∞—ö–∞ –æ–¥ min –¥–æ max
5. –í—Ä–∞—Ç–∏ –Ω–∞—ò–±–æ—ô–∏ –ø—Ä–æ–Ω–∞—í–µ–Ω–∏ –∫–≤–∞–ª–∏—Ç–µ—Ç

**–°–∫–∞–ª–∏—Ä–∞—ö–µ:**
- –ù–∏–≤–æ X0: POC2 –æ—Å–Ω–æ–≤–∞ (—Ç–µ–æ—Ä–∏—ò—Å–∫–∏)
- –ù–∏–≤–æ X1: XOR-transpose –æ—Å–Ω–æ–≤–∞
- –ù–∏–≤–æ Xn: 2^(n-1) √ó X1 —Ä–∞–¥ —É–≥—Ä–∞—í–µ–Ω
- –í–µ—õ–µ —Å–∫–∞–ª–∏—Ä–∞—ö–µ = –≤–∏—à–µ —Ä–∞–¥–∞ –≥–µ–Ω–µ—Ä–∏—Å–∞—ö–∞ –ø–ª–æ—Ç–∞

### –ü–æ–¥–µ—à–∞–≤–∞—ö–µ –±–∞–∑–Ω–æ–≥ —Ü–∏—ô–∞

**–ü–æ–¥–µ—à–∞–≤–∞—ö–µ –Ω–∞ —Å–≤–∞–∫–æ–º –±–ª–æ–∫—É:**
1. –ò–∑—Ä–∞—á—É–Ω–∞—ò –ø–æ–∫—Ä–µ—Ç–Ω–∏ –ø—Ä–æ—Å–µ–∫ –Ω–µ–¥–∞–≤–Ω–∏—Ö –±–∞–∑–Ω–∏—Ö —Ü–∏—ô–µ–≤–∞
2. –ò–∑—Ä–∞—á—É–Ω–∞—ò —Å—Ç–≤–∞—Ä–Ω–∏ –≤—Ä–µ–º–µ–Ω—Å–∫–∏ —Ä–∞—Å–ø–æ–Ω —É –æ–¥–Ω–æ—Å—É –Ω–∞ —Ü–∏—ô–∞–Ω–∏ –∑–∞ –∫–ª–∏–∑–Ω–∏ –ø—Ä–æ–∑–æ—Ä
3. –ü–æ–¥–µ—Å–∏ –±–∞–∑–Ω–∏ —Ü–∏—ô –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–Ω–æ
4. –û–≥—Ä–∞–Ω–∏—á–∏ –¥–∞ —Å–ø—Ä–µ—á–∏ –µ–∫—Å—Ç—Ä–µ–º–Ω–µ –ø—Ä–æ–º–µ–Ω–µ

**–§–æ—Ä–º—É–ª–∞:**
```
avg_base_target = moving_average(–Ω–µ–¥–∞–≤–Ω–∏ –±–∞–∑–Ω–∏ —Ü–∏—ô–µ–≤–∏)
adjustment_factor = actual_timespan / target_timespan
new_base_target = avg_base_target * adjustment_factor
new_base_target = clamp(new_base_target, min, max)
```

---

*–û–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—ò–∞ –æ–¥—Ä–∞–∂–∞–≤–∞ –∫–æ–º–ø–ª–µ—Ç–Ω—É –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—ò—É PoCX –∫–æ–Ω—Å–µ–Ω–∑—É—Å–∞ –æ–¥ –æ–∫—Ç–æ–±—Ä–∞ 2025.*

---

[‚Üê –ü—Ä–µ—Ç—Ö–æ–¥–Ω–æ: –§–æ—Ä–º–∞—Ç –ø–ª–æ—Ç–æ–≤–∞](2-plot-format.md) | [üìò –°–∞–¥—Ä–∂–∞—ò](index.md) | [–°–ª–µ–¥–µ—õ–µ: –î–æ–¥–µ—ô–∏–≤–∞—ö–∞ –∫–æ–≤–∞—ö–∞ ‚Üí](4-forging-assignments.md)
