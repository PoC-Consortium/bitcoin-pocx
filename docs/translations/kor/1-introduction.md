[목차](index.md) | [다음: 플롯 형식 ->](2-plot-format.md)

---

# 1장: 소개 및 개요

## Bitcoin-PoCX란?

Bitcoin-PoCX는 **차세대 용량 증명(Proof of Capacity neXt generation, PoCX)** 합의 메커니즘을 지원하는 Bitcoin Core 통합 프로젝트입니다. 이 프로젝트는 Bitcoin Core의 기존 아키텍처를 유지하면서 작업 증명을 완전히 대체하는 에너지 효율적인 용량 증명 채굴 방식을 가능하게 합니다.

**핵심 구분**: 이것은 Bitcoin PoW와 역호환성이 없는 **새로운 체인**입니다. PoCX 블록은 설계상 PoW 노드와 호환되지 않습니다.

---

## 프로젝트 정보

- **조직**: Proof of Capacity Consortium
- **프로젝트명**: Bitcoin-PoCX
- **정식 명칭**: Bitcoin Core with PoCX Integration
- **상태**: 테스트넷 단계

---

## 용량 증명이란?

용량 증명(PoC)은 채굴력이 계산 능력이 아닌 **디스크 공간**에 비례하는 합의 메커니즘입니다. 채굴자들은 암호화 해시를 포함하는 대용량 플롯 파일을 미리 생성한 다음, 이 플롯을 사용하여 유효한 블록 솔루션을 찾습니다.

**에너지 효율성**: 플롯 파일은 한 번 생성되어 무한정 재사용됩니다. 채굴은 최소한의 CPU 전력만 소비하며, 주로 디스크 I/O가 이루어집니다.

**PoCX 개선사항**:
- XOR-전치 압축 공격 수정 (POC2의 50% 시간-메모리 트레이드오프)
- 현대 하드웨어를 위한 16-논스 정렬 레이아웃
- 플롯 생성의 확장 가능한 작업 증명 (Xn 스케일링 레벨)
- Bitcoin Core에 직접 통합된 네이티브 C++ 구현
- 블록 시간 분포 개선을 위한 시간 왜곡 알고리즘

---

## 아키텍처 개요

### 저장소 구조

```
bitcoin-pocx/
├── bitcoin/             # Bitcoin Core v30.0 + PoCX 통합
│   └── src/pocx/        # PoCX 구현
├── pocx/                # PoCX 코어 프레임워크 (서브모듈, 읽기 전용)
└── docs/                # 이 문서
```

### 통합 철학

**최소한의 통합 접점**: 변경 사항이 `/src/pocx/` 디렉토리에 격리되어 있으며, Bitcoin Core 검증, 채굴 및 RPC 계층에 깔끔한 연결 지점을 가집니다.

**기능 플래그**: 모든 수정 사항이 `#ifdef ENABLE_POCX` 전처리기 가드 아래에 있습니다. 비활성화하면 Bitcoin Core가 정상적으로 빌드됩니다.

**업스트림 호환성**: 격리된 통합 지점을 통해 Bitcoin Core 업데이트와의 정기적인 동기화가 유지됩니다.

**네이티브 C++ 구현**: 스칼라 암호화 알고리즘(Shabal256, 스쿱 계산, 압축)이 합의 검증을 위해 Bitcoin Core에 직접 통합되어 있습니다.

---

## 핵심 기능

### 1. 완전한 합의 대체

- **블록 구조**: PoCX 전용 필드가 PoW 논스와 난이도 비트를 대체
  - 생성 서명 (결정론적 채굴 엔트로피)
  - 기본 목표 (난이도의 역수)
  - PoCX 증명 (계정 ID, 시드, 논스)
  - 블록 서명 (플롯 소유권 증명)

- **검증**: 헤더 검사부터 블록 연결까지 5단계 검증 파이프라인

- **난이도 조정**: 최근 기본 목표의 이동 평균을 사용하여 매 블록 조정

### 2. 시간 왜곡 알고리즘

**문제**: 전통적인 PoC 블록 시간은 지수 분포를 따르며, 채굴자가 좋은 솔루션을 찾지 못할 때 긴 블록이 발생합니다.

**해결책**: 세제곱근을 사용하여 지수 분포를 카이제곱 분포로 변환: `Y = scale × (X^(1/3))`.

**효과**: 매우 좋은 솔루션은 나중에 포징됩니다(네트워크가 모든 디스크를 스캔할 시간 확보, 빠른 블록 감소). 나쁜 솔루션은 개선됩니다. 평균 블록 시간은 120초로 유지되며, 긴 블록이 줄어듭니다.

**세부사항**: [3장: 합의 및 채굴](3-consensus-and-mining.md)

### 3. 포징 할당 시스템

**기능**: 플롯 소유자가 플롯 소유권을 유지하면서 다른 주소에 포징 권한을 위임할 수 있습니다.

**사용 사례**:
- 풀 채굴 (플롯이 풀 주소에 할당)
- 콜드 스토리지 (채굴 키가 플롯 소유권과 분리)
- 다자간 채굴 (공유 인프라)

**아키텍처**: OP_RETURN 전용 설계 - 특수 UTXO 없이, 할당이 체인스테이트 데이터베이스에서 별도로 추적됩니다.

**세부사항**: [4장: 포징 할당](4-forging-assignments.md)

### 4. 방어적 포징

**문제**: 빠른 시계는 15초 미래 허용 범위 내에서 타이밍 이점을 제공할 수 있습니다.

**해결책**: 동일한 높이에서 경쟁 블록을 수신할 때, 자동으로 로컬 품질을 확인합니다. 더 좋으면 즉시 포징합니다.

**효과**: 시계 조작의 인센티브를 제거합니다 - 빠른 시계는 이미 최선의 솔루션을 가진 경우에만 도움이 됩니다.

**세부사항**: [5장: 타이밍 보안](5-timing-security.md)

### 5. 동적 압축 스케일링

**경제적 정렬**: 스케일링 레벨 요구사항이 지수 일정에 따라 증가합니다 (년차 4, 12, 28, 60, 124 = 반감기 1, 3, 7, 15, 31).

**효과**: 블록 보상이 감소하면 플롯 생성 난이도가 증가합니다. 플롯 생성과 조회 비용 사이의 안전 마진을 유지합니다.

**방지**: 시간이 지남에 따라 더 빠른 하드웨어로 인한 용량 인플레이션을 방지합니다.

**세부사항**: [6장: 네트워크 매개변수](6-network-parameters.md)

---

## 설계 철학

### 코드 안전성

- 전반에 걸친 방어적 프로그래밍 관행
- 검증 경로에서의 포괄적인 오류 처리
- 중첩 잠금 없음 (데드락 방지)
- 원자적 데이터베이스 작업 (UTXO + 할당 함께)

### 모듈식 아키텍처

- Bitcoin Core 인프라와 PoCX 합의 간의 깔끔한 분리
- PoCX 코어 프레임워크가 암호화 기본 요소 제공
- Bitcoin Core가 검증 프레임워크, 데이터베이스, 네트워킹 제공

### 성능 최적화

- 빠른 실패 검증 순서 (저렴한 검사 먼저)
- 제출당 단일 컨텍스트 가져오기 (반복적인 cs_main 획득 없음)
- 일관성을 위한 원자적 데이터베이스 작업

### 재구성 안전성

- 할당 상태 변경에 대한 완전한 실행 취소 데이터
- 체인 팁 변경 시 포징 상태 재설정
- 모든 검증 지점에서 무효화 감지

---

## PoCX와 작업 증명의 차이점

| 측면 | Bitcoin (PoW) | Bitcoin-PoCX |
|--------|---------------|--------------|
| **채굴 자원** | 계산 능력 (해시율) | 디스크 공간 (용량) |
| **에너지 소비** | 높음 (지속적인 해싱) | 낮음 (디스크 I/O만) |
| **채굴 과정** | 해시 < 목표인 논스 찾기 | 데드라인 < 경과 시간인 논스 찾기 |
| **난이도** | `bits` 필드, 2016 블록마다 조정 | `base_target` 필드, 매 블록 조정 |
| **블록 시간** | ~10분 (지수 분포) | 120초 (시간 왜곡, 분산 감소) |
| **보조금** | 50 BTC -> 25 -> 12.5 -> ... | 10 BTC -> 5 -> 2.5 -> ... |
| **하드웨어** | ASIC (전문화) | HDD (범용 하드웨어) |
| **채굴 신원** | 익명 | 플롯 소유자 또는 위임자 |

---

## 시스템 요구사항

### 노드 운영

**Bitcoin Core와 동일**:
- **CPU**: 최신 x86_64 프로세서
- **메모리**: 4-8 GB RAM
- **스토리지**: 새 체인, 현재 비어 있음 (2분 블록과 할당 데이터베이스로 인해 Bitcoin보다 ~4배 빠르게 성장 가능)
- **네트워크**: 안정적인 인터넷 연결
- **시계**: 최적의 운영을 위해 NTP 동기화 권장

**참고**: 노드 운영에 플롯 파일은 필요하지 않습니다.

### 채굴 요구사항

**채굴을 위한 추가 요구사항**:
- **플롯 파일**: `pocx_plotter` (레퍼런스 구현)를 사용하여 미리 생성
- **마이너 소프트웨어**: `pocx_miner` (레퍼런스 구현)가 RPC를 통해 연결
- **지갑**: 채굴 주소의 개인 키가 있는 `bitcoind` 또는 `bitcoin-qt`. 풀 채굴은 로컬 지갑이 필요하지 않습니다.

---

## 시작하기

### 1. Bitcoin-PoCX 빌드

```bash
# 서브모듈과 함께 클론
git clone --recursive https://github.com/PoC-Consortium/bitcoin-pocx.git
cd bitcoin-pocx/bitcoin

# PoCX 활성화하여 빌드
cmake -B build -DENABLE_POCX=ON
cmake --build build
```

**세부사항**: 저장소 루트의 `CLAUDE.md` 참조

### 2. 노드 실행

**노드만 실행**:
```bash
./build/bin/bitcoind
# 또는
./build/bin/bitcoin-qt
```

**채굴용** (외부 마이너를 위한 RPC 접근 활성화):
```bash
./build/bin/bitcoind -miningserver
# 또는
./build/bin/bitcoin-qt -server -miningserver
```

**세부사항**: [6장: 네트워크 매개변수](6-network-parameters.md)

### 3. 플롯 파일 생성

`pocx_plotter` (레퍼런스 구현)를 사용하여 PoCX 형식의 플롯 파일을 생성합니다.

**세부사항**: [2장: 플롯 형식](2-plot-format.md)

### 4. 채굴 설정

`pocx_miner` (레퍼런스 구현)를 사용하여 노드의 RPC 인터페이스에 연결합니다.

**세부사항**: [7장: RPC 참조](7-rpc-reference.md) 및 [8장: 지갑 가이드](8-wallet-guide.md)

---

## 저작자 표시

### 플롯 형식

다음 개선사항이 포함된 POC2 형식(Burstcoin) 기반:
- 보안 결함 수정 (XOR-전치 압축 공격)
- 확장 가능한 작업 증명
- SIMD 최적화 레이아웃
- 시드 기능

### 소스 프로젝트

- **pocx_miner**: [scavenger](https://github.com/PoC-Consortium/scavenger) 기반 레퍼런스 구현
- **pocx_plotter**: [engraver](https://github.com/PoC-Consortium/engraver) 기반 레퍼런스 구현

**전체 저작자 표시**: [2장: 플롯 형식](2-plot-format.md)

---

## 기술 사양 요약

- **블록 시간**: 120초 (메인넷), 1초 (regtest)
- **블록 보조금**: 초기 10 BTC, 1050000 블록마다 반감 (~4년)
- **총 공급량**: ~2,100만 BTC (Bitcoin과 동일)
- **미래 허용**: 15초 (최대 15초 앞선 블록 허용)
- **시계 경고**: 10초 (운영자에게 시간 오차 경고)
- **할당 지연**: 30 블록 (~1시간)
- **취소 지연**: 720 블록 (~24시간)
- **주소 형식**: P2WPKH (bech32, pocx1q...) - PoCX 채굴 작업 및 포징 할당 전용

---

## 코드 구성

**Bitcoin Core 수정**: 핵심 파일에 최소한의 변경, `#ifdef ENABLE_POCX`로 기능 플래그 처리

**새 PoCX 구현**: `src/pocx/` 디렉토리에 격리

---

## 보안 고려사항

### 타이밍 보안

- 15초 미래 허용으로 네트워크 분열 방지
- 10초 경고 임계값으로 운영자에게 시계 오차 경고
- 방어적 포징으로 시계 조작 인센티브 제거
- 시간 왜곡으로 타이밍 분산 영향 감소

**세부사항**: [5장: 타이밍 보안](5-timing-security.md)

### 할당 보안

- OP_RETURN 전용 설계 (UTXO 조작 없음)
- 트랜잭션 서명으로 플롯 소유권 증명
- 빠른 상태 조작 방지를 위한 활성화 지연
- 모든 상태 변경에 대한 재구성 안전 실행 취소 데이터

**세부사항**: [4장: 포징 할당](4-forging-assignments.md)

### 합의 보안

- 서명이 블록 해시에서 제외됨 (가변성 방지)
- 제한된 서명 크기 (DoS 방지)
- 압축 범위 검증 (약한 증명 방지)
- 용량 변화에 대응하는 매 블록 난이도 조정

**세부사항**: [3장: 합의 및 채굴](3-consensus-and-mining.md)

---

## 네트워크 상태

**메인넷**: 아직 출시되지 않음
**테스트넷**: 테스트 가능
**Regtest**: 개발을 위해 완전히 작동

**제네시스 블록 매개변수**: [6장: 네트워크 매개변수](6-network-parameters.md)

---

## 다음 단계

**PoCX 이해하기**: [2장: 플롯 형식](2-plot-format.md)으로 계속하여 플롯 파일 구조와 형식 발전에 대해 알아보세요.

**채굴 설정**: 통합 세부사항을 위해 [7장: RPC 참조](7-rpc-reference.md)로 이동하세요.

**노드 실행**: 구성 옵션을 위해 [6장: 네트워크 매개변수](6-network-parameters.md)를 검토하세요.

---

[목차](index.md) | [다음: 플롯 형식 ->](2-plot-format.md)
