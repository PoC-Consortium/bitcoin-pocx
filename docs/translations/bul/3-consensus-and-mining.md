[‚Üê –ù–∞–∑–∞–¥: –§–æ—Ä–º–∞—Ç –Ω–∞ Plot —Ñ–∞–π–ª–æ–≤–µ—Ç–µ](2-plot-format.md) | [üìò –°—ä–¥—ä—Ä–∂–∞–Ω–∏–µ](index.md) | [–ù–∞–ø—Ä–µ–¥: –î–µ–ª–µ–≥–∏—Ä–∞–Ω–µ –Ω–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ ‚Üí](4-forging-assignments.md)

---

# –ì–ª–∞–≤–∞ 3: Bitcoin-PoCX –∫–æ–Ω—Å–µ–Ω—Å—É—Å –∏ –ø—Ä–æ—Ü–µ—Å –Ω–∞ –∫–æ–ø–∞–µ–Ω–µ

–ü—ä–ª–Ω–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–∏—è –º–µ—Ö–∞–Ω–∏–∑—ä–º PoCX (Proof of Capacity –æ—Ç –Ω–æ–≤–æ –ø–æ–∫–æ–ª–µ–Ω–∏–µ) –∏ –ø—Ä–æ—Ü–µ—Å–∞ –Ω–∞ –∫–æ–ø–∞–µ–Ω–µ, –∏–Ω—Ç–µ–≥—Ä–∏—Ä–∞–Ω–∏ –≤ Bitcoin Core.

---

## –°—ä–¥—ä—Ä–∂–∞–Ω–∏–µ

1. [–ü—Ä–µ–≥–ª–µ–¥](#–ø—Ä–µ–≥–ª–µ–¥)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–Ω–∞-–∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞)
3. [–ü—Ä–æ—Ü–µ—Å –Ω–∞ –∫–æ–ø–∞–µ–Ω–µ](#–ø—Ä–æ—Ü–µ—Å-–Ω–∞-–∫–æ–ø–∞–µ–Ω–µ)
4. [–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –±–ª–æ–∫–æ–≤–µ](#–≤–∞–ª–∏–¥–∞—Ü–∏—è-–Ω–∞-–±–ª–æ–∫–æ–≤–µ)
5. [–°–∏—Å—Ç–µ–º–∞ –∑–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ](#—Å–∏—Å—Ç–µ–º–∞-–∑–∞-–¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ)
6. [–ú—Ä–µ–∂–æ–≤–æ —Ä–∞–∑–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ](#–º—Ä–µ–∂–æ–≤–æ-—Ä–∞–∑–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ)
7. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–µ—Ç–∞–π–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏-–¥–µ—Ç–∞–π–ª–∏)

---

## –ü—Ä–µ–≥–ª–µ–¥

Bitcoin-PoCX –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞ —á–∏—Å—Ç Proof of Capacity –∫–æ–Ω—Å–µ–Ω—Å—É—Å–µ–Ω –º–µ—Ö–∞–Ω–∏–∑—ä–º –∫–∞—Ç–æ –ø—ä–ª–Ω–∞ –∑–∞–º—è–Ω–∞ –Ω–∞ Bitcoin Proof of Work. –¢–æ–≤–∞ –µ –Ω–æ–≤–∞ –≤–µ—Ä–∏–≥–∞ –±–µ–∑ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è –∑–∞ –æ–±—Ä–∞—Ç–Ω–∞ —Å—ä–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç.

**–ö–ª—é—á–æ–≤–∏ —Å–≤–æ–π—Å—Ç–≤–∞:**
- **–ï–Ω–µ—Ä–≥–∏–π–Ω–æ –µ—Ñ–µ–∫—Ç–∏–≤–µ–Ω:** –ö–æ–ø–∞–µ–Ω–µ—Ç–æ –∏–∑–ø–æ–ª–∑–≤–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏ plot —Ñ–∞–π–ª–æ–≤–µ –≤–º–µ—Å—Ç–æ –∏–∑—á–∏—Å–ª–∏—Ç–µ–ª–Ω–æ —Ö–µ—à–∏—Ä–∞–Ω–µ
- **Time Bended –∫—Ä–∞–π–Ω–∏ —Å—Ä–æ–∫–æ–≤–µ:** –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –Ω–∞ —Ä–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ—Ç–æ (–µ–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª–Ω–æ‚Üí—Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç) –Ω–∞–º–∞–ª—è–≤–∞ –¥—ä–ª–≥–∏—Ç–µ –±–ª–æ–∫–æ–≤–µ, –ø–æ–¥–æ–±—Ä—è–≤–∞ —Å—Ä–µ–¥–Ω–∏—Ç–µ –≤—Ä–µ–º–µ–Ω–∞ –Ω–∞ –±–ª–æ–∫–æ–≤–µ
- **–ü–æ–¥–¥—Ä—ä–∂–∫–∞ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ:** –°–æ–±—Å—Ç–≤–µ–Ω–∏—Ü–∏—Ç–µ –Ω–∞ plot —Ñ–∞–π–ª–æ–≤–µ –º–æ–≥–∞—Ç –¥–∞ –¥–µ–ª–µ–≥–∏—Ä–∞—Ç –ø—Ä–∞–≤–∞ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ –¥—Ä—É–≥–∏ –∞–¥—Ä–µ—Å–∏
- **–ù–∞—Ç–∏–≤–Ω–∞ C++ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—Å–∫–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏, –∏–º–ø–ª–µ–º–µ–Ω—Ç–∏—Ä–∞–Ω–∏ –≤ C++ –∑–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è

**–ü–æ—Ç–æ–∫ –Ω–∞ –∫–æ–ø–∞–µ–Ω–µ:**
```
–í—ä–Ω—à–µ–Ω –º–∏–Ω—å–æ—Ä ‚Üí get_mining_info ‚Üí –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ Nonce ‚Üí submit_nonce ‚Üí
–û–ø–∞—à–∫–∞ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ ‚Üí –ò–∑—á–∞–∫–≤–∞–Ω–µ –Ω–∞ –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫ ‚Üí –ü–æ–¥–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ –±–ª–æ–∫ ‚Üí –ú—Ä–µ–∂–æ–≤–æ —Ä–∞–∑–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ ‚Üí
–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –±–ª–æ–∫ ‚Üí –†–∞–∑—à–∏—Ä—è–≤–∞–Ω–µ –Ω–∞ –≤–µ—Ä–∏–≥–∞—Ç–∞
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞ –±–ª–æ–∫

PoCX –±–ª–æ–∫–æ–≤–µ—Ç–µ —Ä–∞–∑—à–∏—Ä—è–≤–∞—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ç–∞ –Ω–∞ Bitcoin –±–ª–æ–∫ —Å –¥–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–∏ –ø–æ–ª–µ—Ç–∞:

```cpp
struct PoCXProof {
    std::array<uint8_t, 32> seed;             // Seed –Ω–∞ plot (32 –±–∞–π—Ç–∞)
    std::array<uint8_t, 20> account_id;       // –ê–¥—Ä–µ—Å –Ω–∞ plot (20-–±–∞–π—Ç–æ–≤ hash160)
    uint32_t compression;                     // –ù–∏–≤–æ –Ω–∞ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ (1-255)
    uint64_t nonce;                           // Nonce –∑–∞ –∫–æ–ø–∞–µ–Ω–µ (64-–±–∏—Ç)
    uint64_t quality;                         // –î–µ–∫–ª–∞—Ä–∏—Ä–∞–Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ (–∏–∑—Ö–æ–¥ –Ω–∞ PoC —Ö–µ—à)
};

class CBlockHeader {
    // –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏ Bitcoin –ø–æ–ª–µ—Ç–∞
    int32_t nVersion;
    uint256 hashPrevBlock;
    uint256 hashMerkleRoot;
    uint32_t nTime;

    // PoCX –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–∏ –ø–æ–ª–µ—Ç–∞ (–∑–∞–º–µ—Å—Ç–≤–∞—Ç nBits –∏ nNonce)
    int nHeight;                              // –í–∏—Å–æ—á–∏–Ω–∞ –Ω–∞ –±–ª–æ–∫ (–≤–∞–ª–∏–¥–∞—Ü–∏—è –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç)
    uint256 generationSignature;              // –ì–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å (–µ–Ω—Ç—Ä–æ–ø–∏—è –∑–∞ –∫–æ–ø–∞–µ–Ω–µ)
    uint64_t nBaseTarget;                     // –ü–∞—Ä–∞–º–µ—Ç—ä—Ä –∑–∞ —Ç—Ä—É–¥–Ω–æ—Å—Ç (–æ–±—Ä–∞—Ç–Ω–∞ —Ç—Ä—É–¥–Ω–æ—Å—Ç)
    PoCXProof pocxProof;                      // –î–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ –∑–∞ –∫–æ–ø–∞–µ–Ω–µ

    // –ü–æ–ª–µ—Ç–∞ –∑–∞ –ø–æ–¥–ø–∏—Å –Ω–∞ –±–ª–æ–∫
    std::array<uint8_t, 33> vchPubKey;        // –ö–æ–º–ø—Ä–µ—Å–∏—Ä–∞–Ω –ø—É–±–ª–∏—á–µ–Ω –∫–ª—é—á (33 –±–∞–π—Ç–∞)
    std::array<uint8_t, 65> vchSignature;     // –ö–æ–º–ø–∞–∫—Ç–µ–Ω –ø–æ–¥–ø–∏—Å (65 –±–∞–π—Ç–∞)
};

class CBlock : public CBlockHeader {
    std::vector<CTransactionRef> vtx;         // –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
};
```

**–ó–∞–±–µ–ª–µ–∂–∫–∞:** –ü–æ–¥–ø–∏—Å—ä—Ç (`vchSignature`) –µ –∏–∑–∫–ª—é—á–µ–Ω –æ—Ç –∏–∑—á–∏—Å–ª—è–≤–∞–Ω–µ—Ç–æ –Ω–∞ —Ö–µ—à–∞ –Ω–∞ –±–ª–æ–∫–∞, –∑–∞ –¥–∞ —Å–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏ –ø–æ–¥–∞—Ç–ª–∏–≤–æ—Å—Ç.

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/primitives/block.h`

### –ì–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å

–ì–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∏—è—Ç –ø–æ–¥–ø–∏—Å —Å—ä–∑–¥–∞–≤–∞ –µ–Ω—Ç—Ä–æ–ø–∏—è –∑–∞ –∫–æ–ø–∞–µ–Ω–µ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞ –∞—Ç–∞–∫–∏ —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª–Ω–æ –∏–∑—á–∏—Å–ª—è–≤–∞–Ω–µ.

**–ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ:**
```
generationSignature = SHA256(prev_generationSignature || prev_miner_pubkey)
```

**–ì–µ–Ω–µ–∑–∏—Å –±–ª–æ–∫:** –ò–∑–ø–æ–ª–∑–≤–∞ —Ç–≤—ä—Ä–¥–æ –∫–æ–¥–∏—Ä–∞–Ω –Ω–∞—á–∞–ª–µ–Ω –≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/pocx/node/node.cpp:GetNewBlockContext()`

### –ë–∞–∑–æ–≤–∞ —Ü–µ–ª (—Ç—Ä—É–¥–Ω–æ—Å—Ç)

–ë–∞–∑–æ–≤–∞—Ç–∞ —Ü–µ–ª –µ –æ–±—Ä–∞—Ç–Ω–∞—Ç–∞ –Ω–∞ —Ç—Ä—É–¥–Ω–æ—Å—Ç—Ç–∞ ‚Äî –ø–æ-–≤–∏—Å–æ–∫–∏ —Å—Ç–æ–π–Ω–æ—Å—Ç–∏ –æ–∑–Ω–∞—á–∞–≤–∞—Ç –ø–æ-–ª–µ—Å–Ω–æ –∫–æ–ø–∞–µ–Ω–µ.

**–ê–ª–≥–æ—Ä–∏—Ç—ä–º –∑–∞ –∫–æ—Ä–µ–∫—Ü–∏—è:**
- –¶–µ–ª–µ–≤–æ –≤—Ä–µ–º–µ –Ω–∞ –±–ª–æ–∫: 120 —Å–µ–∫—É–Ω–¥–∏ (mainnet), 1 —Å–µ–∫—É–Ω–¥–∞ (regtest)
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞ –∫–æ—Ä–µ–∫—Ü–∏—è: –í—Å–µ–∫–∏ –±–ª–æ–∫
- –ò–∑–ø–æ–ª–∑–≤–∞ –ø–ª–∞–≤–∞—â–∞ —Å—Ä–µ–¥–Ω–∞ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ç–µ –±–∞–∑–æ–≤–∏ —Ü–µ–ª–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∞, –∑–∞ –¥–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏ –µ–∫—Å—Ç—Ä–µ–º–Ω–∏ –ø—Ä–æ–º–µ–Ω–∏ –≤ —Ç—Ä—É–¥–Ω–æ—Å—Ç—Ç–∞

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/consensus/params.h`, –ª–æ–≥–∏–∫–∞ –∑–∞ —Ç—Ä—É–¥–Ω–æ—Å—Ç –≤ —Å—ä–∑–¥–∞–≤–∞–Ω–µ—Ç–æ –Ω–∞ –±–ª–æ–∫

### –ù–∏–≤–∞ –Ω–∞ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ

PoCX –ø–æ–¥–¥—ä—Ä–∂–∞ –º–∞—â–∞–±–∏—Ä—É–µ–º proof-of-work –≤ plot —Ñ–∞–π–ª–æ–≤–µ —á—Ä–µ–∑ –Ω–∏–≤–∞ –Ω–∞ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ (Xn).

**–î–∏–Ω–∞–º–∏—á–Ω–∏ –≥—Ä–∞–Ω–∏—Ü–∏:**
```cpp
struct CompressionBounds {
    uint8_t nPoCXMinCompression;     // –ú–∏–Ω–∏–º–∞–ª–Ω–æ –ø—Ä–∏–µ–º–∞–Ω–æ –Ω–∏–≤–æ
    uint8_t nPoCXTargetCompression;  // –ü—Ä–µ–ø–æ—Ä—ä—á–∏—Ç–µ–ª–Ω–æ –Ω–∏–≤–æ
};
```

**–ì—Ä–∞—Ñ–∏–∫ –∑–∞ —É–≤–µ–ª–∏—á–∞–≤–∞–Ω–µ –Ω–∞ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ—Ç–æ:**
- –ï–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª–Ω–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏: –ì–æ–¥–∏–Ω–∏ 4, 12, 28, 60, 124 (halvings 1, 3, 7, 15, 31)
- –ú–∏–Ω–∏–º–∞–ª–Ω–æ—Ç–æ –Ω–∏–≤–æ –Ω–∞ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ —Å–µ —É–≤–µ–ª–∏—á–∞–≤–∞ —Å 1
- –¶–µ–ª–µ–≤–æ—Ç–æ –Ω–∏–≤–æ –Ω–∞ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ —Å–µ —É–≤–µ–ª–∏—á–∞–≤–∞ —Å 1
- –ü–æ–¥–¥—ä—Ä–∂–∞ –ø—Ä–µ–¥–ø–∞–∑–µ–Ω –º–∞—Ä–∂ –º–µ–∂–¥—É —Ä–∞–∑—Ö–æ–¥–∏—Ç–µ –∑–∞ —Å—ä–∑–¥–∞–≤–∞–Ω–µ –∏ —Ç—ä—Ä—Å–µ–Ω–µ –Ω–∞ plot —Ñ–∞–π–ª–æ–≤–µ
- –ú–∞–∫—Å–∏–º–∞–ª–Ω–æ –Ω–∏–≤–æ –Ω–∞ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ: 255

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/pocx/algorithms/algorithms.h:GetPoCXCompressionBounds()`

---

## –ü—Ä–æ—Ü–µ—Å –Ω–∞ –∫–æ–ø–∞–µ–Ω–µ

### 1. –ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∑–∞ –∫–æ–ø–∞–µ–Ω–µ

**RPC –∫–æ–º–∞–Ω–¥–∞:** `get_mining_info`

**–ü—Ä–æ—Ü–µ—Å:**
1. –ò–∑–≤–∏–∫–≤–∞–Ω–µ –Ω–∞ `GetNewBlockContext(chainman)` –∑–∞ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ —Ç–µ–∫—É—â–æ—Ç–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–∞
2. –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –¥–∏–Ω–∞–º–∏—á–Ω–∏ –≥—Ä–∞–Ω–∏—Ü–∏ –Ω–∞ –∫–æ–º–ø—Ä–µ—Å–∏—è –∑–∞ —Ç–µ–∫—É—â–∞—Ç–∞ –≤–∏—Å–æ—á–∏–Ω–∞
3. –í—Ä—ä—â–∞–Ω–µ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –∑–∞ –∫–æ–ø–∞–µ–Ω–µ

**–û—Ç–≥–æ–≤–æ—Ä:**
```json
{
  "generation_signature": "abc123...",
  "base_target": 18325193796,
  "height": 12345,
  "block_hash": "def456...",
  "target_quality": 18446744073709551615,
  "minimum_compression_level": 0,
  "target_compression_level": 0
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/pocx/rpc/mining.cpp:get_mining_info()`

**–ó–∞–±–µ–ª–µ–∂–∫–∏:**
- –ù–µ —Å–µ –¥—ä—Ä–∂–∞—Ç –∑–∞–∫–ª—é—á–≤–∞–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ –Ω–∞ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ –æ—Ç–≥–æ–≤–æ—Ä
- –ü—Ä–∏–¥–æ–±–∏–≤–∞–Ω–µ—Ç–æ –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç –æ–±—Ä–∞–±–æ—Ç–≤–∞ `cs_main` –≤—ä—Ç—Ä–µ—à–Ω–æ
- `block_hash` –µ –≤–∫–ª—é—á–µ–Ω –∑–∞ —Å–ø—Ä–∞–≤–∫–∞, –Ω–æ –Ω–µ —Å–µ –∏–∑–ø–æ–ª–∑–≤–∞ –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è

### 2. –í—ä–Ω—à–Ω–æ –∫–æ–ø–∞–µ–Ω–µ

**–û—Ç–≥–æ–≤–æ—Ä–Ω–æ—Å—Ç–∏ –Ω–∞ –≤—ä–Ω—à–Ω–∏—è –º–∏–Ω—å–æ—Ä:**
1. –ß–µ—Ç–µ–Ω–µ –Ω–∞ plot —Ñ–∞–π–ª–æ–≤–µ –æ—Ç –¥–∏—Å–∫–∞
2. –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ scoop –Ω–∞ –±–∞–∑–∞—Ç–∞ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å –∏ –≤–∏—Å–æ—á–∏–Ω–∞
3. –ù–∞–º–∏—Ä–∞–Ω–µ –Ω–∞ nonce —Å –Ω–∞–π-–¥–æ–±—ä—Ä –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫
4. –ü–æ–¥–∞–≤–∞–Ω–µ –∫—ä–º –≤—ä–∑–µ–ª–∞ —á—Ä–µ–∑ `submit_nonce`

**–§–æ—Ä–º–∞—Ç –Ω–∞ Plot —Ñ–∞–π–ª:**
- –ë–∞–∑–∏—Ä–∞–Ω –Ω–∞ POC2 —Ñ–æ—Ä–º–∞—Ç (Burstcoin)
- –ü–æ–¥–æ–±—Ä–µ–Ω —Å –ø–æ–ø—Ä–∞–≤–∫–∏ –∑–∞ —Å–∏–≥—É—Ä–Ω–æ—Å—Ç –∏ –ø–æ–¥–æ–±—Ä–µ–Ω–∏—è –∑–∞ –º–∞—â–∞–±–∏—Ä—É–µ–º–æ—Å—Ç
- –í–∏–∂—Ç–µ –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ—Ç–æ –≤ `CLAUDE.md`

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –Ω–∞ –º–∏–Ω—å–æ—Ä:** –í—ä–Ω—à–Ω–∞ (–Ω–∞–ø—Ä. –±–∞–∑–∏—Ä–∞–Ω–∞ –Ω–∞ Scavenger)

### 3. –ü–æ–¥–∞–≤–∞–Ω–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ Nonce

**RPC –∫–æ–º–∞–Ω–¥–∞:** `submit_nonce`

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
```
height, generation_signature, account_id, seed, nonce, quality (–Ω–µ–∑–∞–¥—ä–ª–∂–∏—Ç–µ–ª–µ–Ω)
```

**–ü–æ—Ç–æ–∫ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω —Ä–µ–¥):**

#### –°—Ç—ä–ø–∫–∞ 1: –ë—ä—Ä–∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Ñ–æ—Ä–º–∞—Ç
```cpp
// Account ID: 40 hex —Å–∏–º–≤–æ–ª–∞ = 20 –±–∞–π—Ç–∞
if (account_id.length() != 40 || !IsHex(account_id)) reject;

// Seed: 64 hex —Å–∏–º–≤–æ–ª–∞ = 32 –±–∞–π—Ç–∞
if (seed.length() != 64 || !IsHex(seed)) reject;
```

#### –°—Ç—ä–ø–∫–∞ 2: –ü—Ä–∏–¥–æ–±–∏–≤–∞–Ω–µ –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç
```cpp
auto context = pocx::consensus::GetNewBlockContext(chainman);
// –í—Ä—ä—â–∞: height, generation_signature, base_target, block_hash
```

**–ó–∞–∫–ª—é—á–≤–∞–Ω–µ:** `cs_main` —Å–µ –æ–±—Ä–∞–±–æ—Ç–≤–∞ –≤—ä—Ç—Ä–µ—à–Ω–æ, –Ω–µ —Å–µ –¥—ä—Ä–∂–∞—Ç –∑–∞–∫–ª—é—á–≤–∞–Ω–∏—è –≤ RPC –Ω–∏—à–∫–∞

#### –°—Ç—ä–ø–∫–∞ 3: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç
```cpp
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤–∏—Å–æ—á–∏–Ω–∞
if (height != context.height) reject;

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å
if (submitted_gen_sig != context.generation_signature) reject;
```

#### –°—Ç—ä–ø–∫–∞ 4: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –ø–æ—Ä—Ç—Ñ–µ–π–ª
```cpp
// –û–ø—Ä–µ–¥–µ–ª—è–Ω–µ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø–æ–¥–ø–∏—Å–≤–∞—â (—Å –æ—Ç—á–∏—Ç–∞–Ω–µ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–∏—è)
effective_signer = GetEffectiveSigner(plot_address, height, view);

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –≤—ä–∑–µ–ª—ä—Ç –∏–º–∞ —á–∞—Å—Ç–µ–Ω –∫–ª—é—á –∑–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—è –ø–æ–¥–ø–∏—Å–≤–∞—â
if (!HaveAccountKey(effective_signer, wallet)) reject;
```

**–ü–æ–¥–¥—Ä—ä–∂–∫–∞ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ:** –°–æ–±—Å—Ç–≤–µ–Ω–∏–∫—ä—Ç –Ω–∞ plot –º–æ–∂–µ –¥–∞ –¥–µ–ª–µ–≥–∏—Ä–∞ –ø—Ä–∞–≤–∞ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ –¥—Ä—É–≥ –∞–¥—Ä–µ—Å. –ü–æ—Ä—Ç—Ñ–µ–π–ª—ä—Ç —Ç—Ä—è–±–≤–∞ –¥–∞ –∏–º–∞ –∫–ª—é—á –∑–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—è –ø–æ–¥–ø–∏—Å–≤–∞—â, –Ω–µ –Ω–µ–ø—Ä–µ–º–µ–Ω–Ω–æ –∑–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–∏–∫–∞ –Ω–∞ plot.

#### –°—Ç—ä–ø–∫–∞ 5: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ
```cpp
bool success = pocx_validate_block(
    generation_signature_hex,
    base_target,
    account_payload,     // 20 –±–∞–π—Ç–∞
    block_height,
    nonce,
    seed,                // 32 –±–∞–π—Ç–∞
    min_compression,
    max_compression,
    &result             // –ò–∑—Ö–æ–¥: quality, deadline
);
```

**–ê–ª–≥–æ—Ä–∏—Ç—ä–º:**
1. –î–µ–∫–æ–¥–∏—Ä–∞–Ω–µ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å –æ—Ç hex
2. –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –Ω–∞–π-–¥–æ–±—Ä–æ –∫–∞—á–µ—Å—Ç–≤–æ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –Ω–∞ –∫–æ–º–ø—Ä–µ—Å–∏—è —Å SIMD-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∏
3. –í–∞–ª–∏–¥–∞—Ü–∏—è, —á–µ –∫–∞—á–µ—Å—Ç–≤–æ—Ç–æ –æ—Ç–≥–æ–≤–∞—Ä—è –Ω–∞ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è—Ç–∞ –∑–∞ —Ç—Ä—É–¥–Ω–æ—Å—Ç
4. –í—Ä—ä—â–∞–Ω–µ –Ω–∞ —Å—É—Ä–æ–≤–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/pocx/consensus/validation.cpp:pocx_validate_block()`

#### –°—Ç—ä–ø–∫–∞ 6: –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ Time Bending
```cpp
// –°—É—Ä–æ–≤ –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫, –∫–æ—Ä–∏–≥–∏—Ä–∞–Ω –∑–∞ —Ç—Ä—É–¥–Ω–æ—Å—Ç (—Å–µ–∫—É–Ω–¥–∏)
uint64_t deadline_seconds = quality / base_target;

// Time Bended –≤—Ä–µ–º–µ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ (—Å–µ–∫—É–Ω–¥–∏)
uint64_t forge_time = CalculateTimeBendedDeadline(
    quality, base_target, block_time
);
```

**–§–æ—Ä–º—É–ª–∞ –Ω–∞ Time Bending:**
```
Y = scale * (X^(1/3))
–∫—ä–¥–µ—Ç–æ:
  X = quality / base_target
  scale = block_time / (cbrt(block_time) * Gamma(4/3))
  Gamma(4/3) ‚âà 0.892979511
```

**–¶–µ–ª:** –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–∞ –µ–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª–Ω–æ –≤ —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç —Ä–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ. –ú–Ω–æ–≥–æ –¥–æ–±—Ä–∏—Ç–µ —Ä–µ—à–µ–Ω–∏—è —Å–µ –ø–æ–¥–ø–∏—Å–≤–∞—Ç –ø–æ-–∫—ä—Å–Ω–æ (–º—Ä–µ–∂–∞—Ç–∞ –∏–º–∞ –≤—Ä–µ–º–µ –¥–∞ —Å–∫–∞–Ω–∏—Ä–∞ –¥–∏—Å–∫–æ–≤–µ—Ç–µ), –ª–æ—à–∏—Ç–µ —Ä–µ—à–µ–Ω–∏—è —Å–µ –ø–æ–¥–æ–±—Ä—è–≤–∞—Ç. –ù–∞–º–∞–ª—è–≤–∞ –¥—ä–ª–≥–∏—Ç–µ –±–ª–æ–∫–æ–≤–µ, –ø–æ–¥–¥—ä—Ä–∂–∞ —Å—Ä–µ–¥–Ω–æ 120s.

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/pocx/algorithms/time_bending.cpp:CalculateTimeBendedDeadline()`

#### –°—Ç—ä–ø–∫–∞ 7: –ü–æ–¥–∞–≤–∞–Ω–µ –∫—ä–º –ø–ª–∞–Ω–∏—Ä–æ–≤—á–∏–∫–∞
```cpp
g_pocx_scheduler->SubmitNonce(
    account_id,
    seed,
    nonce,
    raw_quality,      // –ù–ï deadline ‚Äî –ø—Ä–µ–∏–∑—á–∏—Å–ª—è–≤–∞ —Å–µ –≤ –ø–æ–¥–ø–∏—Å–≤–∞—â–∏—è
    height,
    generation_signature
);
```

**–î–∏–∑–∞–π–Ω, –±–∞–∑–∏—Ä–∞–Ω –Ω–∞ –æ–ø–∞—à–∫–∞:**
- –ü–æ–¥–∞–≤–∞–Ω–µ—Ç–æ –≤–∏–Ω–∞–≥–∏ —É—Å–ø—è–≤–∞ (–¥–æ–±–∞–≤—è —Å–µ –∫—ä–º –æ–ø–∞—à–∫–∞—Ç–∞)
- RPC –≤—Ä—ä—â–∞ –Ω–µ–∑–∞–±–∞–≤–Ω–æ
- –†–∞–±–æ—Ç–Ω–∏—á–µ—Å–∫–∞ –Ω–∏—à–∫–∞ –æ–±—Ä–∞–±–æ—Ç–≤–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/pocx/rpc/mining.cpp:submit_nonce()`

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –æ–ø–∞—à–∫–∞—Ç–∞ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
- –ï–¥–Ω–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–∞ —Ä–∞–±–æ—Ç–Ω–∏—á–µ—Å–∫–∞ –Ω–∏—à–∫–∞
- FIFO –æ–ø–∞—à–∫–∞ –∑–∞ –ø–æ–¥–∞–≤–∞–Ω–µ
- –°—ä—Å—Ç–æ—è–Ω–∏–µ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ –±–µ–∑ –∑–∞–∫–ª—é—á–≤–∞–Ω–µ (—Å–∞–º–æ —Ä–∞–±–æ—Ç–Ω–∏—á–µ—Å–∫–∞ –Ω–∏—à–∫–∞)
- –ë–µ–∑ –≤–ª–æ–∂–µ–Ω–∏ –∑–∞–∫–ª—é—á–≤–∞–Ω–∏—è (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞–Ω–µ –Ω–∞ deadlock)

**–ì–ª–∞–≤–µ–Ω —Ü–∏–∫—ä–ª –Ω–∞ —Ä–∞–±–æ—Ç–Ω–∏—á–µ—Å–∫–∞ –Ω–∏—à–∫–∞:**
```cpp
while (!shutdown) {
    // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –ø–æ–¥–∞–¥–µ–Ω–∏ –≤ –æ–ø–∞—à–∫–∞—Ç–∞
    if (has_submission) {
        ProcessSubmission(submission);
        continue;
    }

    // 2. –ò–∑—á–∞–∫–≤–∞–Ω–µ –Ω–∞ –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫ –∏–ª–∏ –Ω–æ–≤–æ –ø–æ–¥–∞–≤–∞–Ω–µ
    if (has_forging_state) {
        WaitForDeadlineOrNewSubmission();
    } else {
        WaitForNewSubmission();
    }
}
```

**–õ–æ–≥–∏–∫–∞ –Ω–∞ ProcessSubmission:**
```cpp
1. –ü–æ–ª—É—á–∞–≤–∞–Ω–µ –Ω–∞ —Å–≤–µ–∂ –∫–æ–Ω—Ç–µ–∫—Å—Ç: GetNewBlockContext(*chainman)

2. –ü—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞ –æ—Å—Ç–∞—Ä—è–ª–æ—Å—Ç (—Ç–∏—Ö–æ –æ—Ç—Ö–≤—ä—Ä–ª—è–Ω–µ):
   - –ù–µ—Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞ –≤–∏—Å–æ—á–∏–Ω–∞ ‚Üí –æ—Ç—Ö–≤—ä—Ä–ª—è–Ω–µ
   - –ù–µ—Å—ä–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å ‚Üí –æ—Ç—Ö–≤—ä—Ä–ª—è–Ω–µ
   - –ü—Ä–æ–º—è–Ω–∞ –Ω–∞ —Ö–µ—à–∞ –Ω–∞ –≤—ä—Ä—Ö–∞ –Ω–∞ –±–ª–æ–∫–∞ (—Ä–µ–æ—Ä–≥) ‚Üí –Ω—É–ª–∏—Ä–∞–Ω–µ –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ

3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ:
   - –ê–∫–æ quality >= current_best ‚Üí –æ—Ç—Ö–≤—ä—Ä–ª—è–Ω–µ

4. –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ Time Bended –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫:
   deadline = CalculateTimeBendedDeadline(quality, base_target, block_time)

5. –ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ—Ç–æ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ:
   - –û—Ç–º—è–Ω–∞ –Ω–∞ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞—â–æ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ (–∞–∫–æ –µ –Ω–∞–º–µ—Ä–µ–Ω–æ –ø–æ-–¥–æ–±—Ä–æ)
   - –°—ä—Ö—Ä–∞–Ω—è–≤–∞–Ω–µ: account_id, seed, nonce, quality, deadline
   - –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ: forge_time = block_time + deadline_seconds
   - –°—ä—Ö—Ä–∞–Ω—è–≤–∞–Ω–µ –Ω–∞ —Ö–µ—à –Ω–∞ –≤—ä—Ä—Ö–∞ –∑–∞ –æ—Ç–∫—Ä–∏–≤–∞–Ω–µ –Ω–∞ —Ä–µ–æ—Ä–≥
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/pocx/mining/scheduler.cpp:ProcessSubmission()`

### 5. –ò–∑—á–∞–∫–≤–∞–Ω–µ –Ω–∞ –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫ –∏ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ –±–ª–æ–∫

**WaitForDeadlineOrNewSubmission:**

**–£—Å–ª–æ–≤–∏—è –∑–∞ –∏–∑—á–∞–∫–≤–∞–Ω–µ:**
```cpp
condition_variable.wait_until(forge_time, [&] {
    return shutdown ||
           !submission_queue.empty() ||
           forging_cancelled;
});
```

**–ü—Ä–∏ –¥–æ—Å—Ç–∏–≥–∞–Ω–µ –Ω–∞ –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫ ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å–≤–µ–∂ –∫–æ–Ω—Ç–µ–∫—Å—Ç:**
```cpp
1. –ü–æ–ª—É—á–∞–≤–∞–Ω–µ –Ω–∞ —Ç–µ–∫—É—â –∫–æ–Ω—Ç–µ–∫—Å—Ç: GetNewBlockContext(*chainman)

2. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤–∏—Å–æ—á–∏–Ω–∞:
   if (forging_height != current_height) {
       reset_forging_state();
       return;
   }

3. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å:
   if (forging_gen_sig != current_gen_sig) {
       reset_forging_state();
       return;
   }

4. –ì—Ä–∞–Ω–∏—á–µ–Ω —Å–ª—É—á–∞–π —Å –±–∞–∑–æ–≤–∞ —Ü–µ–ª:
   if (forging_base_target != current_base_target) {
       // –ü—Ä–µ–∏–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫ —Å –Ω–æ–≤–∞ –±–∞–∑–æ–≤–∞ —Ü–µ–ª
       new_deadline = CalculateTimeBendedDeadline(quality, new_base_target, block_time);
       update_forge_time(new_deadline);
       return; // –ò–∑—á–∞–∫–≤–∞–Ω–µ –æ—Ç–Ω–æ–≤–æ
   }

5. –í—Å–∏—á–∫–æ –≤–∞–ª–∏–¥–Ω–æ ‚Üí ForgeBlock()
```

**–ü—Ä–æ—Ü–µ—Å –Ω–∞ ForgeBlock:**

```cpp
1. –û–ø—Ä–µ–¥–µ–ª—è–Ω–µ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø–æ–¥–ø–∏—Å–≤–∞—â (–ø–æ–¥–¥—Ä—ä–∂–∫–∞ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ):
   effective_signer = GetEffectiveSigner(plot_address, height, view);

2. –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ coinbase —Å–∫—Ä–∏–ø—Ç:
   coinbase_script = P2WPKH(effective_signer);  // –ü–ª–∞—â–∞ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—è –ø–æ–¥–ø–∏—Å–≤–∞—â

3. –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ —à–∞–±–ª–æ–Ω –∑–∞ –±–ª–æ–∫:
   options.coinbase_output_script = coinbase_script;
   options.use_mempool = true;
   template = mining->createNewBlock(options);

4. –î–æ–±–∞–≤—è–Ω–µ –Ω–∞ PoCX –¥–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ:
   block.pocxProof.account_id = plot_address;    // –û—Ä–∏–≥–∏–Ω–∞–ª–µ–Ω –∞–¥—Ä–µ—Å –Ω–∞ plot
   block.pocxProof.seed = seed;
   block.pocxProof.nonce = nonce;

5. –ü—Ä–µ–∏–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ merkle root:
   block.hashMerkleRoot = BlockMerkleRoot(block);

6. –ü–æ–¥–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ –±–ª–æ–∫:
   // –ò–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ –∫–ª—é—á–∞ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—è –ø–æ–¥–ø–∏—Å–≤–∞—â (–º–æ–∂–µ –¥–∞ –µ —Ä–∞–∑–ª–∏—á–µ–Ω –æ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–∏–∫–∞ –Ω–∞ plot)
   hash = PoCXBlockSignatureHash(block.GetHash());
   key.SignCompact(hash, signature);
   block.vchSignature = signature;
   block.vchPubKey = effective_signer_pubkey;

7. –ü–æ–¥–∞–≤–∞–Ω–µ –∫—ä–º –≤–µ—Ä–∏–≥–∞—Ç–∞:
   chainman->ProcessNewBlock(block, force=true, min_pow_checked=true);

8. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç:
   if (accepted) {
       log_success();
       reset_forging_state();  // –ì–æ—Ç–æ–≤ –∑–∞ —Å–ª–µ–¥–≤–∞—â –±–ª–æ–∫
   } else {
       log_failure();
       reset_forging_state();
   }
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/pocx/mining/scheduler.cpp:ForgeBlock()`

**–ö–ª—é—á–æ–≤–∏ –¥–∏–∑–∞–π–Ω–µ—Ä—Å–∫–∏ —Ä–µ—à–µ–Ω–∏—è:**
- Coinbase –ø–ª–∞—â–∞ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—è –ø–æ–¥–ø–∏—Å–≤–∞—â (—É–≤–∞–∂–∞–≤–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–∏—è—Ç–∞)
- –î–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ—Ç–æ —Å—ä–¥—ä—Ä–∂–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏—è –∞–¥—Ä–µ—Å –Ω–∞ plot (–∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è)
- –ü–æ–¥–ø–∏—Å –æ—Ç –∫–ª—é—á–∞ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—è –ø–æ–¥–ø–∏—Å–≤–∞—â (–¥–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ –∑–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–æ—Å—Ç)
- –°—ä–∑–¥–∞–≤–∞–Ω–µ—Ç–æ –Ω–∞ —à–∞–±–ª–æ–Ω –≤–∫–ª—é—á–≤–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—Ç mempool –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ

---

## –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –±–ª–æ–∫–æ–≤–µ

### –ü–æ—Ç–æ–∫ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤—Ö–æ–¥—è—â –±–ª–æ–∫

–ö–æ–≥–∞—Ç–æ –±–ª–æ–∫ —Å–µ –ø–æ–ª—É—á–∏ –æ—Ç –º—Ä–µ–∂–∞—Ç–∞ –∏–ª–∏ —Å–µ –ø–æ–¥–∞–¥–µ –ª–æ–∫–∞–ª–Ω–æ, —Ç–æ–π –ø—Ä–µ–º–∏–Ω–∞–≤–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –µ—Ç–∞–ø–∏:

### –ï—Ç–∞–ø 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∑–∞–≥–ª–∞–≤–∏–µ (CheckBlockHeader)

**–í–∞–ª–∏–¥–∞—Ü–∏—è –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç:**

```cpp
static bool CheckBlockHeader(
    const CBlockHeader& block,
    BlockValidationState& state,
    const Consensus::Params& consensusParams,
    bool fCheckPOW = true
)
```

**PoCX –≤–∞–ª–∏–¥–∞—Ü–∏—è (–∫–æ–≥–∞—Ç–æ ENABLE_POCX –µ –¥–µ—Ñ–∏–Ω–∏—Ä–∞–Ω):**
```cpp
if (block.nHeight > 0 && fCheckPOW) {
    // –ë–∞–∑–æ–≤–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø–æ–¥–ø–∏—Å (–±–µ–∑ –ø–æ–¥–¥—Ä—ä–∂–∫–∞ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ –æ—â–µ)
    if (!VerifyPoCXBlockCompactSignature(block)) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-pocx-sig");
    }
}
```

**–ë–∞–∑–æ–≤–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø–æ–¥–ø–∏—Å:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞ –Ω–∞–ª–∏—á–∏–µ –Ω–∞ –ø–æ–ª–µ—Ç–∞ –∑–∞ –ø—É–±–ª–∏—á–µ–Ω –∫–ª—é—á –∏ –ø–æ–¥–ø–∏—Å
2. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Ä–∞–∑–º–µ—Ä –Ω–∞ –ø—É–±–ª–∏—á–µ–Ω –∫–ª—é—á (33 –±–∞–π—Ç–∞ –∫–æ–º–ø—Ä–µ—Å–∏—Ä–∞–Ω)
3. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Ä–∞–∑–º–µ—Ä –Ω–∞ –ø–æ–¥–ø–∏—Å (65 –±–∞–π—Ç–∞ –∫–æ–º–ø–∞–∫—Ç–µ–Ω)
4. –í—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ –ø—É–±–ª–∏—á–µ–Ω –∫–ª—é—á –æ—Ç –ø–æ–¥–ø–∏—Å: `pubkey.RecoverCompact(hash, signature)`
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω–∏—è—Ç –ø—É–±–ª–∏—á–µ–Ω –∫–ª—é—á —Å—ä–≤–ø–∞–¥–∞ —Å—ä—Å —Å—ä—Ö—Ä–∞–Ω–µ–Ω–∏—è

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/validation.cpp:CheckBlockHeader()`
**–õ–æ–≥–∏–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å:** `src/pocx/consensus/pocx.cpp:VerifyPoCXBlockCompactSignature()`

### –ï—Ç–∞–ø 2: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –±–ª–æ–∫ (CheckBlock)

**–í–∞–ª–∏–¥–∏—Ä–∞:**
- –ö–æ—Ä–µ–∫—Ç–Ω–æ—Å—Ç –Ω–∞ Merkle root
- –í–∞–ª–∏–¥–Ω–æ—Å—Ç –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ò–∑–∏—Å–∫–≤–∞–Ω–∏—è –∑–∞ coinbase
- –õ–∏–º–∏—Ç–∏ –∑–∞ —Ä–∞–∑–º–µ—Ä –Ω–∞ –±–ª–æ–∫
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏ Bitcoin –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–∏ –ø—Ä–∞–≤–∏–ª–∞

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/consensus/validation.cpp:CheckBlock()`

### –ï—Ç–∞–ø 3: –ö–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∑–∞–≥–ª–∞–≤–∏–µ (ContextualCheckBlockHeader)

**PoCX-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è:**

```cpp
#ifdef ENABLE_POCX
    // –°—Ç—ä–ø–∫–∞ 1: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å
    uint256 expected_gen_sig = CalculateGenerationSignature(pindexPrev);
    if (block.generationSignature != expected_gen_sig) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-gen-sig");
    }

    // –°—Ç—ä–ø–∫–∞ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –±–∞–∑–æ–≤–∞ —Ü–µ–ª
    uint64_t expected_base_target = CalculateNextBaseTarget(pindexPrev, block.nTime);
    if (block.nBaseTarget != expected_base_target) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-diff");
    }

    // –°—Ç—ä–ø–∫–∞ 3: –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ proof of capacity
    auto compression_bounds = GetPoCXCompressionBounds(block.nHeight, halving_interval);
    auto result = ValidateProofOfCapacity(
        block.generationSignature,
        block.pocxProof,
        block.nBaseTarget,
        block.nHeight,
        compression_bounds.nPoCXMinCompression,
        compression_bounds.nPoCXTargetCompression,
        block_time
    );

    if (!result.is_valid) {
        return state.Invalid(BLOCK_INVALID_HEADER, "bad-pocx-proof");
    }

    // –°—Ç—ä–ø–∫–∞ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –≤—Ä–µ–º–µ—Ç–æ –Ω–∞ –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫
    uint32_t elapsed_time = block.nTime - pindexPrev->nTime;
    if (result.deadline > elapsed_time) {
        return state.Invalid(BLOCK_INVALID_HEADER, "pocx-deadline-not-met");
    }
#endif
```

**–°—Ç—ä–ø–∫–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è:**
1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å:** –¢—Ä—è–±–≤–∞ –¥–∞ —Å—ä–≤–ø–∞–¥–∞ —Å –∏–∑—á–∏—Å–ª–µ–Ω–∞—Ç–∞ —Å—Ç–æ–π–Ω–æ—Å—Ç –æ—Ç –ø—Ä–µ–¥–∏—à–Ω–∏—è –±–ª–æ–∫
2. **–ë–∞–∑–æ–≤–∞ —Ü–µ–ª:** –¢—Ä—è–±–≤–∞ –¥–∞ —Å—ä–≤–ø–∞–¥–∞ —Å –∏–∑—á–∏—Å–ª–µ–Ω–∏–µ—Ç–æ –∑–∞ –∫–æ—Ä–µ–∫—Ü–∏—è –Ω–∞ —Ç—Ä—É–¥–Ω–æ—Å—Ç
3. **–ù–∏–≤–æ –Ω–∞ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ:** –¢—Ä—è–±–≤–∞ –¥–∞ –æ—Ç–≥–æ–≤–∞—Ä—è –Ω–∞ –º–∏–Ω–∏–º—É–º–∞ –Ω–∞ –º—Ä–µ–∂–∞—Ç–∞ (`compression >= min_compression`)
4. **–î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –∑–∞ –∫–∞—á–µ—Å—Ç–≤–æ:** –ü–æ–¥–∞–¥–µ–Ω–æ—Ç–æ –∫–∞—á–µ—Å—Ç–≤–æ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å—ä–≤–ø–∞–¥–∞ —Å –∏–∑—á–∏—Å–ª–µ–Ω–æ—Ç–æ –∫–∞—á–µ—Å—Ç–≤–æ –æ—Ç –¥–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ—Ç–æ
5. **Proof of Capacity:** –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—Å–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ (SIMD-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω–∞)
6. **–í—Ä–µ–º–µ –Ω–∞ –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫:** Time-bended –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫ (`poc_time`) —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ ‚â§ –∏–∑–º–∏–Ω–∞–ª–æ—Ç–æ –≤—Ä–µ–º–µ

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/validation.cpp:ContextualCheckBlockHeader()`

### –ï—Ç–∞–ø 4: –°–≤—ä—Ä–∑–≤–∞–Ω–µ –Ω–∞ –±–ª–æ–∫ (ConnectBlock)

**–ü—ä–ª–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è:**

```cpp
#ifdef ENABLE_POCX
    // –†–∞–∑—à–∏—Ä–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø–æ–¥–ø–∏—Å —Å –ø–æ–¥–¥—Ä—ä–∂–∫–∞ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ
    if (pindex->nHeight > 0 && !fJustCheck) {
        if (!VerifyPoCXBlockCompactSignature(block, view, pindex->nHeight)) {
            return state.Invalid(BLOCK_CONSENSUS, "bad-pocx-assignment-sig");
        }
    }
#endif
```

**–†–∞–∑—à–∏—Ä–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø–æ–¥–ø–∏—Å:**
1. –ò–∑–≤—ä—Ä—à–≤–∞–Ω–µ –Ω–∞ –±–∞–∑–æ–≤–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –ø–æ–¥–ø–∏—Å
2. –ò–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ account ID –æ—Ç –≤—ä–∑—Å—Ç–∞–Ω–æ–≤–µ–Ω –ø—É–±–ª–∏—á–µ–Ω –∫–ª—é—á
3. –ü–æ–ª—É—á–∞–≤–∞–Ω–µ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø–æ–¥–ø–∏—Å–≤–∞—â –∑–∞ –∞–¥—Ä–µ—Å –Ω–∞ plot: `GetEffectiveSigner(plot_address, height, view)`
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –∞–∫–∞—É–Ω—Ç—ä—Ç –Ω–∞ –ø—É–±–ª–∏—á–Ω–∏—è –∫–ª—é—á —Å—ä–≤–ø–∞–¥–∞ —Å –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—è –ø–æ–¥–ø–∏—Å–≤–∞—â

**–õ–æ–≥–∏–∫–∞ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ:**
```cpp
std::array<uint8_t, 20> GetEffectiveSigner(
    const std::array<uint8_t, 20>& plotAddress,
    int nHeight,
    const CCoinsViewCache& view
) {
    auto assignment = view.GetForgingAssignment(plotAddress, nHeight);

    if (assignment.has_value() && assignment->IsActiveAtHeight(nHeight)) {
        return assignment->forgingAddress;  // –í—Ä—ä—â–∞–Ω–µ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω –ø–æ–¥–ø–∏—Å–≤–∞—â
    }

    return plotAddress;  // –ë–µ–∑ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ ‚Äî —Å–æ–±—Å—Ç–≤–µ–Ω–∏–∫—ä—Ç –Ω–∞ plot –ø–æ–¥–ø–∏—Å–≤–∞
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:**
- –°–≤—ä—Ä–∑–≤–∞–Ω–µ: `src/validation.cpp:ConnectBlock()`
- –†–∞–∑—à–∏—Ä–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è: `src/pocx/consensus/pocx.cpp:VerifyPoCXBlockCompactSignature()`
- –õ–æ–≥–∏–∫–∞ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ: `src/pocx/consensus/validation.cpp:GetEffectiveSigner()`

### –ï—Ç–∞–ø 5: –ê–∫—Ç–∏–≤–∏—Ä–∞–Ω–µ –Ω–∞ –≤–µ—Ä–∏–≥–∞

**–ü–æ—Ç–æ–∫ –Ω–∞ ProcessNewBlock:**
```cpp
bool ProcessNewBlock(const std::shared_ptr<const CBlock>& block,
                    bool force_processing,
                    bool min_pow_checked,
                    bool* new_block)
{
    1. AcceptBlock ‚Üí –í–∞–ª–∏–¥–∏—Ä–∞–Ω–µ –∏ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞–Ω–µ –Ω–∞ –¥–∏—Å–∫
    2. ActivateBestChain ‚Üí –ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –≤—ä—Ä—Ö–∞ –Ω–∞ –≤–µ—Ä–∏–≥–∞—Ç–∞ –∞–∫–æ —Ç–æ–≤–∞ –µ –Ω–∞–π-–¥–æ–±—Ä–∞—Ç–∞ –≤–µ—Ä–∏–≥–∞
    3. –£–≤–µ–¥–æ–º—è–≤–∞–Ω–µ –Ω–∞ –º—Ä–µ–∂–∞—Ç–∞ –∑–∞ –Ω–æ–≤ –±–ª–æ–∫
}
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/validation.cpp:ProcessNewBlock()`

### –û–±–æ–±—â–µ–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è—Ç–∞

**–ü—ä–ª–µ–Ω –ø—ä—Ç –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è:**
```
–ü–æ–ª—É—á–∞–≤–∞–Ω–µ –Ω–∞ –±–ª–æ–∫
    ‚Üì
CheckBlockHeader (–±–∞–∑–æ–≤ –ø–æ–¥–ø–∏—Å)
    ‚Üì
CheckBlock (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, merkle)
    ‚Üì
ContextualCheckBlockHeader (gen sig, –±–∞–∑–æ–≤–∞ —Ü–µ–ª, PoC –¥–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ, –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫)
    ‚Üì
ConnectBlock (—Ä–∞–∑—à–∏—Ä–µ–Ω –ø–æ–¥–ø–∏—Å —Å –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ, –ø—Ä–µ—Ö–æ–¥–∏ –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ)
    ‚Üì
ActivateBestChain (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Ä–µ–æ—Ä–≥, —Ä–∞–∑—à–∏—Ä—è–≤–∞–Ω–µ –Ω–∞ –≤–µ—Ä–∏–≥–∞)
    ‚Üì
–ú—Ä–µ–∂–æ–≤–æ —Ä–∞–∑–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ
```

---

## –°–∏—Å—Ç–µ–º–∞ –∑–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ

### –ü—Ä–µ–≥–ª–µ–¥

–î–µ–ª–µ–≥–∏—Ä–∞–Ω–∏—è—Ç–∞ –ø–æ–∑–≤–æ–ª—è–≤–∞—Ç –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–∏—Ü–∏—Ç–µ –Ω–∞ plot —Ñ–∞–π–ª–æ–≤–µ –¥–∞ –¥–µ–ª–µ–≥–∏—Ä–∞—Ç –ø—Ä–∞–≤–∞ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ –¥—Ä—É–≥–∏ –∞–¥—Ä–µ—Å–∏, –∫–∞—Ç–æ –∑–∞–ø–∞–∑–≤–∞—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–æ—Å—Ç—Ç–∞ –≤—ä—Ä—Ö—É plot —Ñ–∞–π–ª–æ–≤–µ—Ç–µ.

**–°–ª—É—á–∞–∏ –Ω–∞ —É–ø–æ—Ç—Ä–µ–±–∞:**
- –ö–æ–ø–∞–µ–Ω–µ –≤ –ø—É–ª (plot —Ñ–∞–π–ª–æ–≤–µ—Ç–µ —Å–µ –¥–µ–ª–µ–≥–∏—Ä–∞—Ç –Ω–∞ –∞–¥—Ä–µ—Å –Ω–∞ –ø—É–ª–∞)
- –°—Ç—É–¥–µ–Ω–æ —Å—ä—Ö—Ä–∞–Ω–µ–Ω–∏–µ (–∫–ª—é—á—ä—Ç –∑–∞ –∫–æ–ø–∞–µ–Ω–µ –µ –æ—Ç–¥–µ–ª–µ–Ω –æ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–æ—Å—Ç—Ç–∞ –≤—ä—Ä—Ö—É plot)
- –ú–Ω–æ–≥–æ—Å—Ç—Ä–∞–Ω–Ω–æ –∫–æ–ø–∞–µ–Ω–µ (—Å–ø–æ–¥–µ–ª–µ–Ω–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ

**–î–∏–∑–∞–π–Ω —Å–∞–º–æ —Å OP_RETURN:**
- –î–µ–ª–µ–≥–∏—Ä–∞–Ω–∏—è—Ç–∞ —Å–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞—Ç –≤ OP_RETURN –∏–∑—Ö–æ–¥–∏ (–±–µ–∑ UTXO)
- –ë–µ–∑ –∏–∑–∏—Å–∫–≤–∞–Ω–∏—è –∑–∞ —Ö–∞—Ä—á–µ–Ω–µ (–±–µ–∑ –ø—Ä–∞—Ö, –±–µ–∑ —Ç–∞–∫—Å–∏ –∑–∞ –¥—ä—Ä–∂–∞–Ω–µ)
- –ü—Ä–æ—Å–ª–µ–¥—è–≤–∞—Ç —Å–µ –≤ —Ä–∞–∑—à–∏—Ä–µ–Ω–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ CCoinsViewCache
- –ê–∫—Ç–∏–≤–∏—Ä–∞—Ç —Å–µ —Å–ª–µ–¥ –ø–µ—Ä–∏–æ–¥ –Ω–∞ –∑–∞–±–∞–≤—è–Ω–µ (–ø–æ –ø–æ–¥—Ä–∞–∑–±–∏—Ä–∞–Ω–µ: 4 –±–ª–æ–∫–∞)

**–°—ä—Å—Ç–æ—è–Ω–∏—è –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ:**
```cpp
enum class ForgingState : uint8_t {
    UNASSIGNED = 0,  // –ù–µ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ
    ASSIGNING = 1,   // –î–µ–ª–µ–≥–∏—Ä–∞–Ω–µ –≤ –æ—á–∞–∫–≤–∞–Ω–µ –Ω–∞ –∞–∫—Ç–∏–≤–∏—Ä–∞–Ω–µ (–ø–µ—Ä–∏–æ–¥ –Ω–∞ –∑–∞–±–∞–≤—è–Ω–µ)
    ASSIGNED = 2,    // –î–µ–ª–µ–≥–∏—Ä–∞–Ω–µ –∞–∫—Ç–∏–≤–Ω–æ, –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–æ
    REVOKING = 3,    // –û—Ç–º—è–Ω–∞ –≤ –æ—á–∞–∫–≤–∞–Ω–µ (–ø–µ—Ä–∏–æ–¥ –Ω–∞ –∑–∞–±–∞–≤—è–Ω–µ, –≤—Å–µ –æ—â–µ –∞–∫—Ç–∏–≤–Ω–æ)
    REVOKED = 4      // –û—Ç–º—è–Ω–∞ –∑–∞–≤—ä—Ä—à–µ–Ω–∞, –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ—Ç–æ –≤–µ—á–µ –Ω–µ –µ –∞–∫—Ç–∏–≤–Ω–æ
};
```

### –°—ä–∑–¥–∞–≤–∞–Ω–µ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–∏—è

**–§–æ—Ä–º–∞—Ç –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è:**
```cpp
Transaction {
    inputs: [any]  // –î–æ–∫–∞–∑–≤–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–æ—Å—Ç –≤—ä—Ä—Ö—É –∞–¥—Ä–µ—Å –Ω–∞ plot
    outputs: [
        OP_RETURN <ASSIGN_MAGIC> <plot_address> <forging_address>
    ]
}
```

**–ü—Ä–∞–≤–∏–ª–∞ –∑–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è:**
1. –í—Ö–æ–¥—ä—Ç —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ –ø–æ–¥–ø–∏—Å–∞–Ω –æ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–∏–∫–∞ –Ω–∞ plot (–¥–æ–∫–∞–∑–≤–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–æ—Å—Ç)
2. OP_RETURN —Å—ä–¥—ä—Ä–∂–∞ –≤–∞–ª–∏–¥–Ω–∏ –¥–∞–Ω–Ω–∏ –∑–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ
3. Plot —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ UNASSIGNED –∏–ª–∏ REVOKED
4. –ë–µ–∑ –¥—É–±–ª–∏—Ä–∞—â–∏ —Å–µ —á–∞–∫–∞—â–∏ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–∏—è –≤ mempool
5. –ü–ª–∞—Ç–µ–Ω–∞ –º–∏–Ω–∏–º–∞–ª–Ω–∞ —Ç–∞–∫—Å–∞ –∑–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è

**–ê–∫—Ç–∏–≤–∏—Ä–∞–Ω–µ:**
- –î–µ–ª–µ–≥–∏—Ä–∞–Ω–µ—Ç–æ —Å—Ç–∞–≤–∞ ASSIGNING –ø—Ä–∏ –≤–∏—Å–æ—á–∏–Ω–∞ –Ω–∞ –ø–æ—Ç–≤—ä—Ä–∂–¥–µ–Ω–∏–µ
- –°—Ç–∞–≤–∞ ASSIGNED —Å–ª–µ–¥ –ø–µ—Ä–∏–æ–¥ –Ω–∞ –∑–∞–±–∞–≤—è–Ω–µ (4 –±–ª–æ–∫–∞ regtest, 30 –±–ª–æ–∫–∞ mainnet)
- –ó–∞–±–∞–≤—è–Ω–µ—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞ –±—ä—Ä–∑–∏ –ø—Ä–µ–¥–µ–ª–µ–≥–∏—Ä–∞–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ –Ω–∞ —Å—ä—Å—Ç–µ–∑–∞–Ω–∏—è –∑–∞ –±–ª–æ–∫–æ–≤–µ

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** `src/script/forging_assignment.h`, –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤ ConnectBlock

### –û—Ç–º—è–Ω–∞ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–∏—è

**–§–æ—Ä–º–∞—Ç –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è:**
```cpp
Transaction {
    inputs: [any]  // –î–æ–∫–∞–∑–≤–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–æ—Å—Ç –≤—ä—Ä—Ö—É –∞–¥—Ä–µ—Å –Ω–∞ plot
    outputs: [
        OP_RETURN <REVOKE_MAGIC> <plot_address>
    ]
}
```

**–ï—Ñ–µ–∫—Ç:**
- –ù–µ–∑–∞–±–∞–≤–µ–Ω –ø—Ä–µ—Ö–æ–¥ –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –∫—ä–º REVOKED
- –°–æ–±—Å—Ç–≤–µ–Ω–∏–∫—ä—Ç –Ω–∞ plot –º–æ–∂–µ –¥–∞ –ø–æ–¥–ø–∏—Å–≤–∞ –Ω–µ–∑–∞–±–∞–≤–Ω–æ
- –ú–æ–∂–µ –¥–∞ —Å—ä–∑–¥–∞–¥–µ –Ω–æ–≤–æ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ —Å–ª–µ–¥ —Ç–æ–≤–∞

### –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ –ø—Ä–∏ –∫–æ–ø–∞–µ–Ω–µ

**–û–ø—Ä–µ–¥–µ–ª—è–Ω–µ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø–æ–¥–ø–∏—Å–≤–∞—â:**
```cpp
// –ü—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ submit_nonce
effective_signer = GetEffectiveSigner(plot_address, height, view);
if (!HaveAccountKey(effective_signer, wallet)) reject;

// –ü—Ä–∏ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ –Ω–∞ –±–ª–æ–∫
coinbase_script = P2WPKH(effective_signer);  // –ù–∞–≥—Ä–∞–¥–∞—Ç–∞ –æ—Ç–∏–≤–∞ —Ç—É–∫

// –ü—Ä–∏ –ø–æ–¥–ø–∏—Å –Ω–∞ –±–ª–æ–∫
signature = effective_signer_key.SignCompact(hash);  // –¢—Ä—è–±–≤–∞ –¥–∞ –ø–æ–¥–ø–∏—à–µ —Å –µ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø–æ–¥–ø–∏—Å–≤–∞—â
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –±–ª–æ–∫:**
```cpp
// –í VerifyPoCXBlockCompactSignature (—Ä–∞–∑—à–∏—Ä–µ–Ω–∞)
effective_signer = GetEffectiveSigner(proof.account_id, height, view);
pubkey_account = ExtractAccountIDFromPubKey(block.vchPubKey);
if (pubkey_account != effective_signer) reject;
```

**–ö–ª—é—á–æ–≤–∏ —Å–≤–æ–π—Å—Ç–≤–∞:**
- –î–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ—Ç–æ –≤–∏–Ω–∞–≥–∏ —Å—ä–¥—ä—Ä–∂–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª–Ω–∏—è –∞–¥—Ä–µ—Å –Ω–∞ plot
- –ü–æ–¥–ø–∏—Å—ä—Ç —Ç—Ä—è–±–≤–∞ –¥–∞ –±—ä–¥–µ –æ—Ç –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—è –ø–æ–¥–ø–∏—Å–≤–∞—â
- Coinbase –ø–ª–∞—â–∞ –Ω–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏—è –ø–æ–¥–ø–∏—Å–≤–∞—â
- –í–∞–ª–∏–¥–∞—Ü–∏—è—Ç–∞ –∏–∑–ø–æ–ª–∑–≤–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ –ø—Ä–∏ –≤–∏—Å–æ—á–∏–Ω–∞ –Ω–∞ –±–ª–æ–∫–∞

---

## –ú—Ä–µ–∂–æ–≤–æ —Ä–∞–∑–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ

### –û–±—è–≤—è–≤–∞–Ω–µ –Ω–∞ –±–ª–æ–∫

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω Bitcoin P2P –ø—Ä–æ—Ç–æ–∫–æ–ª:**
1. –ü–æ–¥–ø–∏—Å–∞–Ω–∏—è—Ç –±–ª–æ–∫ —Å–µ –ø–æ–¥–∞–≤–∞ —á—Ä–µ–∑ `ProcessNewBlock()`
2. –ë–ª–æ–∫—ä—Ç —Å–µ –≤–∞–ª–∏–¥–∏—Ä–∞ –∏ –¥–æ–±–∞–≤—è –∫—ä–º –≤–µ—Ä–∏–≥–∞—Ç–∞
3. –ú—Ä–µ–∂–æ–≤–æ —É–≤–µ–¥–æ–º—è–≤–∞–Ω–µ: `GetMainSignals().BlockConnected()`
4. P2P —Å–ª–æ—è—Ç —Ä–∞–∑–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–≤–∞ –±–ª–æ–∫–∞ –∫—ä–º –ø–∏—ä—Ä–∏

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:** –°—Ç–∞–Ω–¥–∞—Ä—Ç–µ–Ω Bitcoin Core net_processing

### –ü—Ä–µ–ø—Ä–µ–¥–∞–≤–∞–Ω–µ –Ω–∞ –±–ª–æ–∫

**–ö–æ–º–ø–∞–∫—Ç–Ω–∏ –±–ª–æ–∫–æ–≤–µ (BIP 152):**
- –ò–∑–ø–æ–ª–∑–≤–∞—Ç —Å–µ –∑–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ —Ä–∞–∑–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ –±–ª–æ–∫–æ–≤–µ
- –ü—ä—Ä–≤–æ–Ω–∞—á–∞–ª–Ω–æ —Å–µ –∏–∑–ø—Ä–∞—â–∞—Ç —Å–∞–º–æ ID –Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- –ü–∏—ä—Ä–∏—Ç–µ –∑–∞—è–≤—è–≤–∞—Ç –ª–∏–ø—Å–≤–∞—â–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–ü—Ä–µ–ø—Ä–µ–¥–∞–≤–∞–Ω–µ –Ω–∞ –ø—ä–ª–µ–Ω –±–ª–æ–∫:**
- –†–µ–∑–µ—Ä–≤–∞ –∫–æ–≥–∞—Ç–æ –∫–æ–º–ø–∞–∫—Ç–Ω–∏—Ç–µ –±–ª–æ–∫–æ–≤–µ —Å–µ –ø—Ä–æ–≤–∞–ª—è—Ç
- –ü—Ä–µ–¥–∞–≤–∞—Ç —Å–µ –ø—ä–ª–Ω–∏ –¥–∞–Ω–Ω–∏ –Ω–∞ –±–ª–æ–∫

### –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –Ω–∞ –≤–µ—Ä–∏–≥–∞

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏:**
```cpp
// –í —Ä–∞–±–æ—Ç–Ω–∏—á–µ—Å–∫–∞—Ç–∞ –Ω–∏—à–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å–≤–∞—â–∏—è
if (current_tip_hash != stored_tip_hash) {
    // –û—Ç–∫—Ä–∏—Ç–∞ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –Ω–∞ –≤–µ—Ä–∏–≥–∞
    reset_forging_state();
    log("–í—ä—Ä—Ö—ä—Ç –Ω–∞ –≤–µ—Ä–∏–≥–∞—Ç–∞ —Å–µ –ø—Ä–æ–º–µ–Ω–∏, –Ω—É–ª–∏—Ä–∞–Ω–µ –Ω–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ");
}
```

**–ù–∞ –Ω–∏–≤–æ –±–ª–æ–∫—á–µ–π–Ω:**
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –æ—Ç Bitcoin Core
- –ù–∞–π-–¥–æ–±—Ä–∞—Ç–∞ –≤–µ—Ä–∏–≥–∞ —Å–µ –æ–ø—Ä–µ–¥–µ–ª—è –æ—Ç chainwork
- –û—Ç–≤—ä—Ä–∑–∞–Ω–∏—Ç–µ –±–ª–æ–∫–æ–≤–µ —Å–µ –≤—Ä—ä—â–∞—Ç –≤ mempool

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–µ—Ç–∞–π–ª–∏

### –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞–Ω–µ –Ω–∞ Deadlock

**ABBA Deadlock –º–æ–¥–µ–ª (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–µ–Ω):**
```
–ù–∏—à–∫–∞ A: cs_main ‚Üí cs_wallet
–ù–∏—à–∫–∞ B: cs_wallet ‚Üí cs_main
```

**–†–µ—à–µ–Ω–∏–µ:**
1. **submit_nonce:** –ù—É–ª–µ–≤–æ –∏–∑–ø–æ–ª–∑–≤–∞–Ω–µ –Ω–∞ cs_main
   - `GetNewBlockContext()` –æ–±—Ä–∞–±–æ—Ç–≤–∞ –∑–∞–∫–ª—é—á–≤–∞–Ω–µ—Ç–æ –≤—ä—Ç—Ä–µ—à–Ω–æ
   - –¶—è–ª–∞—Ç–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–µ–¥–∏ –ø–æ–¥–∞–≤–∞–Ω–µ –∫—ä–º –ø–æ–¥–ø–∏—Å–≤–∞—â–∏—è

2. **–ü–æ–¥–ø–∏—Å–≤–∞—â:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –±–∞–∑–∏—Ä–∞–Ω–∞ –Ω–∞ –æ–ø–∞—à–∫–∞
   - –ï–¥–Ω–∞ —Ä–∞–±–æ—Ç–Ω–∏—á–µ—Å–∫–∞ –Ω–∏—à–∫–∞ (–±–µ–∑ thread joins)
   - –°–≤–µ–∂ –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–∏ –≤—Å–µ–∫–∏ –¥–æ—Å—Ç—ä–ø
   - –ë–µ–∑ –≤–ª–æ–∂–µ–Ω–∏ –∑–∞–∫–ª—é—á–≤–∞–Ω–∏—è

3. **–ü—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ –ø–æ—Ä—Ç—Ñ–µ–π–ª:** –ò–∑–≤—ä—Ä—à–≤–∞—Ç —Å–µ –ø—Ä–µ–¥–∏ —Å–∫—ä–ø–∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
   - –†–∞–Ω–Ω–æ –æ—Ç—Ö–≤—ä—Ä–ª—è–Ω–µ –∞–∫–æ –Ω—è–º–∞ –Ω–∞–ª–∏—á–µ–Ω –∫–ª—é—á
   - –û—Ç–¥–µ–ª–µ–Ω–æ –æ—Ç –¥–æ—Å—Ç—ä–ø –¥–æ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç

**–ë—ä—Ä–∑ –æ—Ç–∫–∞–∑ –ø—Ä–∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è:**
```cpp
1. –ü—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Ñ–æ—Ä–º–∞—Ç (–Ω–µ–∑–∞–±–∞–≤–Ω–∏)
2. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç (–ª–µ–∫–∞)
3. –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –ø–æ—Ä—Ç—Ñ–µ–π–ª (–ª–æ–∫–∞–ª–Ω–∞)
4. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ (—Å–∫—ä–ø–∞ SIMD)
```

**–ï–¥–∏–Ω–∏—á–Ω–æ –∏–∑–≤–ª–∏—á–∞–Ω–µ –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç:**
- –ï–¥–Ω–æ –∏–∑–≤–∏–∫–≤–∞–Ω–µ –Ω–∞ `GetNewBlockContext()` –Ω–∞ –ø–æ–¥–∞–≤–∞–Ω–µ
- –ö–µ—à–∏—Ä–∞–Ω–µ –Ω–∞ —Ä–µ–∑—É–ª—Ç–∞—Ç–∏ –∑–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ë–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–∏ cs_main –∑–∞–∫–ª—é—á–≤–∞–Ω–∏—è

**–ï—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç –Ω–∞ –æ–ø–∞—à–∫–∞:**
- –õ–µ–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞ –ø–æ–¥–∞–≤–∞–Ω–µ
- –ë–µ–∑ base_target/deadline –≤ –æ–ø–∞—à–∫–∞—Ç–∞ (–ø—Ä–µ–∏–∑—á–∏—Å–ª—è–≤–∞—Ç —Å–µ —Å–≤–µ–∂–∏)
- –ú–∏–Ω–∏–º–∞–ª–µ–Ω –æ—Ç–ø–µ—á–∞—Ç—ä–∫ –≤ –ø–∞–º–µ—Ç—Ç–∞

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ –æ—Å—Ç–∞—Ä—è–ª–æ—Å—Ç

**"–ü—Ä–æ—Å—Ç" –¥–∏–∑–∞–π–Ω –Ω–∞ –ø–æ–¥–ø–∏—Å–≤–∞—â–∏—è:**
- –ë–µ–∑ –∞–±–æ–Ω–∞–º–µ–Ω—Ç–∏ –∑–∞ —Å—ä–±–∏—Ç–∏—è –Ω–∞ –±–ª–æ–∫—á–µ–π–Ω–∞
- –ú—ä—Ä–∑–µ–ª–∏–≤–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–≥–∞—Ç–æ –µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞
- –¢–∏—Ö–æ –æ—Ç—Ö–≤—ä—Ä–ª—è–Ω–µ –Ω–∞ –æ—Å—Ç–∞—Ä–µ–ª–∏ –ø–æ–¥–∞–≤–∞–Ω–∏—è

**–ü—Ä–µ–¥–∏–º—Å—Ç–≤–∞:**
- –ü—Ä–æ—Å—Ç–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ë–µ–∑ —Å–ª–æ–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç –∫—ä–º –≥—Ä–∞–Ω–∏—á–Ω–∏ —Å–ª—É—á–∞–∏

**–û–±—Ä–∞–±–æ—Ç–µ–Ω–∏ –≥—Ä–∞–Ω–∏—á–Ω–∏ —Å–ª—É—á–∞–∏:**
- –ü—Ä–æ–º–µ–Ω–∏ –Ω–∞ –≤–∏—Å–æ—á–∏–Ω–∞ ‚Üí –æ—Ç—Ö–≤—ä—Ä–ª—è–Ω–µ
- –ü—Ä–æ–º–µ–Ω–∏ –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å ‚Üí –æ—Ç—Ö–≤—ä—Ä–ª—è–Ω–µ
- –ü—Ä–æ–º–µ–Ω–∏ –Ω–∞ –±–∞–∑–æ–≤–∞ —Ü–µ–ª ‚Üí –ø—Ä–µ–∏–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫
- –†–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ ‚Üí –Ω—É–ª–∏—Ä–∞–Ω–µ –Ω–∞ —Å—ä—Å—Ç–æ—è–Ω–∏–µ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ

### –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—Å–∫–∏ –¥–µ—Ç–∞–π–ª–∏

**–ì–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å:**
```cpp
SHA256(prev_generation_signature || prev_miner_pubkey_33bytes)
```

**–•–µ—à –∑–∞ –ø–æ–¥–ø–∏—Å –Ω–∞ –±–ª–æ–∫:**
```cpp
hash = SHA256(SHA256("POCX Signed Block:\n" || block_hash_hex))
```

**–ö–æ–º–ø–∞–∫—Ç–µ–Ω —Ñ–æ—Ä–º–∞—Ç –Ω–∞ –ø–æ–¥–ø–∏—Å:**
- 65 –±–∞–π—Ç–∞: [recovery_id][r][s]
- –ü–æ–∑–≤–æ–ª—è–≤–∞ –≤—ä–∑—Å—Ç–∞–Ω–æ–≤—è–≤–∞–Ω–µ –Ω–∞ –ø—É–±–ª–∏—á–µ–Ω –∫–ª—é—á
- –ò–∑–ø–æ–ª–∑–≤–∞ —Å–µ –∑–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç –Ω–∞ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ—Ç–æ

**Account ID:**
- 20-–±–∞–π—Ç–æ–≤ HASH160 –Ω–∞ –∫–æ–º–ø—Ä–µ—Å–∏—Ä–∞–Ω –ø—É–±–ª–∏—á–µ–Ω –∫–ª—é—á
- –°—ä–≤–ø–∞–¥–∞ —Å Bitcoin —Ñ–æ—Ä–º–∞—Ç–∏ –Ω–∞ –∞–¥—Ä–µ—Å–∏ (P2PKH, P2WPKH)

### –ë—ä–¥–µ—â–∏ –ø–æ–¥–æ–±—Ä–µ–Ω–∏—è

**–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–∞–Ω–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
1. –ë–µ–∑ –º–µ—Ç—Ä–∏–∫–∏ –∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª–Ω–æ—Å—Ç (—á–µ—Å—Ç–æ—Ç–∞ –Ω–∞ –ø–æ–¥–∞–≤–∞–Ω–µ, —Ä–∞–∑–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞ –∫—Ä–∞–π–Ω–∏ —Å—Ä–æ–∫–æ–≤–µ)
2. –ë–µ–∑ –¥–µ—Ç–∞–π–ª–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –≥—Ä–µ—à–∫–∏ –∑–∞ –º–∏–Ω—å–æ—Ä–∏
3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –∑–∞—è–≤—è–≤–∞–Ω–µ –Ω–∞ —Å—Ç–∞—Ç—É—Å –Ω–∞ –ø–æ–¥–ø–∏—Å–≤–∞—â–∏—è (—Ç–µ–∫—É—â –∫—Ä–∞–µ–Ω —Å—Ä–æ–∫, –¥—ä–ª–±–æ—á–∏–Ω–∞ –Ω–∞ –æ–ø–∞—à–∫–∞)

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª–Ω–∏ –ø–æ–¥–æ–±—Ä–µ–Ω–∏—è:**
- RPC –∑–∞ —Å—Ç–∞—Ç—É—Å –Ω–∞ –ø–æ–¥–ø–∏—Å–≤–∞—â–∏—è
- –ú–µ—Ç—Ä–∏–∫–∏ –∑–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç –Ω–∞ –∫–æ–ø–∞–µ–Ω–µ
- –ü–æ–¥–æ–±—Ä–µ–Ω–æ –ª–æ–≥–≤–∞–Ω–µ –∑–∞ –¥–µ–±—ä–≥–≤–∞–Ω–µ
- –ü–æ–¥–¥—Ä—ä–∂–∫–∞ –Ω–∞ –ø—Ä–æ—Ç–æ–∫–æ–ª –∑–∞ –ø—É–ª

---

## –ü—Ä–µ–ø—Ä–∞—Ç–∫–∏ –∫—ä–º –∫–æ–¥

**–û—Å–Ω–æ–≤–Ω–∏ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏–∏:**
- RPC –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `src/pocx/rpc/mining.cpp`
- –û–ø–∞—à–∫–∞ –∑–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ: `src/pocx/mining/scheduler.cpp`
- –ö–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è: `src/pocx/consensus/validation.cpp`
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—Å—Ç–≤–æ: `src/pocx/consensus/pocx.cpp`
- Time Bending: `src/pocx/algorithms/time_bending.cpp`
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –±–ª–æ–∫: `src/validation.cpp` (CheckBlockHeader, ConnectBlock)
- –õ–æ–≥–∏–∫–∞ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ: `src/pocx/consensus/validation.cpp:GetEffectiveSigner()`
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç: `src/pocx/node/node.cpp:GetNewBlockContext()`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∏ –æ—Ç –¥–∞–Ω–Ω–∏:**
- –§–æ—Ä–º–∞—Ç –Ω–∞ –±–ª–æ–∫: `src/primitives/block.h`
- –ö–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏: `src/consensus/params.h`
- –ü—Ä–æ—Å–ª–µ–¥—è–≤–∞–Ω–µ –Ω–∞ –¥–µ–ª–µ–≥–∏—Ä–∞–Ω–µ: `src/coins.h` (—Ä–∞–∑—à–∏—Ä–µ–Ω–∏—è –Ω–∞ CCoinsViewCache)

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∏

### –§–æ—Ä–º—É–ª–∞ –Ω–∞ Time Bending

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞ –¥–µ—Ñ–∏–Ω–∏—Ü–∏—è:**
```
deadline_seconds = quality / base_target  (—Å—É—Ä–æ–≤)

time_bended_deadline = scale * (deadline_seconds)^(1/3)

–∫—ä–¥–µ—Ç–æ:
  scale = block_time / (cbrt(block_time) * Gamma(4/3))
  Gamma(4/3) ‚âà 0.892979511
```

**–ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è:**
- –ê—Ä–∏—Ç–º–µ—Ç–∏–∫–∞ —Å —Ñ–∏–∫—Å–∏—Ä–∞–Ω–∞ —Ç–æ—á–∫–∞ (Q42 —Ñ–æ—Ä–º–∞—Ç)
- –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –∫—É–±–∏—á–µ–Ω –∫–æ—Ä–µ–Ω —Å–∞–º–æ —Å —Ü–µ–ª–∏ —á–∏—Å–ª–∞
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–∞–Ω–∞ –∑–∞ 256-–±–∏—Ç–æ–≤–∞ –∞—Ä–∏—Ç–º–µ—Ç–∏–∫–∞

### –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ

**–ü—Ä–æ—Ü–µ—Å:**
1. –ì–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ scoop –æ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–æ–Ω–µ–Ω –ø–æ–¥–ø–∏—Å –∏ –≤–∏—Å–æ—á–∏–Ω–∞
2. –ß–µ—Ç–µ–Ω–µ –Ω–∞ plot –¥–∞–Ω–Ω–∏ –∑–∞ –∏–∑—á–∏—Å–ª–µ–Ω–∏—è scoop
3. –•–µ—à: `SHABAL256(generation_signature || scoop_data)`
4. –¢–µ—Å—Ç–≤–∞–Ω–µ –Ω–∞ –Ω–∏–≤–∞ –Ω–∞ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ –æ—Ç min –¥–æ max
5. –í—Ä—ä—â–∞–Ω–µ –Ω–∞ –Ω–∞–π-–¥–æ–±—Ä–æ—Ç–æ –Ω–∞–º–µ—Ä–µ–Ω–æ –∫–∞—á–µ—Å—Ç–≤–æ

**–ú–∞—â–∞–±–∏—Ä–∞–Ω–µ:**
- –ù–∏–≤–æ X0: POC2 –±–∞–∑–æ–≤–∞ –ª–∏–Ω–∏—è (—Ç–µ–æ—Ä–µ—Ç–∏—á–Ω–æ)
- –ù–∏–≤–æ X1: XOR-transpose –±–∞–∑–æ–≤–∞ –ª–∏–Ω–∏—è
- –ù–∏–≤–æ Xn: 2^(n-1) √ó X1 —Ä–∞–±–æ—Ç–∞ –≤–≥—Ä–∞–¥–µ–Ω–∞
- –ü–æ-–≤–∏—Å–æ–∫–æ –º–∞—â–∞–±–∏—Ä–∞–Ω–µ = –ø–æ–≤–µ—á–µ —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–µ –Ω–∞ plot

### –ö–æ—Ä–µ–∫—Ü–∏—è –Ω–∞ –±–∞–∑–æ–≤–∞ —Ü–µ–ª

**–ö–æ—Ä–µ–∫—Ü–∏—è –ø—Ä–∏ –≤—Å–µ–∫–∏ –±–ª–æ–∫:**
1. –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –ø–ª–∞–≤–∞—â–∞ —Å—Ä–µ–¥–Ω–∞ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ç–µ –±–∞–∑–æ–≤–∏ —Ü–µ–ª–∏
2. –ò–∑—á–∏—Å–ª—è–≤–∞–Ω–µ –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –ø–µ—Ä–∏–æ–¥ —Å–ø—Ä—è–º–æ —Ü–µ–ª–µ–≤–∏ –ø–µ—Ä–∏–æ–¥ –∑–∞ –ø–ª–∞–≤–∞—â –ø—Ä–æ–∑–æ—Ä–µ—Ü
3. –ü—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª–Ω–∞ –∫–æ—Ä–µ–∫—Ü–∏—è –Ω–∞ –±–∞–∑–æ–≤–∞ —Ü–µ–ª
4. –û–≥—Ä–∞–Ω–∏—á–∞–≤–∞–Ω–µ –∑–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç—è–≤–∞–Ω–µ –Ω–∞ –µ–∫—Å—Ç—Ä–µ–º–Ω–∏ –ø—Ä–æ–º–µ–Ω–∏

**–§–æ—Ä–º—É–ª–∞:**
```
avg_base_target = moving_average(–ø–æ—Å–ª–µ–¥–Ω–∏ –±–∞–∑–æ–≤–∏ —Ü–µ–ª–∏)
adjustment_factor = actual_timespan / target_timespan
new_base_target = avg_base_target * adjustment_factor
new_base_target = clamp(new_base_target, min, max)
```

---

*–¢–∞–∑–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ—Ç—Ä–∞–∑—è–≤–∞ –ø—ä–ª–Ω–∞—Ç–∞ PoCX –∫–æ–Ω—Å–µ–Ω—Å—É—Å–Ω–∞ –∏–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –∫—ä–º –æ–∫—Ç–æ–º–≤—Ä–∏ 2025.*

---

[‚Üê –ù–∞–∑–∞–¥: –§–æ—Ä–º–∞—Ç –Ω–∞ Plot —Ñ–∞–π–ª–æ–≤–µ—Ç–µ](2-plot-format.md) | [üìò –°—ä–¥—ä—Ä–∂–∞–Ω–∏–µ](index.md) | [–ù–∞–ø—Ä–µ–¥: –î–µ–ª–µ–≥–∏—Ä–∞–Ω–µ –Ω–∞ –ø–æ–¥–ø–∏—Å–≤–∞–Ω–µ ‚Üí](4-forging-assignments.md)
