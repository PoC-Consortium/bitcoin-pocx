[📘 תוכן העניינים](index.md) | [הבא: פורמט Plot →](2-plot-format.md)

---

# פרק 1: מבוא וסקירה כללית

## מהו Bitcoin-PoCX?

Bitcoin-PoCX הוא אינטגרציה של Bitcoin Core המוסיפה תמיכה בקונצנזוס **Proof of Capacity neXt generation (PoCX)**. הוא שומר על הארכיטקטורה הקיימת של Bitcoin Core תוך הפעלת חלופת כרייה יעילה אנרגטית מבוססת Proof of Capacity כתחליף מלא ל-Proof of Work.

**הבחנה מרכזית**: זוהי **שרשרת חדשה** ללא תאימות לאחור עם Bitcoin PoW. בלוקי PoCX אינם תואמים לצמתי PoW בתכנון.

---

## זהות הפרויקט

- **ארגון**: Proof of Capacity Consortium
- **שם הפרויקט**: Bitcoin-PoCX
- **שם מלא**: Bitcoin Core with PoCX Integration
- **סטטוס**: שלב רשת בדיקה

---

## מהו Proof of Capacity?

Proof of Capacity (PoC) הוא מנגנון קונצנזוס בו כוח הכרייה פרופורציונלי ל**שטח דיסק** ולא לכוח חישובי. כורים מייצרים מראש קובצי plot גדולים המכילים ערכי hash קריפטוגרפיים, ואז משתמשים ב-plots אלה למציאת פתרונות בלוק תקפים.

**יעילות אנרגטית**: קובצי plot נוצרים פעם אחת ומשמשים ללא הגבלה. הכרייה צורכת מעט מאוד כוח מעבד - בעיקר קלט/פלט דיסק.

**שיפורי PoCX**:
- תוקנה התקפת דחיסת XOR-transpose (פשרה של 50% זמן-זיכרון ב-POC2)
- פריסה מיושרת ל-16 nonces לחומרה מודרנית
- proof-of-work מדורג בייצור plots (רמות סילום Xn)
- אינטגרציית C++ טבעית ישירות ל-Bitcoin Core
- אלגוריתם עיקום זמן (Time Bending) לשיפור התפלגות זמני בלוקים

---

## סקירת ארכיטקטורה

### מבנה המאגר

```
bitcoin-pocx/
├── bitcoin/             # Bitcoin Core v30.0 + אינטגרציית PoCX
│   └── src/pocx/        # יישום PoCX
├── pocx/                # מסגרת ליבת PoCX (תת-מודול, קריאה בלבד)
└── docs/                # תיעוד זה
```

### פילוסופיית אינטגרציה

**משטח אינטגרציה מינימלי**: שינויים מבודדים בספריית `/src/pocx/` עם קרסים נקיים לשכבות האימות, הכרייה, וה-RPC של Bitcoin Core.

**סימון תכונות**: כל השינויים תחת משמרות קדם-מעבד `#ifdef ENABLE_POCX`. Bitcoin Core נבנה כרגיל כאשר הוא מושבת.

**תאימות upstream**: סנכרון קבוע עם עדכוני Bitcoin Core נשמר דרך נקודות אינטגרציה מבודדות.

**יישום C++ טבעי**: אלגוריתמים קריפטוגרפיים סקלריים (Shabal256, חישוב scoop, דחיסה) משולבים ישירות ב-Bitcoin Core לאימות קונצנזוס.

---

## תכונות מפתח

### 1. החלפת קונצנזוס מלאה

- **מבנה בלוק**: שדות ספציפיים ל-PoCX מחליפים את nonce וסיביות הקושי של PoW
  - חתימת יצירה (אנטרופיית כרייה דטרמיניסטית)
  - Base target (הפוך של קושי)
  - הוכחת PoCX (מזהה חשבון, seed, nonce)
  - חתימת בלוק (מוכיחה בעלות על plot)

- **אימות**: צינור אימות של 5 שלבים מבדיקת כותרת ועד חיבור בלוק

- **התאמת קושי**: התאמה בכל בלוק באמצעות ממוצע נע של base targets אחרונים

### 2. אלגוריתם עיקום זמן

**בעיה**: זמני בלוקים מסורתיים ב-PoC עוקבים אחר התפלגות מעריכית, מה שמוביל לבלוקים ארוכים כאשר אף כורה לא מוצא פתרון טוב.

**פתרון**: טרנספורמציית התפלגות ממעריכית לכי-ריבוע באמצעות שורש שלישי: `Y = scale × (X^(1/3))`.

**אפקט**: פתרונות טובים מאוד מתכווצים מאוחר יותר (לרשת יש זמן לסרוק את כל הדיסקים, מפחית בלוקים מהירים), פתרונות גרועים משופרים. זמן בלוק ממוצע נשמר ב-120 שניות, בלוקים ארוכים מופחתים.

**פרטים**: [פרק 3: קונצנזוס וכרייה](3-consensus-and-mining.md)

### 3. מערכת הקצאות כרייה

**יכולת**: בעלי plots יכולים להאציל זכויות כרייה לכתובות אחרות תוך שמירה על בעלות ה-plot.

**מקרי שימוש**:
- כריית בריכה (plots מוקצים לכתובת הבריכה)
- אחסון קר (מפתח כרייה נפרד מבעלות plot)
- כרייה רב-צדדית (תשתית משותפת)

**ארכיטקטורה**: עיצוב OP_RETURN בלבד - אין UTXOs מיוחדים, הקצאות נעקבות בנפרד במסד נתוני chainstate.

**פרטים**: [פרק 4: הקצאות כרייה](4-forging-assignments.md)

### 4. כרייה הגנתית

**בעיה**: שעונים מהירים יכולים לספק יתרונות תזמון בתוך סבילות העתיד של 15 שניות.

**פתרון**: כאשר מתקבל בלוק מתחרה באותו גובה, בדוק אוטומטית את האיכות המקומית. אם טובה יותר, כרה מיד.

**אפקט**: מבטל תמריץ למניפולציית שעון - שעונים מהירים עוזרים רק אם כבר יש לך את הפתרון הטוב ביותר.

**פרטים**: [פרק 5: אבטחת תזמון](5-timing-security.md)

### 5. סילום דחיסה דינמי

**יישור כלכלי**: דרישות רמת סילום עולות בלוח זמנים מעריכי (שנים 4, 12, 28, 60, 124 = חצאיות 1, 3, 7, 15, 31).

**אפקט**: ככל שתגמולי בלוקים יורדים, קושי ייצור plots עולה. שומר על מרווח בטיחות בין עלויות יצירת plot לעלויות חיפוש.

**מונע**: ניפוח קיבולת מחומרה מהירה יותר לאורך זמן.

**פרטים**: [פרק 6: פרמטרי רשת](6-network-parameters.md)

---

## פילוסופיית עיצוב

### בטיחות קוד

- תכנות הגנתי לאורך כל הדרך
- טיפול מקיף בשגיאות בנתיבי אימות
- ללא נעילות מקוננות (מניעת קיפאון)
- פעולות מסד נתונים אטומיות (UTXO + הקצאות יחד)

### ארכיטקטורה מודולרית

- הפרדה נקייה בין תשתית Bitcoin Core לקונצנזוס PoCX
- מסגרת ליבת PoCX מספקת פרימיטיבים קריפטוגרפיים
- Bitcoin Core מספק מסגרת אימות, מסד נתונים, רשתות

### אופטימיזציות ביצועים

- סדר אימות fail-fast (בדיקות זולות קודם)
- אחזור הקשר יחיד להגשה (ללא רכישות cs_main חוזרות)
- פעולות מסד נתונים אטומיות לעקביות

### בטיחות שרשור מחדש

- נתוני undo מלאים לשינויי מצב הקצאות
- איפוס מצב כרייה בשינויי קצה שרשרת
- זיהוי התיישנות בכל נקודות האימות

---

## כיצד PoCX שונה מ-Proof of Work

| היבט | Bitcoin (PoW) | Bitcoin-PoCX |
|--------|---------------|--------------|
| **משאב כרייה** | כוח חישובי (קצב hash) | שטח דיסק (קיבולת) |
| **צריכת אנרגיה** | גבוהה (hashing רציף) | נמוכה (קלט/פלט דיסק בלבד) |
| **תהליך כרייה** | מצא nonce עם hash < יעד | מצא nonce עם deadline < זמן שעבר |
| **קושי** | שדה `bits`, מותאם כל 2016 בלוקים | שדה `base_target`, מותאם כל בלוק |
| **זמן בלוק** | ~10 דקות (התפלגות מעריכית) | 120 שניות (מעוקם זמן, שונות מופחתת) |
| **סבסידיה** | 50 BTC → 25 → 12.5 → ... | 10 BTC → 5 → 2.5 → ... |
| **חומרה** | ASICs (מיוחדת) | HDDs (חומרה סחורתית) |
| **זהות כרייה** | אנונימי | בעל plot או נציג |

---

## דרישות מערכת

### הפעלת צומת

**זהה ל-Bitcoin Core**:
- **מעבד**: מעבד x86_64 מודרני
- **זיכרון**: 4-8 GB RAM
- **אחסון**: שרשרת חדשה, כרגע ריקה (יכולה לגדול ~4× מהר יותר מ-Bitcoin עקב בלוקים של 2 דקות ומסד נתוני הקצאות)
- **רשת**: חיבור אינטרנט יציב
- **שעון**: סנכרון NTP מומלץ לפעולה אופטימלית

**הערה**: קובצי plot אינם נדרשים להפעלת צומת.

### דרישות כרייה

**דרישות נוספות לכרייה**:
- **קובצי Plot**: מיוצרים מראש באמצעות `pocx_plotter` (יישום הייחוס)
- **תוכנת כרייה**: `pocx_miner` (יישום הייחוס) מתחבר דרך RPC
- **ארנק**: `bitcoind` או `bitcoin-qt` עם מפתחות פרטיים לכתובת כרייה. כריית בריכה אינה דורשת ארנק מקומי.

---

## התחלה

### 1. בניית Bitcoin-PoCX

```bash
# שיבוט עם תת-מודולים
git clone --recursive https://github.com/PoC-Consortium/bitcoin-pocx.git
cd bitcoin-pocx/bitcoin

# בנייה עם PoCX מופעל
cmake -B build -DENABLE_POCX=ON
cmake --build build
```

**פרטים**: ראו `CLAUDE.md` בשורש המאגר

### 2. הפעלת צומת

**צומת בלבד**:
```bash
./build/bin/bitcoind
# או
./build/bin/bitcoin-qt
```

**לכרייה** (מאפשר גישת RPC לכורים חיצוניים):
```bash
./build/bin/bitcoind -miningserver
# או
./build/bin/bitcoin-qt -server -miningserver
```

**פרטים**: [פרק 6: פרמטרי רשת](6-network-parameters.md)

### 3. יצירת קובצי Plot

השתמשו ב-`pocx_plotter` (יישום הייחוס) ליצירת קובצי plot בפורמט PoCX.

**פרטים**: [פרק 2: פורמט Plot](2-plot-format.md)

### 4. הגדרת כרייה

השתמשו ב-`pocx_miner` (יישום הייחוס) להתחברות לממשק RPC של הצומת שלכם.

**פרטים**: [פרק 7: עיון ב-RPC](7-rpc-reference.md) ו[פרק 8: מדריך ארנק](8-wallet-guide.md)

---

## ייחוס

### פורמט Plot

מבוסס על פורמט POC2 (Burstcoin) עם שיפורים:
- תוקנה פגיעות אבטחה (התקפת דחיסת XOR-transpose)
- proof-of-work מדורג
- פריסה מותאמת ל-SIMD
- פונקציונליות seed

### פרויקטי מקור

- **pocx_miner**: יישום הייחוס מבוסס על [scavenger](https://github.com/PoC-Consortium/scavenger)
- **pocx_plotter**: יישום הייחוס מבוסס על [engraver](https://github.com/PoC-Consortium/engraver)

**ייחוס מלא**: [פרק 2: פורמט Plot](2-plot-format.md)

---

## סיכום מפרטים טכניים

- **זמן בלוק**: 120 שניות (mainnet), שנייה אחת (regtest)
- **סבסידיית בלוק**: 10 BTC ראשוני, חצייה כל 1050000 בלוקים (~4 שנים)
- **היצע כולל**: ~21 מיליון BTC (זהה ל-Bitcoin)
- **סבילות עתיד**: 15 שניות (בלוקים עד 15 שניות קדימה מתקבלים)
- **אזהרת שעון**: 10 שניות (מזהיר מפעילים על סחיפת זמן)
- **עיכוב הקצאה**: 30 בלוקים (~שעה)
- **עיכוב ביטול**: 720 בלוקים (~24 שעות)
- **פורמט כתובת**: P2WPKH בלבד (bech32, pocx1q...) לפעולות כריית PoCX והקצאות כרייה

---

## ארגון קוד

**שינויי Bitcoin Core**: שינויים מינימליים לקובצי ליבה, מסומנים עם `#ifdef ENABLE_POCX`

**יישום PoCX חדש**: מבודד בספריית `src/pocx/`

---

## שיקולי אבטחה

### אבטחת תזמון

- סבילות עתיד של 15 שניות מונעת פיצול רשת
- סף אזהרה של 10 שניות מתריע למפעילים על סחיפת שעון
- כרייה הגנתית מבטלת תמריץ למניפולציית שעון
- עיקום זמן מפחית השפעת שונות תזמון

**פרטים**: [פרק 5: אבטחת תזמון](5-timing-security.md)

### אבטחת הקצאות

- עיצוב OP_RETURN בלבד (ללא מניפולציית UTXO)
- חתימת עסקה מוכיחה בעלות plot
- עיכובי הפעלה מונעים מניפולציית מצב מהירה
- נתוני undo בטוחים לשרשור מחדש לכל שינויי מצב

**פרטים**: [פרק 4: הקצאות כרייה](4-forging-assignments.md)

### אבטחת קונצנזוס

- חתימה מוחרגת מ-hash בלוק (מונעת גמישות)
- גדלי חתימה מוגבלים (מונע DoS)
- אימות גבולות דחיסה (מונע הוכחות חלשות)
- התאמת קושי בכל בלוק (תגובתי לשינויי קיבולת)

**פרטים**: [פרק 3: קונצנזוס וכרייה](3-consensus-and-mining.md)

---

## סטטוס רשת

**Mainnet**: טרם הושקה
**Testnet**: זמינה לבדיקות
**Regtest**: פונקציונלית לחלוטין לפיתוח

**פרמטרי בלוק בראשית**: [פרק 6: פרמטרי רשת](6-network-parameters.md)

---

## צעדים הבאים

**להבנת PoCX**: המשיכו ל[פרק 2: פורמט Plot](2-plot-format.md) ללמוד על מבנה קובצי plot והתפתחות הפורמט.

**להגדרת כרייה**: קפצו ל[פרק 7: עיון ב-RPC](7-rpc-reference.md) לפרטי אינטגרציה.

**להפעלת צומת**: סקרו את [פרק 6: פרמטרי רשת](6-network-parameters.md) לאפשרויות תצורה.

---

[📘 תוכן העניינים](index.md) | [הבא: פורמט Plot →](2-plot-format.md)
